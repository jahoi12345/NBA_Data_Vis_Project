import{l as C}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{g as v,p as h}from"./Point-BfTTZoMu-BAT2Wq6O.js";import{h as Q}from"./infoFor3D-DhzudQro-CCYgWfsv.js";function t(e,s,r){return!!m(e,s,r)}function n(e,s,r){return m(e,s,r)}function m(e,s,r){return e&&e.hasOwnProperty(s)?e[s]:r}const A={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function S(e){const s=e?.supportedSpatialAggregationStatistics?.map(r=>r.toLowerCase());return{envelope:!!s?.includes("envelopeaggregate"),centroid:!!s?.includes("centroidaggregate"),convexHull:!!s?.includes("convexhullaggregate")}}function d(e,s){return!!e?.supportedOperationsWithCacheHint?.map(r=>r.toLowerCase())?.includes(s.toLowerCase())}function x(e){const s=e?.supportedStatisticTypes?.map(r=>r.toLowerCase());return{count:!!s?.includes("count"),sum:!!s?.includes("sum"),min:!!s?.includes("min"),max:!!s?.includes("max"),avg:!!s?.includes("avg"),var:!!s?.includes("var"),stddev:!!s?.includes("stddev"),percentileContinuous:!!s?.includes("percentile_cont"),percentileDiscrete:!!s?.includes("percentile_disc"),envelope:!!s?.includes("envelopeaggregate"),centroid:!!s?.includes("centroidaggregate"),convexHull:!!s?.includes("convexhullaggregate")}}function R(e){const s=e?.supportedNormalizationTypes?.map(r=>r.toLowerCase());return{field:!!s?.includes("field"),log:!!s?.includes("log"),naturalLog:!!s?.includes("naturallog"),percentOfTotal:!!s?.includes("percentoftotal"),squareRoot:!!s?.includes("squareroot")}}function U(e,s){return{analytics:F(e),attachment:B(e),data:D(e),metadata:T(e),operations:w(e.capabilities,e,s),query:I(e,s),queryAttributeBins:O(e),queryRelated:z(e),queryTopFeatures:E(e),editing:b(e)}}function F(e){return{supportsCacheHint:d(e.advancedQueryCapabilities,"queryAnalytics")}}function B(e){const s=e.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:d(e.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:t(e.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:t(e,"supportsAttachmentsResizing",!1),supportsTypeWildcard:t(e.advancedQueryCapabilities,"supportsQueryAttachmentWithTypeWildcard",!1)};return s&&Array.isArray(s)&&s.forEach(p=>{const a=A[p.name];a&&(r[a]=!!p.isEnabled)}),r}function D(e){return{isVersioned:t(e,"isDataVersioned",!1),isBranchVersioned:t(e,"isDataBranchVersioned",!1),supportsAttachment:t(e,"hasAttachments",!1),supportsM:t(e,"hasM",!1),supportsZ:t(e,"hasZ",!1)}}function T(e){return{supportsAdvancedFieldProperties:t(e,"supportsFieldDescriptionProperty",!1)}}function w(e,s,r){const p=e?.toLowerCase().split(",").map(g=>g.trim())??[],a=r?h(r):null,f=p.includes(a?.serverType==="MapServer"?"data":"query"),o=p.includes("editing")&&!s.datesInUnknownTimezone&&s.uniqueIdInfo?.OIDFieldContainsHashValue!==!0;let i=o&&p.includes("create"),u=o&&p.includes("delete"),l=o&&p.includes("update");const y=p.includes("changetracking"),c=s.advancedQueryCapabilities;return o&&!(i||u||l)&&(i=u=l=!0),{supportsCalculate:t(s,"supportsCalculate",!1),supportsTruncate:t(s,"supportsTruncate",!1),supportsValidateSql:t(s,"supportsValidateSql",!1),supportsAdd:i,supportsDelete:u,supportsEditing:o,supportsChangeTracking:y,supportsQuery:f,supportsQueryAnalytics:t(c,"supportsQueryAnalytic",!1),supportsQueryAttachments:t(c,"supportsQueryAttachments",!1),supportsQueryBins:t(c,"supportsQueryBins",!1)||!!s.queryBinsCapabilities,supportsQueryPivot:t(c,"supportsQueryPivot",!1),supportsQueryTopFeatures:t(c,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:t(s,"supportsAttachmentsResizing",!1),supportsSync:p.includes("sync"),supportsUpdate:l,supportsExceedsLimitStatistics:t(s,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:t(s,"supportsAsyncConvert3D",!1)}}function I(e,s){const r=e.advancedQueryCapabilities,p=e.ownershipBasedAccessControlForFeatures,a=e.archivingInfo,f=e.currentVersion,o=s?.includes("MapServer"),i=!o||f>=C("mapserver-pbf-version-support"),u=v(s),l=new Set((e.supportedQueryFormats??"").split(",").map(y=>y.toLowerCase().trim()));return{maxRecordCount:n(e,"maxRecordCount",void 0),maxRecordCountFactor:n(e,"maxRecordCountFactor",void 0),maxUniqueIDCount:n(e,"maxUniqueIDCount",void 0),standardMaxRecordCount:n(e,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:S(r),supportsCacheHint:t(r,"supportsQueryWithCacheHint",!1)||d(r,"query"),supportsCentroid:t(r,"supportsReturningGeometryCentroid",!1),supportsCentroidOnDegeneratedQuantizedGeometry:u||s==null,supportsCompactGeometry:u,supportsCurrentUser:t(r,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:t(r,"supportsDefaultSR",!1),supportsDegeneratedQuantizedGeometry:t(r,"supportsDegeneratedQuantizedGeometry",!1),supportsDisjointSpatialRelationship:t(r,"supportsDisjointSpatialRel",!1),supportsDistance:t(r,"supportsQueryWithDistance",!1),supportsDistinct:t(r,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:t(r,"supportsReturningQueryExtent",!1),supportsFormatPBF:i&&l.has("pbf"),supportsFullTextSearch:t(r,"supportsFullTextSearch",!1),supportsGeometryProperties:t(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:t(r,"supportsHavingClause",!1),supportsHistoricMoment:t(a,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:t(r,"supportsMaxRecordCountFactor",!1),supportsOrderBy:t(r,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:t(r,"supportsPagination",!1),supportsPaginationOnAggregatedQueries:t(r,"supportsPaginationOnAggregatedQueries",!1),supportsPercentileStatistics:t(r,"supportsPercentileStatistics",!1),supportsQuantization:t(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:t(e,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:t(p,"allowAnonymousToQuery",!0),supportsQueryByOthers:t(p,"allowOthersToQuery",!0),supportsQueryGeometry:t(e,"supportsReturningQueryGeometry",!1),supportsResultType:t(r,"supportsQueryWithResultType",!1),supportsReturnMesh:!!Q(e.infoFor3D),supportsSpatialAggregationStatistics:t(r,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:t(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:t(e,"useStandardizedQueries",!1),supportsStatistics:t(r,"supportsStatistics",e.supportsStatistics),supportsTopFeaturesQuery:t(r,"supportsTopFeaturesQuery",!1),supportsTrueCurve:t(r,"supportsTrueCurve",!1),tileMaxRecordCount:n(e,"tileMaxRecordCount",void 0)}}function z(e){const s=e.advancedQueryCapabilities,r=t(s,"supportsAdvancedQueryRelated",!1);return{supportsPagination:t(s,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:d(s,"queryRelated")}}function E(e){return{supportsCacheHint:d(e.advancedQueryCapabilities,"queryTopFilter")}}function O(e){const s=e?e.queryBinsCapabilities:void 0;return{supportsDate:t(s,"supportsDateBin",!1),supportsFixedInterval:t(s,"supportsFixedIntervalBin",!1),supportsAutoInterval:t(s,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:t(s,"supportsFixedBoundariesBin",!1),supportsStackBy:t(s,"supportsStackBy",!1),supportsSplitBy:t(s,"supportsSplitBy",!1),supportsSnapToData:t(s,"supportsSnapToData",!1),supportsReturnFullIntervalBin:t(s,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:t(s,"supportsFirstDayOfWeek",!1),supportsNormalization:t(s,"supportsNormalization",!1),supportedStatistics:x(s),supportedNormalizationTypes:R(s)}}function b(e){const s=e.ownershipBasedAccessControlForFeatures,r=e?e.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:t(e,"allowGeometryUpdates",!0),supportsGlobalId:t(e,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:t(e,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:t(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:t(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:t(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:t(s,"allowAnonymousToDelete",!0),supportsDeleteByOthers:t(s,"allowOthersToDelete",!0),supportsUpdateByAnonymous:t(s,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:t(s,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:t(r,"supportsAsyncApplyEdits",!1),zDefault:n(e,"zDefault",void 0)}}function G(e){return{operations:{supportsAppend:t(e,"supportsAppend",!1),supportsCoverageQuery:e?.playbackInfo?.klv["0601"]??!1,supportsExportClip:t(e,"supportsExportClip",!1),supportsExportFrameset:t(e,"supportsExportFrameset",!1),supportsMensuration:t(e,"supportsMensuration",!1),supportsPreviews:t(e,"supportsPreviews",!1),supportsUpdate:t(e,"supportsUpdate",!1)}}}export{G,U};
