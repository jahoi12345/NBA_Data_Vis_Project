import{aC as R,V as p,l as b,_ as T,a as A,aX as U,a5 as $,a6 as m,g as L,aY as O,aZ as z,o as g,a_ as C,ad as Z,w as k}from"./jsonMap-Bs3hmeCU.js";const w=e=>{const t=e;class o extends t{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(r,i){let n=this._listenersMap?.get(r);if(!n)return!1;let l=!1;for(const a of n.slice()){const h="deref"in a?a.deref():a;h?h?.call(this,i):l=!0}return l&&(n=n.filter(a=>!("deref"in a)||a.deref()!=null),this._listenersMap.set(r,n)),n.length>0}on(r,i){if(Array.isArray(r)){const l=r.map(a=>this.on(a,i));return R(l)}if(r.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const n=this._listenersMap.get(r)||[];return n.push(i),this._listenersMap.set(r,n),p(()=>{const l=this._listenersMap?.get(r),a=l?.indexOf(i)??-1;a>=0&&l.splice(a,1)})}once(r,i){const n=this.on(r,l=>{n.remove(),("deref"in i?i.deref():i)?.call(null,l)});return n}hasEventListener(r){const i=this._listenersMap?.get(r);return i!=null&&i.length>0}}return o},q=w(class{}),I=q,J=w(b);let H=class{constructor(){this._resolver=$(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(m())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const t=$(),o=[...this._resolvingPromises,t.promise],s=this._allPromise=Promise.all(o);s.then(()=>{this.isFulfilled()||this._allPromise!==s||this._resolver.resolve()},r=>{this.isFulfilled()||this._allPromise!==s||L(r)||this._resolver.reject(r)}),t.resolve()}};const V=e=>{const t=e;let o=class extends t{constructor(...s){super(...s),this._promiseProps=new H,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(s,r){return this._promiseProps.promise.then(()=>this).then(s,r)}catch(s){return this.when(null,s)}addResolvingPromise(s){s&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in s?s.when():s)}addResolvingTask(s){s&&!this._promiseProps.isFulfilled()&&(this.addHandles(U(s)),this._promiseProps.addResolvingPromise(s.promise))}};return o=T([A("esri.core.Promise")],o),o},N=V(b);let c;const X=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,_=globalThis.document?.documentElement;function M(){const e=_?.getAttribute("lang"),t=globalThis.navigator?.language;return X??e??t??"en"}function v(){return c===void 0&&(c=M()),c}const Y=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function Q(e=v()){return x(e)?.language}function S(e=v()){const t=x(e);return t?.language&&t?.extlang?e.replace(`${t.language}-`,""):e}function x(e=v()){return Y.exec(e)?.groups}const d=[];function W(e){return d.push(e),p(()=>{d.splice(d.indexOf(e),1)})}const f=[];function ee(e){return f.push(e),p(()=>f.splice(f.indexOf(e),1))}function y(){const e=M();c!==e&&([...f].forEach(t=>t(e)),c=e,[...d].forEach(t=>t(e)))}globalThis.addEventListener?.("languagechange",y),_&&new MutationObserver(()=>{y()}).observe(_,{attributeFilter:["lang"]});function j(e,t,o={}){return P(e,t,o,E)}function se(e,t,o={}){return P(e,t,o,F)}function P(e,t,o={},s){let r=null;const i=o.once?(n,l)=>{s(n)&&(g(r),t(n,l))}:(n,l)=>{s(n)&&t(n,l)};if(r=C(e,i,o.sync,o.equals),o.initial){const n=e();i(n,n)}return r}function te(e,t,o,s={}){let r=null,i=null,n=null;function l(){r&&i&&(i.remove(),s.onListenerRemove?.(r),r=null,i=null)}function a(u){s.once&&s.once&&g(n),o(u)}const h=j(e,(u,D)=>{l(),O(u)&&(r=u,i=z(u,t,a),s.onListenerAdd?.(u))},{sync:s.sync,initial:!0});return n=p(()=>{h.remove(),l()}),n}function re(e,t){return B(e,F,t)}function B(e,t,o){if(Z(o))return Promise.reject(m());const s=e();if(t?.(s))return Promise.resolve(s);let r=null;function i(){r=g(r)}return new Promise((n,l)=>{r=R([k(o,()=>{i(),l(m())}),P(e,a=>{i(),n(a)},{sync:!1,once:!0},t??E)])})}function E(e){return!0}function F(e){return!!e}function ne(e,t,o={}){let s=!1;const r=j(e,(i,n)=>{s||t(i,n)},o);return{remove(){r.remove()},pause(){s=!0},resume(){s=!1}}}const ie={sync:!0},oe={initial:!0},le={sync:!0,initial:!0};export{ne as P,ie as U,te as a,v as b,J as c,N as d,W as e,se as f,oe as h,I as i,re as j,j as l,V as m,w as n,q as r,Q as s,S as u,ee as v,le as w};
