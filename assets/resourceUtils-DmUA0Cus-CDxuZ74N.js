import{V as u,H as b,n as I}from"./Point-BfTTZoMu-DeJwQYfh.js";import{I as d}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import"./index-B0z_nLWi.js";import"./reader-DcGs6kKN-DHJfK-tm.js";async function F(e,t={},s){await e.load(s);const r=u(e.itemUrl,"resources"),{start:c=1,num:m=10,sortOrder:l="asc",sortField:p="resource"}=t,i={query:{start:c,num:m,sortOrder:l,sortField:p,token:e.apiKey},signal:s?.signal},a=await e.portal.request(r,i);return{total:a.total,nextStart:a.nextStart,resources:a.resources.map(({created:n,size:f,resource:o})=>({created:new Date(n),size:f,resource:e.resourceFromPath(o)}))}}async function O(e,t,s,r){const c=new Map;for(const{resource:l,content:p,compress:i,access:a}of t){if(!l.hasPath())throw new d(`portal-item-resource-${s}:invalid-path`,"Resource does not have a valid path");const[n,f]=h(l.path),o=`${n}/${i??""}/${a??""}`;c.has(o)||c.set(o,{prefix:n,compress:i,access:a,files:[]}),c.get(o).files.push({fileName:f,content:p})}await e.load(r);const m=u(e.userItemUrl,s==="add"?"addResources":"updateResources");for(const{prefix:l,compress:p,access:i,files:a}of c.values())for(let n=0;n<a.length;n+=25){const f=a.slice(n,n+25),o=new FormData;l&&l!=="."&&o.append("resourcesPrefix",l),p&&o.append("compress","true"),i&&o.append("access",i);let w=0;for(const{fileName:y,content:v}of f)o.append("file"+ ++w,v,y);o.append("f","json"),await e.portal.request(m,{method:"post",body:o,signal:r?.signal})}}async function $(e,t,s){if(!t.hasPath())throw new d("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await e.load(s);const r=u(e.userItemUrl,"removeResources");await e.portal.request(r,{method:"post",query:{resource:t.path},signal:s?.signal}),t.portalItem=null}async function U(e,t){await e.load(t);const s=u(e.userItemUrl,"removeResources");return e.portal.request(s,{method:"post",query:{deleteAll:!0},signal:t?.signal})}function h(e){const t=e.lastIndexOf("/");return t===-1?[".",e]:[e.slice(0,t),e.slice(t+1)]}function g(e){const[t,s]=P(e),[r,c]=h(t);return[r,c,s]}function P(e){const t=I(e);return t==null?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}async function j(e){return e.type==="blob"?e.blob:e.type==="json"?new Blob([e.jsonString],{type:"application/json"}):(await b(e.url,{responseType:"blob"})).data}function N(e,t){if(!e.hasPath())return null;const[s,,r]=g(e.path);return e.portalItem.resourceFromPath(u(s,t+r))}function T(e,t){if(!e.hasPath())return null;const[s,,r]=g(e.path);return e.portalItem.resourceFromPath(u(s,t+r))}export{O as addOrUpdateResources,j as contentToBlob,F as fetchResources,N as getSiblingOfSameType,T as getSiblingOfSameTypeI,U as removeAllResources,$ as removeResource,g as splitPrefixFileNameAndExtension};
