const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/projectOperator-WLxlSVWx.js","assets/index-DJqVgRZI.js","assets/operatorProject-BwrV3hUM.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/Point-C1MrKtFQ.js","assets/jsonMap-Bs3hmeCU.js","assets/reader-DcGs6kKN.js","assets/geographicTransformationUtils-CbwTS1Y_.js","assets/projectionUtils-DgeaYumr.js","assets/SimpleObservable-CvFyr0NA.js","assets/collectionUtils-0LMOubEE.js","assets/reactiveUtils-SO2Ko3sy.js","assets/Extent-BhRcB6A3.js","assets/Polyline-BX3kGhk1.js","assets/Polygon-Bn-bHOAm.js","assets/aaBoundingRect-CirBGiM6.js","assets/mathUtils-PIGhLnI9.js"])))=>i.map(i=>d[i]);
import{_ as ot}from"./index-DJqVgRZI.js";import{a1 as bt,s as xt,a5 as St}from"./jsonMap-Bs3hmeCU.js";import{b as k,F as C,a9 as T,aa as N,ab as Et,f as Gt,a8 as kt,ac as rt,ad as _t}from"./Point-C1MrKtFQ.js";import{z as $}from"./Extent-BhRcB6A3.js";import{P as H}from"./Polygon-Bn-bHOAm.js";import{Q as Nt}from"./projectionUtils-DgeaYumr.js";function L(){if(!Z)throw new xt("rasterprojectionhelper-project","projection operator is not loaded")}const st=(t,e,i,o=0)=>{if(i[0]===1)return[0,0];let s=1,n=-1,r=1,c=-1;for(let u=0;u<t.length;u+=2)isNaN(t[u])||(s=s>t[u]?t[u]:s,n=n>t[u]?n:t[u],r=r>t[u+1]?t[u+1]:r,c=c>t[u+1]?c:t[u+1]);const{cols:a,rows:f}=e,l=(n-s)/a/i[0],d=(c-r)/f/i[1],m=2*o;let h=0,x=!1,y=[0,0];for(let u=0;u<a-3;u++){for(let R=0;R<f-3;R++){const g=u*f*2+2*R,p=(t[g]+t[g+4]+t[g+4*f]+t[g+4*f+4])/4,w=(t[g+1]+t[g+5]+t[g+4*f+1]+t[g+4*f+5])/4,M=Math.abs((p-t[g+2*f+2])/l),P=Math.abs((w-t[g+2*f+3])/d);if(M+P>h&&(h=M+P,y=[M,P]),m&&h>m){x=!0;break}}if(x)break}return y},Tt={3395:20037508342789244e-9,3410:17334193943686873e-9,3857:20037508342788905e-9,3975:17367530445161372e-9,4087:20037508342789244e-9,4088:20015108787169147e-9,6933:17367530445161372e-9,32662:20037508342789244e-9,53001:2001508679602057e-8,53002:1000754339801029e-8,53003:2001508679602057e-8,53004:2001508679602057e-8,53016:14152803599503474e-9,53017:17333573624304302e-9,53034:2001508679602057e-8,53079:20015114352186374e-9,53080:20015114352186374e-9,54001:20037508342789244e-9,54002:10018754171394624e-9,54003:20037508342789244e-9,54004:20037508342789244e-9,54016:14168658027268292e-9,54017:1736753044516137e-8,54034:20037508342789244e-9,54079:20037508342789244e-9,54080:20037508342789244e-9,54100:20037508342789244e-9,54101:20037508342789244e-9},q=32,F=4,D=F,K=new Map,Q=new Map,Y=500,vt=39.37,Ct=96;let A,G,I,Z=!1;async function Vt(){return A||(A=St(),G=await ot(()=>import("./projectOperator-WLxlSVWx.js"),__vite__mapDeps([0,1,2,3,4,5,6])),I=await ot(()=>import("./geographicTransformationUtils-CbwTS1Y_.js"),__vite__mapDeps([7,1,4,5,6,8,9,10,11,12,13,14,15,16])),G.isLoaded()||await G.load(),I.isLoaded()||await I.load(),Z=!0,A.resolve()),A.promise}function zt(t,e,i){if(L(),i){const o=G.execute(t,e);return I.getTransformation(e,t.spatialReference,o)}return I.getTransformation(t.spatialReference,e,t)}function Ut(t,e,i,o){const s=t.spatialReference;if(!s||!e||s.equals(e))return t;L();const n=i.center,r=new $({xmin:n.x-t.x/2,xmax:n.x+t.x/2,ymin:n.y-t.y/2,ymax:n.y+t.y/2,spatialReference:s}),c=G.execute(r,e,{geographicTransformation:o}),a=v(e);return c==null||a!=null&&c.width>=a?j(t,s,e):{x:c.width,y:c.height}}function j(t,e,i){const o=C(e)/C(i);return{x:t.x*o,y:t.y*o}}function Lt(t,e,i){const{spatialReference:o}=i;if(!o||!e||o.equals(e))return t;if(o.isGeographic&&e.isGeographic)return j(t,o,e);if(L(),!Z)throw new xt("raster-projection-helper:project-dataset-resolution","geometry engine is not loaded");let{x:s,y:n}=t;const r=(s+n)/2*C(o);let c=1;r>30&&(c=30/r,s*=c,n*=c);const a=256,f=s*a/2,l=n*a/2,{x:d,y:m}=i.center,h=[];for(let b=0;b<=a;b++)h.push([d-f,m-l+b*n]);for(let b=1;b<=a;b++)h.push([d-f+b*s,m+l]);for(let b=1;b<=a;b++)h.push([d+f,m+l-b*n]);for(let b=1;b<a;b++)h.push([d+f-b*s,m-l]);h.push(h[0]);const x=new H({rings:[h],spatialReference:o}),y=G.execute(x,e);if(!y)return j(t,o,e);const u=y.extent,R=v(e);if(u==null||R!=null&&u.width>=R)return j(t,o,e);const g=Yt(y.rings),p=s*n*a*a,w=Math.sqrt(g/p)/c,M={x:u.width/c/a,y:u.height/c/a},P={x:s*w,y:n*w},_=M.x*M.y;return Math.abs(_-P.x*P.y)/_<.1?M:P}function Ot(t,e){return(typeof t=="number"?t:(t.x+t.y)/2)*C(e)*Ct*vt}function Ht(t,e){const{pixelSize:i,extent:o}=t;return Ot(Lt(i,e,o),e)}function E(t,e=.01){return C(t)?e/C(t):0}function at(t,e,i,o=!0){const s=t.spatialReference;if(s.equals(e))return t;L();const n=G.execute(t,e,{geographicTransformation:i});return o&&n&&mt([t],[n],s,e),n}function mt(t,e,i,o){const s=B(i,!0),n=B(o,!0),r=E(i,Y),c=E(o,Y);if(r&&s!=null&&n!=null)for(let a=0;a<t.length;a++){const f=e[a];if(!f)continue;const{x:l}=t[a],{x:d}=f;d>=n[1]-c&&Math.abs(l-s[0])<r?f.x-=n[1]-n[0]:d<=n[0]+c&&Math.abs(l-s[1])<r&&(f.x+=n[1]-n[0])}}function Wt(t){const{inSR:e,outSR:i,preferPE:o}=t;if(e.equals(i)){const{points:s}=tt(t,null);return s}return e.isWebMercator&&i.isWGS84||e.isWGS84&&i.isWebMercator?$t(t):o&&(e.isGeographic||z(e)!=null)?lt(t):It(t)}function It(t){const{points:e}=tt(t,null),{inSR:i,outSR:o,datumTransformation:s}=t,n=e.map(c=>new k(c[0],c[1],i)),r=G.executeMany(n,o,{geographicTransformation:s});return s&&mt(n,r,i,o),r.map(c=>c?[c.x,c.y]:[NaN,NaN])}function lt(t){const{inSR:e,outSR:i,datumTransformation:o}=t,s=z(e),{points:n,mask:r}=tt(t,s);if(!e.isGeographic){const a=e.wkid?T.coordsys(e.wkid):T.fromString(e.isGeographic?N.PE_TYPE_GEOGCS:N.PE_TYPE_PROJCS,e.wkt2||e.wkt);rt.projToGeog(a,n.length,n)}if(o!=null&&o.steps.length){let a;if(i.isGeographic&&(a=n.map(([l])=>l>179.9955?1:l<-179.9955?-1:0)),o.steps.forEach(l=>{const d=l.wkid?T.geogtran(l.wkid):T.fromString(N.PE_TYPE_GEOGTRAN,l.wkt);_t.geogToGeog(d,n.length,n,null,l.isInverse?N.PE_TRANSFORM_2_TO_1:N.PE_TRANSFORM_1_TO_2)}),a)for(let l=0;l<n.length;l++){const d=a[l],m=n[l][0],h=m>179.9955?1:m<-179.9955?-1:0;d&&h&&d!==h&&(n[l][0]=d>0?m+360:m-360)}}if(!i.isGeographic){const a=z(i,!0),f=a!=null&&a.isEnvelope?[a.bbox[1],a.bbox[3]]:[-90,90];At(n,f);const l=i.wkid?T.coordsys(i.wkid):T.fromString(i.isGeographic?N.PE_TYPE_GEOGCS:N.PE_TYPE_PROJCS,i.wkt2||i.wkt);rt.geogToProj(l,n.length,n)}let c=n;if(r&&n.length!==r.length){c=[];for(let a=0,f=0;a<r.length;a++)r[a]?c.push(n[f++]):c.push([NaN,NaN])}return c}function $t(t){const{cols:e,rows:i,xres:o,yres:s,usePixelCenter:n,inSR:r,outSR:c}=t;let{xmin:a,ymax:f}=t;n&&(a+=o/2,f-=s/2);const l=[],d=[],m=Math.max(e,i);for(let x=0;x<m;x++){const y=a+o*Math.min(e,x),u=f-s*Math.min(i,x),R=Nt(new k({x:y,y:u,spatialReference:r}),r,c);x<=e&&l.push(R.x),x<=i&&d.push(R.y)}const h=[];for(let x=0;x<e;x++)for(let y=0;y<i;y++)h.push([l[x],d[y]]);return h}function z(t,e=!1){let i=t.wkid||t.wkt2||t.wkt;if(!i||t.isGeographic)return null;if(i=String(i),K.has(i)){const r=K.get(i);return e?r?.gcs:r?.pcs}const o=t.wkid?T.coordsys(t.wkid):T.fromString(t.isGeographic?N.PE_TYPE_GEOGCS:N.PE_TYPE_PROJCS,t.wkt2||t.wkt),s=ct(o,E(t,1e-4)),n=ct(o,0,!0);return K.set(i,{pcs:s,gcs:n}),e?n:s}function ct(t,e=0,i=!1){const o=Et.generate(t),s=i?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!o||!s?.length)return null;let n=!1,r=s.find(u=>u.getInclusive()===1&&u.getKind()===1);if(!r){if(r=s.find(u=>u.getInclusive()===1&&u.getKind()===0),!r)return null;n=!0}const c=i?0:(o.getNorthPoleLocation()===2?1:0)|(o.getSouthPoleLocation()===2?2:0),a=o.isPannableRectangle(),f=r.getCoord();if(n)return{isEnvelope:n,isPannable:a,vertices:f,coef:null,bbox:[f[0][0]-e,f[0][1]-e,f[1][0]+e,f[1][1]+e],poleLocation:c};let l=0;const d=[];let[m,h]=f[0],[x,y]=f[0];for(let u=0,R=f.length;u<R;u++){l++,l===R&&(l=0);const[g,p]=f[u],[w,M]=f[l];if(M===p)d.push([g,w,p,M,2]);else{const P=(w-g)/(M-p||1e-4),_=g-P*p;p<M?d.push([P,_,p,M,0]):d.push([P,_,M,p,1])}m=m<g?m:g,h=h<p?h:p,x=x>g?x:g,y=y>p?y:p}return{isEnvelope:!1,isPannable:a,vertices:f,coef:d,bbox:[m,h,x,y],poleLocation:c}}function tt(t,e){const i=[],{cols:o,rows:s,xres:n,yres:r,usePixelCenter:c}=t;let{xmin:a,ymax:f}=t;if(c&&(a+=n/2,f-=r/2),e==null){for(let h=0;h<o;h++)for(let x=0;x<s;x++)i.push([a+n*h,f-r*x]);return{points:i}}const l=new Uint8Array(o*s);if(e.isEnvelope){const{bbox:[h,x,y,u]}=e;for(let R=0,g=0;R<o;R++){const p=a+n*R,w=e.isPannable||p>=h&&p<=y;for(let M=0;M<s;M++,g++){const P=f-r*M;w&&P>=x&&P<=u&&(i.push([p,P]),l[g]=1)}}return{points:i,mask:l}}const d=e.coef,m=[];for(let h=0;h<s;h++){const x=f-r*h,y=[],u=[];for(let g=0;g<d.length;g++){const[p,w,M,P,_]=d[g];if(x===M&&M===P)y.push(p),y.push(w),u.push(2),u.push(2);else if(x>=M&&x<=P){const b=p*x+w;y.push(b),u.push(_)}}let R=y;if(y.length>2){let g=u[0]===2?0:u[0],p=y[0];R=[];for(let w=1;w<u.length;w++)u[w]===2&&w!==u.length-1||(u[w]!==g&&(R.push(g===0?Math.min(p,y[w-1]):Math.max(p,y[w-1])),g=u[w],p=y[w]),w===u.length-1&&R.push(u[w]===0?Math.min(p,y[w]):Math.max(p,y[w])));R.sort((w,M)=>w-M)}else y[0]>y[1]&&(R=[y[1],y[0]]);m.push(R)}for(let h=0,x=0;h<o;h++){const y=a+n*h;for(let u=0;u<s;u++,x++){const R=f-r*u,g=m[u];if(g.length===2)y>=g[0]&&y<=g[1]&&(i.push([y,R]),l[x]=1);else if(g.length>2){let p=!1;for(let w=0;w<g.length;w+=2)if(y>=g[w]&&y<=g[w+1]){p=!0;break}p&&(i.push([y,R]),l[x]=1)}}}return{points:i,mask:l}}function At(t,e){const[i,o]=e;for(let s=0;s<t.length;s++){const n=t[s][1];(n<i||n>o)&&(t[s]=[NaN,NaN])}}function ht(t,e){const i=v(t[0].spatialReference);if(t.length<2||i==null||(e=e??E(t[0].spatialReference),(t=t.filter(c=>c.width>e)).length===1))return t[0];let{xmin:o,xmax:s,ymin:n,ymax:r}=t[0];for(let c=1;c<t.length;c++){const a=t[c];s=a.xmax+i*c,n=Math.min(n,a.ymin),r=Math.max(r,a.ymax)}return new $({xmin:o,xmax:s,ymin:n,ymax:r,spatialReference:t[0].spatialReference})}function pt(t,e,i=null,o=!0){const s=t.spatialReference;if(s.equals(e)||!e)return t;const n=gt(t),r=v(s,!0),c=v(e);if(n===0||r==null||c==null){const l=U(t,e,i,o);if(l&&r==null&&c!=null&&Math.abs(l.width-c)<E(e)&&G.isLoaded()){const d=z(s);if(d!=null&&d.poleLocation===0&&t.width<(d.bbox[2]-d.bbox[0])/2)return jt(t,e)||l}return l}const a=t.clone().normalize();if(a.length===1&&t.xmax<r&&t.xmax-r/2>E(s)){const{xmin:l,xmax:d}=t;for(let m=0;m<=n;m++){const h=m===0?l:-r/2,x=m===n?d-r*m:r/2;a[m]=new $({xmin:h,xmax:x,ymin:t.ymin,ymax:t.ymax,spatialReference:s})}}const f=a.map(l=>U(l,e,i,o)).filter(bt);return f.length===0?null:ht(f)}function Zt(t,e,i){if(t.type==="extent"){const{xmin:o,ymin:s,xmax:n,ymax:r,spatialReference:c}=t;t=new H({rings:[[[o,r],[n,r],[n,s],[o,s],[o,r]]],spatialReference:c})}return t.spatialReference.equals(e)?t:(L(),G.execute(t,e,{geographicTransformation:i}))}function jt(t,e){const i=v(e);if(i==null)return null;let{xmin:o,ymin:s,xmax:n,ymax:r}=t;const c=t.spatialReference,a=new H({spatialReference:c,rings:[[[o,s],[n,s],[n,r],[o,r],[o,s]]]}),f=G.execute(a,e);if(f.rings.length!==2||!f.rings[0].length||!f.rings[1].length)return null;const{rings:l}=f,d=E(c),m=new $({spatialReference:e});for(let h=0;h<2;h++){o=n=l[h][0][0],s=r=l[h][0][1];for(let x=0;x<l[h].length;x++)o=o>l[h][x][0]?l[h][x][0]:o,n=n<l[h][x][0]?l[h][x][0]:n,s=s>l[h][x][1]?l[h][x][1]:s,r=r<l[h][x][1]?l[h][x][1]:r;if(h===0)m.ymin=s,m.ymax=r,m.xmin=o,m.xmax=n;else if(m.ymin=Math.min(m.ymin,s),m.ymax=Math.max(m.ymax,r),Math.abs(n-i/2)<d)m.xmin=o,m.xmax=m.xmax+i;else{if(!(Math.abs(o+i/2)<d))return null;m.xmax=n+i}}return m}function U(t,e,i,o=!0,s=!0){const n=t.spatialReference;if(n.equals(e)||!e)return t;L();const r=G.execute(t,e,{geographicTransformation:i});if(s&&e.isWebMercator&&r&&(r.ymax=Math.min(20037508342787e-6,r.ymax),r.ymin=Math.max(-20037508342787e-6,r.ymin),r.ymin>=r.ymax))return null;if(!o||!r)return r;const c=B(n,!0),a=B(e,!0);if(c==null||a==null)return r;const f=E(n,.001),l=E(n,Y),d=E(e,.001);if(Math.abs(r.xmin-a[0])<d&&Math.abs(r.xmax-a[1])<d){const m=Math.abs(t.xmin-c[0]),h=Math.abs(c[1]-t.xmax);if(m<f&&h>l){r.xmin=a[0];const x=[];x.push(new k(t.xmax,t.ymin,n)),x.push(new k(t.xmax,(t.ymin+t.ymax)/2,n)),x.push(new k(t.xmax,t.ymax,n));const y=x.map(u=>at(u,e,i)).filter(u=>!isNaN(u?.x)).map(u=>u.x);r.xmax=Math.max.apply(null,y)}if(h<f&&m>l){r.xmax=a[1];const x=[];x.push(new k(t.xmin,t.ymin,n)),x.push(new k(t.xmin,(t.ymin+t.ymax)/2,n)),x.push(new k(t.xmin,t.ymax,n));const y=x.map(u=>at(u,e,i)).filter(u=>!isNaN(u?.x)).map(u=>u.x);r.xmin=Math.min.apply(null,y)}}else{const m=E(e,.001);Math.abs(r.xmin-a[0])<m&&(r.xmin=a[0]),Math.abs(r.xmax-a[1])<m&&(r.xmax=a[1])}return r}function v(t,e=!1){if(!t)return null;const i=e?20037508342787e-6:20037508342788905e-9;return t.isWebMercator?2*i:t.wkid&&t.isGeographic?360:2*Tt[t.wkid]||null}function B(t,e=!1){if(t.isGeographic)return[-180,180];const i=v(t,e);return i!=null?[-i/2,i/2]:null}function ft(t,e,i,o){let s=(t-e)/i;return s-Math.floor(s)!==0?s=Math.floor(s):o&&(s-=1),s}function gt(t,e=!1){const i=v(t.spatialReference);if(i==null)return 0;const o=e?0:-(i/2),s=E(t.spatialReference),n=!e&&Math.abs(t.xmax-i/2)<s?i/2:t.xmax,r=!e&&Math.abs(t.xmin+i/2)<s?-i/2:t.xmin;return ft(n,o,i,!0)-ft(r,o,i,!1)}function tn(t){const e=t.storageInfo.origin.x,i=v(t.spatialReference,!0);if(i==null)return{originX:e,halfWorldWidth:null,pyramidsInfo:null};const o=i/2,{nativePixelSize:s,storageInfo:n,extent:r}=t,{maximumPyramidLevel:c,blockWidth:a,pyramidScalingFactor:f}=n;let l=s.x;const d=[],m=t.transform!=null&&t.transform.type==="gcs-shift",h=e+(m?0:o),x=m?i-e:o-e;for(let y=0;y<=c;y++){const u=(r.xmax-e)/l/a,R=u-Math.floor(u)===0?u:Math.ceil(u),g=x/l/a,p=g-Math.floor(g)===0?g:Math.ceil(g),w=Math.floor(h/l/a),M=Math.round(h/l)%a,P=(a-Math.round(x/l)%a)%a;d.push({resolutionX:l,blockWidth:a,datasetColumnCount:R,worldColumnCountFromOrigin:p,leftMargin:M,rightPadding:P,originColumnOffset:w}),l*=f}return{originX:e,halfWorldWidth:o,pyramidsInfo:d,hasGCSSShiftTransform:m}}function qt(t){if(!t||t.isGeographic)return t;const e=String(t.wkid||t.wkt2||t.wkt);let i;return Q.has(e)?i=Q.get(e):(i=(t.wkid?T.coordsys(t.wkid):T.fromString(N.PE_TYPE_PROJCS,t.wkt2||t.wkt)).getGeogcs().getCode(),Q.set(e,i)),new Gt({wkid:i})}function nn(t){const e=t.isAdaptive&&t.spacing==null;let i=t.spacing||[q,q],o=V(t),s={cols:o.size[0]+1,rows:o.size[1]+1};const n=o.outofBoundPointCount>0&&o.outofBoundPointCount<o.offsets.length/2;let r=o.outofBoundPointCount===o.offsets.length/2||e&&n?[0,0]:st(o.offsets,s,i,D);const c=(r[0]+r[1])/2,a=t.projectedExtent.spatialReference,f=t.srcBufferExtent.spatialReference;if(e&&(n||c>D)&&(a.isGeographic||z(a),i=[F,F],o=V({...t,spacing:i}),s={cols:o.size[0]+1,rows:o.size[1]+1},r=st(o.offsets,s,i,D)),o.error=r,i[0]>1&&(o.coefficients=ut(o.offsets,s,n)),t.includeGCSGrid&&!a.isGeographic&&!a.isWebMercator)if(f.isGeographic)o.gcsGrid={offsets:o.offsets,coefficients:o.coefficients,spacing:i};else{const l=z(a);if(l!=null&&!l.isEnvelope){const d=qt(a),m=pt(t.projectedExtent,d),{offsets:h}=V({...t,srcBufferExtent:m,spacing:i}),x=ut(h,s,n);o.gcsGrid={offsets:h,coefficients:x,spacing:i}}}return o}function V(t){const{projectedExtent:e,srcBufferExtent:i,pixelSize:o,datumTransformation:s,rasterTransform:n}=t,r=e.spatialReference,c=i.spatialReference;L();const{xmin:a,ymin:f,xmax:l,ymax:d}=e,m=v(c),h=m!=null&&(t.hasWrapAround||n?.type==="gcs-shift"),x=t.spacing||[q,q],y=x[0]*o.x,u=x[1]*o.y,R=x[0]===1,g=Math.ceil((l-a)/y-.1/x[0])+(R?0:1),p=Math.ceil((d-f)/u-.1/x[1])+(R?0:1),w=Wt({cols:g,rows:p,xmin:a,ymax:d,xres:y,yres:u,inSR:r,outSR:c,datumTransformation:s,preferPE:x[0]<=F,usePixelCenter:R}),M=[];let P,_=0;const b=R?-1:NaN,{xmin:nt,xmax:J,ymax:yt,width:dt,height:wt}=i,Mt=E(c,Y),Rt=m!=null&&nt>0&&J>m/2,et=z(r),Pt=et!=null&&et.poleLocation>0;for(let O=0;O<g;O++){const X=[];for(let W=0;W<p;W++){let S=w[O*p+W];if(h&&S[0]>J&&S[0]>m/2-Mt?S[0]-=m:h&&O===0&&S[0]<0&&Rt&&!n&&(S[0]+=m),!S||isNaN(S[0])||isNaN(S[1]))M.push(b),M.push(b),X.push(null),_++;else{if(n){const it=n.inverseTransform(new k({x:S[0],y:S[1],spatialReference:c}));S=[it.x,it.y]}X.push(S),O>0&&h&&P[W]&&S[0]<P[W][0]&&(S[0]+=m,Pt&&S[0]>J&&S[0]>m&&(S[0]-=m)),M.push((S[0]-nt)/dt),M.push((yt-S[1])/wt)}}P=X}return{offsets:M,error:null,coefficients:null,outofBoundPointCount:_,spacing:x,size:R?[g,p]:[g-1,p-1]}}function ut(t,e,i){const{cols:o,rows:s}=e,n=new Float32Array((o-1)*(s-1)*2*6),r=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),c=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let a=0;a<o-1;a++){for(let f=0;f<s-1;f++){let l=a*s*2+2*f;const d=t[l],m=t[l+1],h=t[l+2],x=t[l+3];l+=2*s;const y=t[l],u=t[l+1],R=t[l+2],g=t[l+3];let p=0,w=12*(f*(o-1)+a);for(let M=0;M<3;M++)n[w++]=r[p++]*d+r[p++]*h+r[p++]*R;p=0;for(let M=0;M<3;M++)n[w++]=r[p++]*m+r[p++]*x+r[p++]*g;p=0;for(let M=0;M<3;M++)n[w++]=c[p++]*d+c[p++]*y+c[p++]*R;p=0;for(let M=0;M<3;M++)n[w++]=c[p++]*m+c[p++]*u+c[p++]*g}if(i)for(let f=0;f<n.length;f++)isNaN(n[f])&&(n[f]=-1)}return n}function Ft(t,e){const i=t.clone().normalize();return i.length===1?i[0]:ht(i,e)}function en(t){const{spatialReference:e}=t,i=kt(e);if(!i)return t;const[o,s]=i.valid,n=s-o;let r=0;if(t.xmin<o){const c=o-t.xmin;r=Math.ceil(c/n)}else if(t.xmin>s){const c=t.xmin-s;r=-Math.ceil(c/n)}return new $({spatialReference:t.spatialReference,xmin:t.xmin+r*n,ymin:t.ymin,xmax:t.xmax+r*n,ymax:t.ymax})}function on(t,e,i){const{storageInfo:o,pixelSize:s}=e;let n=0,r=!1;const{pyramidResolutions:c}=o,a=o.tileInfo.format?.toLowerCase()==="mixed"?Math.max(1,Math.min(3,o.tileInfo.dpi/96)):1,f=(t.x+t.y)/2/a;if(c!=null&&c.length){const x=c[c.length-1],y=(x.x+x.y)/2,u=(s.x+s.y)/2;if(f<=u)n=0;else if(f>=y)n=c.length,r=f/y>8;else{let g,p=u;for(let w=1;w<=c.length;w++){if(g=(c[w-1].x+c[w-1].y)/2,f<=g){f===g?n=w:i==="down"?(n=w-1,r=f/p>8):n=i==="up"||f-p>g-f||f/p>2?w:w-1;break}p=g}}const R=n===0?s:c[n-1];return r&&Math.min(R.x,R.y)*C(e.spatialReference)>19567&&(r=!1),{pyramidLevel:n,pyramidResolution:new k({x:R.x,y:R.y,spatialReference:e.spatialReference}),excessiveReading:r}}const l=Math.log(t.x/s.x)/Math.LN2,d=Math.log(t.y/s.y)/Math.LN2,m=e.storageInfo.maximumPyramidLevel||0;n=i==="down"?Math.floor(Math.min(l,d)):i==="up"?Math.ceil(Math.max(l,d)):Math.round((l+d)/2),n<0?n=0:n>m&&(r=n>m+3,n=m);const h=2**n;return{pyramidLevel:n,pyramidResolution:new k({x:h*e.nativePixelSize.x,y:h*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:r}}function rn(t,e,i=!1){const{pixelSize:o,extent:s}=t,n=zt(s,e,!1),r=pt(Ft(s,(o.x+o.y)/16),e,n);return!r||i||gt(r)===0?r:U(s,e,n)}function Yt(t){let e=0;for(const i of t){const o=i.length;let s=i[0][0]*(i[1][1]-i[o-2][1]);for(let n=1;n<o-1;n++)s+=i[n][0]*(i[n+1][1]-i[n-1][1]);e+=s/2}return Math.abs(e)}export{v as $,Ut as C,pt as H,Ht as I,Zt as Q,at as W,en as c,on as f,tn as i,Vt as j,gt as n,nn as r,rn as u,zt as v};
