import{F as y}from"./Color-CERqXxxY-BuYn26eI.js";import{l as c}from"./ShadowCastClear.glsl-CeOT_rAo-BEYyVrmo.js";import{D as f}from"./visualVariableUtils-ma4r7Z2K-Df6C3Hkh.js";function b(n,e){if(n.symbol!=null)return n.symbol;const r=e?.renderer;return r!=null&&r.type!=="dot-density"?r.getSymbol(n,e):null}function g(n,e){const r=b(n,e);if(r==null)return null;const a=e?.renderer,o=new c(a,r);if(a==null||!("visualVariables"in a)||!a.visualVariables)return o;const p=f(a,n,e)??[],t=["proportional","proportional","proportional"];for(const{variable:i,value:l}of p)if(l!=null||i.type==="size"&&i.useSymbolValue)switch(i.type){case"color":o.color=l?.toRgba();break;case"size":if(i.target==="outline")o.outlineSize=l;else{const u=i.axis,s=i.useSymbolValue?"symbol-value":l??"proportional";switch(u){case"width":t[0]=s;break;case"depth":t[1]=s;break;case"height":t[2]=s;break;case"width-and-depth":t[0]=t[1]=s;break;default:t[0]=t[1]=t[2]=s}}break;case"opacity":o.opacity=l;break;case"rotation":switch(i.axis){case"tilt":o.tilt=l;break;case"roll":o.roll=l;break;default:o.heading=l}}return t[0]==="proportional"&&t[1]==="proportional"&&t[2]==="proportional"||(o.size=t),o}async function d(n,e){return n.symbol!=null?n.symbol:e?.renderer?.getSymbolAsync(n,e)??null}async function k(n,e){const r=await d(n,e);if(!r)return null;const a=e?.renderer,o=new c(a,r);if(!a||!("visualVariables"in a)||!a.visualVariables)return o;const p=f(a,n,e)??[],t=["proportional","proportional","proportional"];for(const{variable:i,value:l}of p)if(i.type==="color")o.color=y.toUnitRGBA(l);else if(i.type==="size")if(i.target==="outline")o.outlineSize=l;else{const u=i.axis,s=i.useSymbolValue?"symbol-value":l;u==="width"?t[0]=s:u==="depth"?t[1]=s:u==="height"?t[2]=s:t[0]=t[1]=u==="width-and-depth"?s:t[2]=s}else i.type==="opacity"?o.opacity=l:i.type==="rotation"&&i.axis==="tilt"?o.tilt=l:i.type==="rotation"&&i.axis==="roll"?o.roll=l:i.type==="rotation"&&(o.heading=l);return(isFinite(t[0])||isFinite(t[1])||isFinite(t[2]))&&(o.size=t),o}function v(n,e=0){const r=n[e];return typeof r=="number"&&isFinite(r)?r:null}function z(n){for(let e=0;e<3;e++){const r=n[e];if(typeof r=="number")return isFinite(r)?r:0}return 0}export{k as g,v as k,g as w,z};
