import{aY as T,T as A,i as f,s as g,aZ as L,$ as M,Y as O,G as C,a4 as U,S as m,a5 as Y,a_ as q,ab as y,w as z,q as w}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";const b=e=>{const t=e;class i extends t{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(n,o){let r=this._listenersMap?.get(n);if(!r)return!1;let l=!1;for(const a of r.slice()){const h="deref"in a?a.deref():a;h?h?.call(this,o):l=!0}return l&&(r=r.filter(a=>!("deref"in a)||a.deref()!=null),this._listenersMap.set(n,r)),r.length>0}on(n,o){if(Array.isArray(n)){const l=n.map(a=>this.on(a,o));return M(l)}if(n.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const r=this._listenersMap.get(n)||[];return r.push(o),this._listenersMap.set(n,r),f(()=>{const l=this._listenersMap?.get(n),a=l?.indexOf(o)??-1;a>=0&&l.splice(a,1)})}once(n,o){const r=this.on(n,l=>{r.remove(),("deref"in o?o.deref():o)?.call(null,l)});return r}hasEventListener(n){const o=this._listenersMap?.get(n);return o!=null&&o.length>0}}return i},Z=b(class{}),J=Z,N=b(w);let k=class{constructor(){this._resolver=y(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(m())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=y(),t=[...this._resolvingPromises,e.promise],i=this._allPromise=Promise.all(t);i.then(()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()},s=>{this.isFulfilled()||this._allPromise!==i||z(s)||this._resolver.reject(s)}),e.resolve()}};const G=e=>{const t=e;let i=class extends t{constructor(...s){super(...s),this._promiseProps=new k,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(s,n){return this._promiseProps.promise.then(()=>this).then(s,n)}catch(s){return this.when(null,s)}addResolvingPromise(s){s&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in s?s.when():s)}addResolvingTask(s){s&&!this._promiseProps.isFulfilled()&&(this.addHandles(q(s)),this._promiseProps.addResolvingPromise(s.promise))}};return i=O([C("esri.core.Promise")],i),i},Q=G(w);let c;const H=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,_=globalThis.document?.documentElement;function E(){const e=_?.getAttribute("lang"),t=globalThis.navigator?.language;return H??e??t??"en"}function v(){return c===void 0&&(c=E()),c}const S=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function V(e=v()){return x(e)?.language}function W(e=v()){const t=x(e);return t?.language&&t?.extlang?e.replace(`${t.language}-`,""):e}function x(e=v()){return S.exec(e)?.groups}const p=[];function X(e){return p.push(e),f(()=>{p.splice(p.indexOf(e),1)})}const d=[];function K(e){return d.push(e),f(()=>d.splice(d.indexOf(e),1))}function R(){const e=E();c!==e&&([...d].forEach(t=>t(e)),c=e,[...p].forEach(t=>t(e)))}globalThis.addEventListener?.("languagechange",R),_&&new MutationObserver(()=>{R()}).observe(_,{attributeFilter:["lang"]});function F(e,t,i={}){return P(e,t,i,$)}function ee(e,t,i={}){return P(e,t,i,j)}function P(e,t,i={},s){let n=null;const o=i.once?(r,l)=>{s(r)&&(g(n),t(r,l))}:(r,l)=>{s(r)&&t(r,l)};if(n=L(e,o,i.sync,i.equals),i.initial){const r=e();o(r,r)}return n}function se(e,t,i,s={}){let n=null,o=null,r=null;function l(){n&&o&&(o.remove(),s.onListenerRemove?.(n),n=null,o=null)}function a(u){s.once&&s.once&&g(r),i(u)}const h=F(e,(u,D)=>{l(),T(u)&&(n=u,o=A(u,t,a),s.onListenerAdd?.(u))},{sync:s.sync,initial:!0});return r=f(()=>{h.remove(),l()}),r}function te(e,t){return B(e,j,t)}function B(e,t,i){if(U(i))return Promise.reject(m());const s=e();if(t?.(s))return Promise.resolve(s);let n=null;function o(){n=g(n)}return new Promise((r,l)=>{n=M([Y(i,()=>{o(),l(m())}),P(e,a=>{o(),r(a)},{sync:!1,once:!0},t??$)])})}function $(e){return!0}function j(e){return!!e}function ne(e,t,i={}){let s=!1;const n=F(e,(o,r)=>{s||t(o,r)},i);return{remove(){n.remove()},pause(){s=!0},resume(){s=!1}}}const re={sync:!0},ie={initial:!0},oe={sync:!0,initial:!0};export{J as I,N as J,Q as N,V as Q,W as S,G as V,X as W,K as e,re as i,F as j,oe as l,ne as n,ie as o,Z as q,te as r,ee as s,se as t,v,b as w};
