const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/knowledgeGraphService-Cw0-23Ab.js","assets/Point-BN8RINcc.js","assets/jsonMap-Bs3hmeCU.js","assets/reader-DcGs6kKN.js","assets/index-C-2WWcaK.js","assets/index-Cv2ko1Ob.css","assets/Extent-Bbnm65bN.js","assets/normalizeUtils-BDt2F_N3.js","assets/Cyclical-BLSxUpe7.js","assets/mathUtils-PIGhLnI9.js","assets/Polygon-BdLNJfwi.js","assets/aaBoundingRect-CrU5VtR_.js","assets/Polyline-BtUG5wiC.js","assets/normalizeUtilsCommon-rK4fWGKa.js","assets/jsonUtils-UGNxUp3z.js","assets/utils-DBDpKdtI.js","assets/utils-DQFbn7-c.js","assets/Field-Cm_ZejYW.js","assets/Color-CERqXxxY.js","assets/fieldType-DVUzXtk_.js","assets/networkEnums-DcxQ-KKD.js","assets/FeatureSet-BzuZ0plV.js","assets/Graphic-BiQTZi7k.js","assets/getPopupProvider-DjIxdahS.js","assets/collectionUtils-Dk3LoVuX.js","assets/reactiveUtils-SO2Ko3sy.js","assets/SimpleObservable-CvFyr0NA.js","assets/lengthUtils-Ceo6858g.js","assets/date-IqUzANpt.js","assets/Layer-Ciy6IOGe.js","assets/typeUtils-Dk-Jta7H.js","assets/createFeatureId-CVwTD0fV.js","assets/typeUtils-W6WEjFtn.js","assets/lineMarkers-CDwLe3J6.js","assets/PolygonSymbol3D-D50k8Fcq.js","assets/ExtrudeSymbol3DLayer-DSc1ou2x.js","assets/screenUtils-BitdhK1O.js","assets/opacityUtils-DuFH0EC9.js","assets/aaBoundingBox-CtkshuSS.js","assets/DoubleArray-DExKNiTh.js","assets/mat4f64-q_b6UJoq.js","assets/Font-Ct7_LYCJ.js","assets/SimpleFillSymbol-CDawtd9z.js","assets/SimpleMarkerSymbol-BGAFRS9_.js","assets/PictureMarkerSymbol-LudhOruE.js","assets/TextSymbol-DH6PXxVy.js","assets/GPMessage-D_4FfUD9.js","assets/GraphQueryStreaming-D2qFG_zN.js"])))=>i.map(i=>d[i]);
import{_ as G}from"./index-C-2WWcaK.js";import{h as N}from"./jsonMap-Bs3hmeCU.js";import{t as q}from"./arcade-DfeE-p9c.js";import{o as _,g as x,k as J,z as I,p as P,c as j,l as T,m as L,w as Q,K as V,U as A}from"./Dictionary-hE24dHJa.js";import{n as m}from"./enum-BzLwmiID.js";import{l as B}from"./portalUtils-UISJBD-C.js";import{c as W,S as O,f as b,ar as U}from"./Point-BN8RINcc.js";import{G as z,L as C,W as H}from"./projectionUtils-zKDw1yLq.js";import{M as k}from"./collectionUtils-Dk3LoVuX.js";import X from"./PortalItem-JZSYzcdX.js";import{p as Y,n as Z}from"./project-8WCTgeGs.js";import{p as $,a as tt,e as rt,i as et,b as nt}from"./GraphQueryStreaming-D2qFG_zN.js";import{s as g,u as S,n as E,y as it}from"./lengthUtils-Ceo6858g.js";import"./arcadeEnvironment-DqZGrNFy.js";import"./Feature-pxcCplku.js";import"./TimeOnly-Du0ClqSA.js";import"./UnknownTimeZone-B697BDFv.js";import"./date-IqUzANpt.js";import"./reactiveUtils-SO2Ko3sy.js";import"./Extent-Bbnm65bN.js";import"./jsonUtils-UGNxUp3z.js";import"./Polyline-BtUG5wiC.js";import"./Polygon-BdLNJfwi.js";import"./aaBoundingRect-CrU5VtR_.js";import"./mathUtils-PIGhLnI9.js";import"./featureConversionUtils-yVOZE0te.js";import"./aaBoundingBox-CtkshuSS.js";import"./DoubleArray-DExKNiTh.js";import"./mat4f64-q_b6UJoq.js";import"./OptimizedFeature-CwRGZPwv.js";import"./memoryEstimations-Bd726a_p.js";import"./OptimizedFeatureSet-BR8EEvDc.js";import"./createFeatureId-CVwTD0fV.js";import"./FieldsIndex-B72TFK42.js";import"./timeZoneUtils-BSc7-7qA.js";import"./aiServices-DBi3_uiS.js";import"./commonProperties-DHiB1uzW.js";import"./utils-DBDpKdtI.js";import"./ImmutableArray-BPVd6ESQ.js";import"./shared-CcvWoc0W.js";import"./Field-Cm_ZejYW.js";import"./Color-CERqXxxY.js";import"./reader-DcGs6kKN.js";import"./fieldType-DVUzXtk_.js";import"./WhereClause-BCLJDkvF.js";import"./streamLayerUtils-DFlbJ4P1.js";import"./unitConversion-BRJSqqQ6.js";import"./number-D_FvV3D1.js";import"./hash-CcEbRgUF.js";import"./uuid-Oe6SV2kF.js";import"./SimpleObservable-CvFyr0NA.js";import"./utils-DQFbn7-c.js";let l=null;async function ot(t){const r=N.geometryServiceUrl??"";if(!r){z()||await C();for(const e of t)e.container[e.indexer]=H(e.container[e.indexer],b.WGS84);return}const n=t.map(e=>e.container[e.indexer]),o=new Y({geometries:n,outSpatialReference:b.WGS84}),p=await Z(r,o);for(let e=0;e<p.length;e++){const i=t[e];i.container[i.indexer]=p[e]}}async function D(t,r){const n=new X({portal:t,id:r});return await n.load(),l===null&&(l=await G(()=>import("./knowledgeGraphService-Cw0-23Ab.js").then(o=>o.k),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]))),await l.fetchKnowledgeGraph(n.url)}function v(t,r,n,o,p){if(t===null)return null;if(g(t)||E(t))return t;if(T(t)||T(t))return t.toJSDate();if(L(t))return t.toStorageFormat();if(Q(t))return t.toStorageString();if(V(t)){const e={};for(const i of t.keys())e[i]=v(t.field(i),r,n,o,p),e[i]instanceof W&&p.push({container:e,indexer:i});return e}if(S(t)){const e=t.map(i=>v(i,r,n,o,p));for(let i=0;i<e.length;i++)e[i]instanceof W&&p.push({container:e,indexer:i});return e}return A(t)?t.spatialReference.isWGS84?t:t.spatialReference.isWebMercator&&r?O(t):t:void 0}function at(t,r){if(!t)return t;if(t.spatialReference.isWGS84&&r.spatialReference.isWebMercator)return U(t);if(t.spatialReference.equals(r.spatialReference))return t;throw new m(r,"WrongSpatialReference",null)}function y(t,r){if(!t)return null;const n={};for(const o in t)n[o]=u(t[o],r);return n}function u(t,r){return t===null?null:S(t)?t.map(n=>u(n,r)):t instanceof tt?{graphTypeName:t.typeName,id:t.id,graphType:"entity",properties:y(t.properties,r)}:t instanceof rt?{graphType:"object",properties:y(t.properties,r)}:t instanceof et?{graphTypeName:t.typeName,id:t.id,graphType:"relationship",originId:t.originId??null,destinationId:t.destinationId??null,properties:y(t.properties,r)}:t instanceof nt?{graphType:"path",path:t.path?t.path.map(n=>u(n,r)):null}:A(t)?at(t,r):g(t)||E(t)||it(t)?t:null}function or(t){t.mode==="async"&&(t.functions.knowledgegraphbyportalitem=function(r,n){return t.standardFunctionAsync(r,n,(o,p,e)=>{if(_(e,2,2,r,n),e[0]===null)throw new m(r,"PortalRequired",n);if(e[0]instanceof q){const c=x(e[1]);let f;return f=r.services?.portal?r.services.portal:k.getDefault(),D(B(e[0],f),c)}if(g(e[0])===!1)throw new m(r,"InvalidParameter",n);const i=x(e[0]);return D(r.services?.portal??k.getDefault(),i)})},t.signatures.push({name:"knowledgegraphbyportalitem",min:2,max:2}),t.functions.querygraph=function(r,n){return t.standardFunctionAsync(r,n,async(o,p,e)=>{_(e,2,4,r,n);const i=e[0];if(!J(i))throw new m(r,"InvalidParameter",n);const c=e[1];if(!g(c))throw new m(r,"InvalidParameter",n);l===null&&(l=await G(()=>import("./knowledgeGraphService-Cw0-23Ab.js").then(a=>a.k),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47])));let f=null;const d=I(e[2],null);if(!(d instanceof P||d===null))throw new m(r,"InvalidParameter",n);if(d){let a=[];f=v(d,!0,!1,r,a),a=a.filter(s=>!s.container[s.indexer].spatialReference.isWGS84),a.length>0&&await ot(a)}const F=I(e[3],!1),R=new $({openCypherQuery:c,bindParameters:f,provenanceBehavior:F?"include":"exclude"});(i?.serviceDefinition?.currentVersion??11.3)>11.2&&(R.outputSpatialReference=r.spatialReference);const K=(await l.executeQueryStreaming(i,R)).resultRowsStream.getReader(),w=[];try{for(;;){const{done:a,value:s}=await K.read();if(a)break;if(S(s))for(const h of s)w.push(u(h,r));else{const h=[];for(const M of s)h.push(u(s[M],r));w.push(h)}}}catch(a){throw a}return P.convertJsonToArcade(w,j(r),!1,!0)})},t.signatures.push({name:"querygraph",min:2,max:4}))}export{or as registerFunctions};
