const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/knowledgeGraphService-CR1YtEl2.js","assets/Point-B6yFWNoR.js","assets/jsonMap-Bs3hmeCU.js","assets/reader-DcGs6kKN.js","assets/index-CAyy5ces.js","assets/index-DmB13pS_.css","assets/Extent-D4kxmHSf.js","assets/normalizeUtils-9qNRso4M.js","assets/Cyclical-BLSxUpe7.js","assets/mathUtils-PIGhLnI9.js","assets/Polygon-BUi4eoGW.js","assets/aaBoundingRect-F1Nk1aID.js","assets/Polyline-CiznIgZG.js","assets/normalizeUtilsCommon-C6mtpeei.js","assets/jsonUtils-BGiBUdmT.js","assets/utils-CIVJ4xuJ.js","assets/utils-CMK6z7yl.js","assets/Field-Cm_ZejYW.js","assets/Color-CERqXxxY.js","assets/fieldType-DVUzXtk_.js","assets/networkEnums-DcxQ-KKD.js","assets/FeatureSet-BuKEbgxR.js","assets/Graphic-B5lJuCvi.js","assets/getPopupProvider-mvkAgiBn.js","assets/collectionUtils-yEu3-UXw.js","assets/reactiveUtils-SO2Ko3sy.js","assets/SimpleObservable-CvFyr0NA.js","assets/lengthUtils-BsZbNiqt.js","assets/date-IqUzANpt.js","assets/Layer-B6AWeI6O.js","assets/typeUtils-BzzgRKyX.js","assets/createFeatureId-CVwTD0fV.js","assets/typeUtils-cI568bV6.js","assets/lineMarkers-CDwLe3J6.js","assets/PolygonSymbol3D-DuQ13Get.js","assets/ExtrudeSymbol3DLayer-DSc1ou2x.js","assets/screenUtils-BitdhK1O.js","assets/opacityUtils-DuFH0EC9.js","assets/aaBoundingBox-CVMQtR0c.js","assets/DoubleArray-DExKNiTh.js","assets/mat4f64-q_b6UJoq.js","assets/Font-DF-HycCW.js","assets/SimpleFillSymbol-CDawtd9z.js","assets/SimpleMarkerSymbol-BGAFRS9_.js","assets/PictureMarkerSymbol-_eQf1cyL.js","assets/TextSymbol-BjfCHbpC.js","assets/GPMessage-D_4FfUD9.js","assets/GraphQueryStreaming-CeOPnYVe.js"])))=>i.map(i=>d[i]);
import{_ as G}from"./index-CAyy5ces.js";import{h as N}from"./jsonMap-Bs3hmeCU.js";import{t as q}from"./arcade-DLiYBR5L.js";import{o as _,g as x,k as J,z as I,p as P,c as j,l as T,m as L,w as Q,K as V,U as A}from"./Dictionary-Bq-tK4wY.js";import{n as m}from"./enum-BzLwmiID.js";import{l as B}from"./portalUtils-BqITD153.js";import{c as W,S as O,f as b,ar as U}from"./Point-B6yFWNoR.js";import{G as z,L as C,W as H}from"./projectionUtils-DIbtnzb-.js";import{M as k}from"./collectionUtils-yEu3-UXw.js";import X from"./PortalItem-eLNwGntE.js";import{p as Y,n as Z}from"./project-BZD5iIJO.js";import{p as $,a as tt,e as rt,i as et,b as nt}from"./GraphQueryStreaming-CeOPnYVe.js";import{s as g,u as S,n as E,y as it}from"./lengthUtils-BsZbNiqt.js";import"./arcadeEnvironment-DqZGrNFy.js";import"./Feature-DCC0XPGS.js";import"./TimeOnly-CyjHJh3J.js";import"./UnknownTimeZone-B697BDFv.js";import"./date-IqUzANpt.js";import"./reactiveUtils-SO2Ko3sy.js";import"./Extent-D4kxmHSf.js";import"./jsonUtils-BGiBUdmT.js";import"./Polyline-CiznIgZG.js";import"./Polygon-BUi4eoGW.js";import"./aaBoundingRect-F1Nk1aID.js";import"./mathUtils-PIGhLnI9.js";import"./featureConversionUtils-BIy1MIBK.js";import"./aaBoundingBox-CVMQtR0c.js";import"./DoubleArray-DExKNiTh.js";import"./mat4f64-q_b6UJoq.js";import"./OptimizedFeature-CwRGZPwv.js";import"./memoryEstimations-Bd726a_p.js";import"./OptimizedFeatureSet-BR8EEvDc.js";import"./createFeatureId-CVwTD0fV.js";import"./FieldsIndex-DldSuWRM.js";import"./timeZoneUtils-BSc7-7qA.js";import"./aiServices-DzxHgSeN.js";import"./commonProperties-DHiB1uzW.js";import"./utils-CIVJ4xuJ.js";import"./ImmutableArray-BPVd6ESQ.js";import"./shared-FB9t6kGf.js";import"./Field-Cm_ZejYW.js";import"./Color-CERqXxxY.js";import"./reader-DcGs6kKN.js";import"./fieldType-DVUzXtk_.js";import"./WhereClause-NcmP8V3L.js";import"./streamLayerUtils-DFlbJ4P1.js";import"./unitConversion-D_gGkVyw.js";import"./number-D_FvV3D1.js";import"./hash-CcEbRgUF.js";import"./uuid-Oe6SV2kF.js";import"./SimpleObservable-CvFyr0NA.js";import"./utils-CMK6z7yl.js";let l=null;async function ot(t){const r=N.geometryServiceUrl??"";if(!r){z()||await C();for(const e of t)e.container[e.indexer]=H(e.container[e.indexer],b.WGS84);return}const n=t.map(e=>e.container[e.indexer]),o=new Y({geometries:n,outSpatialReference:b.WGS84}),p=await Z(r,o);for(let e=0;e<p.length;e++){const i=t[e];i.container[i.indexer]=p[e]}}async function D(t,r){const n=new X({portal:t,id:r});return await n.load(),l===null&&(l=await G(()=>import("./knowledgeGraphService-CR1YtEl2.js").then(o=>o.k),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]))),await l.fetchKnowledgeGraph(n.url)}function v(t,r,n,o,p){if(t===null)return null;if(g(t)||E(t))return t;if(T(t)||T(t))return t.toJSDate();if(L(t))return t.toStorageFormat();if(Q(t))return t.toStorageString();if(V(t)){const e={};for(const i of t.keys())e[i]=v(t.field(i),r,n,o,p),e[i]instanceof W&&p.push({container:e,indexer:i});return e}if(S(t)){const e=t.map(i=>v(i,r,n,o,p));for(let i=0;i<e.length;i++)e[i]instanceof W&&p.push({container:e,indexer:i});return e}return A(t)?t.spatialReference.isWGS84?t:t.spatialReference.isWebMercator&&r?O(t):t:void 0}function at(t,r){if(!t)return t;if(t.spatialReference.isWGS84&&r.spatialReference.isWebMercator)return U(t);if(t.spatialReference.equals(r.spatialReference))return t;throw new m(r,"WrongSpatialReference",null)}function y(t,r){if(!t)return null;const n={};for(const o in t)n[o]=u(t[o],r);return n}function u(t,r){return t===null?null:S(t)?t.map(n=>u(n,r)):t instanceof tt?{graphTypeName:t.typeName,id:t.id,graphType:"entity",properties:y(t.properties,r)}:t instanceof rt?{graphType:"object",properties:y(t.properties,r)}:t instanceof et?{graphTypeName:t.typeName,id:t.id,graphType:"relationship",originId:t.originId??null,destinationId:t.destinationId??null,properties:y(t.properties,r)}:t instanceof nt?{graphType:"path",path:t.path?t.path.map(n=>u(n,r)):null}:A(t)?at(t,r):g(t)||E(t)||it(t)?t:null}function or(t){t.mode==="async"&&(t.functions.knowledgegraphbyportalitem=function(r,n){return t.standardFunctionAsync(r,n,(o,p,e)=>{if(_(e,2,2,r,n),e[0]===null)throw new m(r,"PortalRequired",n);if(e[0]instanceof q){const c=x(e[1]);let f;return f=r.services?.portal?r.services.portal:k.getDefault(),D(B(e[0],f),c)}if(g(e[0])===!1)throw new m(r,"InvalidParameter",n);const i=x(e[0]);return D(r.services?.portal??k.getDefault(),i)})},t.signatures.push({name:"knowledgegraphbyportalitem",min:2,max:2}),t.functions.querygraph=function(r,n){return t.standardFunctionAsync(r,n,async(o,p,e)=>{_(e,2,4,r,n);const i=e[0];if(!J(i))throw new m(r,"InvalidParameter",n);const c=e[1];if(!g(c))throw new m(r,"InvalidParameter",n);l===null&&(l=await G(()=>import("./knowledgeGraphService-CR1YtEl2.js").then(a=>a.k),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47])));let f=null;const d=I(e[2],null);if(!(d instanceof P||d===null))throw new m(r,"InvalidParameter",n);if(d){let a=[];f=v(d,!0,!1,r,a),a=a.filter(s=>!s.container[s.indexer].spatialReference.isWGS84),a.length>0&&await ot(a)}const F=I(e[3],!1),R=new $({openCypherQuery:c,bindParameters:f,provenanceBehavior:F?"include":"exclude"});(i?.serviceDefinition?.currentVersion??11.3)>11.2&&(R.outputSpatialReference=r.spatialReference);const K=(await l.executeQueryStreaming(i,R)).resultRowsStream.getReader(),w=[];try{for(;;){const{done:a,value:s}=await K.read();if(a)break;if(S(s))for(const h of s)w.push(u(h,r));else{const h=[];for(const M of s)h.push(u(s[M],r));w.push(h)}}}catch(a){throw a}return P.convertJsonToArcade(w,j(r),!1,!0)})},t.signatures.push({name:"querygraph",min:2,max:4}))}export{or as registerFunctions};
