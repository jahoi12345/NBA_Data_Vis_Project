import{H as h}from"./Point-BfTTZoMu-BAT2Wq6O.js";import{o as f,ar as m}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{m as y,u as v}from"./infoFor3D-DhzudQro-CCYgWfsv.js";class q{constructor(s,t,r){this.assetName=s,this.assetMimeType=t,this.parts=r}equals(s){return this===s||this.assetName===s.assetName&&this.assetMimeType===s.assetMimeType&&m(this.parts,s.parts,(t,r)=>t.equals(r))}isOnService(s){return this.parts.every(t=>t.isOnService(s))}makeHash(){let s="";for(const t of this.parts)s+=t.partHash;return s}async toBlob(s){const{parts:t}=this;if(t.length===1)return t[0].toBlob(s);const r=await Promise.all(t.map(n=>n.toBlob(s)));return f(s),new Blob(r)}}class w{constructor(s,t){this.partUrl=s,this.partHash=t}equals(s){return this===s||this.partUrl===s.partUrl&&this.partHash===s.partHash}isOnService(s){return this.partUrl.startsWith(`${s.path}/assets/`)}async toBlob(s){const{data:t}=await h(this.partUrl,{responseType:"blob"});return f(s),t}}function B(e){return b(e?.source)}const l=/^(model\/gltf\+json)|(model\/gltf-binary)$/,c=/\.(gltf|glb)/i;function b(e){switch(e?.type){case"client":return Array.isArray(e.files)?e.files.some(i):i(e.files);case"service":return e.assets.some(i);case"loadable":return!0;default:return!1}}function i(e){if(e instanceof File){const{type:s,name:t}=e;return l.test(s)||c.test(t)}return l.test(e.assetMimeType)||c.test(e.assetName)}function H(e,s){if(!e)return!1;const{source:t}=e;return g(t,s)}function M(e,s){if(e===s)return!0;const{source:t}=e,{source:r}=s;if(t===r)return!0;if(t.type==="service"&&r.type==="service"){if(t.assets.length!==r.assets.length)return!1;const n=(a,u)=>a.assetName<u.assetName?-1:a.assetName>u.assetName?1:0,o=[...t.assets].sort(n),p=[...r.assets].sort(n);for(let a=0;a<o.length;++a)if(!o[a].equals(p[a]))return!1;return!0}return!1}function g(e,s){return e.type==="service"&&e.assets.every(t=>t.isOnService(s))}function U(e,s){return e instanceof File?y(e,s):v(e.assetMimeType,e.assetName,s)}function A(e){switch(e.type){case"client":return Array.isArray(e.files)?e.files:[e.files];case"service":return e.assets;case"loadable":return}}function O(e){return!!e.original}export{q as $,O as A,H as B,M,w as T,U,A as q,B as w};
