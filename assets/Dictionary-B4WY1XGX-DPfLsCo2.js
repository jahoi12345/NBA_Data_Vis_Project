import{r as x,u as Fe,J as De,m as Oe}from"./TimeOnly-BERR31kg-CQiLyUZi.js";import{N as ve,aH as Je}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{c as k,b as D,b6 as Me,f as Ie}from"./Point-BfTTZoMu-DeJwQYfh.js";import{u as Z}from"./enum-BzLwmiID-CcyIdWlQ.js";import{h as C}from"./ImmutableArray-BPVd6ESQ-BGk4ZTNG.js";import{I as Re,B as me}from"./shared-yd-CR64C-BEo7YVMh.js";import{A as Pe,I as je}from"./number-D_FvV3D1-OQFavbmh.js";import{z as Q}from"./Extent-CgDMOSRD-Bod5LY6s.js";import{n as X,o as $}from"./Polyline-CoiTLswR-DTxpB2Yg.js";import{P as ee,C as Le}from"./Polygon-D6wEPb3W-D2MPjRU4.js";import{P as Ye}from"./jsonUtils-CmpazY1u-6pDLj5sx.js";import{v as ge}from"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import{W as p,J as b,f as y,Z as N,Y as L,j as ze,K as Ge}from"./lengthUtils-Dt1_RvOO-j3MEdmHu.js";import{m as ye}from"./date-IqUzANpt-bLKO9IDT.js";let te=class{};class M{constructor(){}}function pe(e,t,r){if(e instanceof M&&!(e instanceof U)){const a=new U;return a.fn=e,a.parameterEvaluator=r,a.context=t,a}return e}class Pt extends M{constructor(t){super(),this.fn=t}createFunction(t){return(...r)=>this.fn(t,{preparsed:!0,arguments:r})}call(t,r){return this.fn(t,r)}marshalledCall(t,r,a,s){return s(t,r,(i,n,o)=>{o=o.map(c=>c instanceof M&&!(c instanceof U)?pe(c,t,s):c);const m=this.call(a,{args:o});return ve(m)?m.then(c=>pe(c,a,s)):m})}}class U extends M{constructor(){super(...arguments),this.fn=null,this.context=null}createFunction(t){return this.fn.createFunction(this.context)}call(t,r){return this.fn.marshalledCall(t,r,this.context,this.parameterEvaluator)}marshalledCall(t,r,a){return this.fn.marshalledCall(t,r,this.context,this.parameterEvaluator)}}let R=class Se extends C{constructor(t,r,a,s,i,n){super(t),this._lazyPt=[],this._hasZ=!1,this._hasM=!1,this._spRef=r,this._hasZ=a,this._hasM=s,this._cacheId=i,this._partId=n}get(t){if(this._lazyPt[t]===void 0){const r=this._elements[t];if(r===void 0)return;const a=new D(r[0],r[1],this._spRef);this._hasZ&&(a.z=r[2]),this._hasM&&(a.m=this._hasZ?r[3]:r[2]),a.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+t.toString(),this._lazyPt[t]=a}return this._lazyPt[t]}equalityTest(t){return t===this||t!==null&&t instanceof Se&&t.getUniqueHash()===this.getUniqueHash()}getUniqueHash(){return this._cacheId.toString()+"-"+this._partId.toString()}};class re extends C{constructor(t,r,a,s,i){super(t),this._lazyPath=[],this._hasZ=!1,this._hasM=!1,this._hasZ=a,this._hasM=s,this._spRef=r,this._cacheId=i}get(t){if(this._lazyPath[t]===void 0){const r=this._elements[t];if(r===void 0)return;this._lazyPath[t]=new R(r,this._spRef,this._hasZ,this._hasM,this._cacheId,t)}return this._lazyPath[t]}equalityTest(t){return t===this||t!==null&&t instanceof re&&t.getUniqueHash()===this.getUniqueHash()}getUniqueHash(){return this._cacheId.toString()}}class Ve{constructor(t){this.value=t}}class qe{constructor(t){this.value=t}}const g={type:"VOID"},Ee=Symbol("BREAK"),He=Symbol("CONTINUE");function I(e,t,r){return t===""||t==null||t===r||t===r?e:e=e.split(t).join(r)}function J(e){return e instanceof M}function se(e){return e instanceof te}function O(e){return!!y(e)||!!b(e)||!!l(e)||!!h(e)||!!d(e)||!!p(e)||e===null||e===g}function Ue(e,t){return e===void 0?t:e}function We(e){return e==null?"":N(e)||T(e)?"Array":l(e)?"Date":d(e)?"Time":h(e)?"DateOnly":y(e)?"String":p(e)?"Boolean":b(e)?"Number":e?.declaredClass==="esri.arcade.Attachment"?"Attachment":e?.declaredClass==="esri.arcade.Portal"?"Portal":e?.declaredClass==="esri.arcade.Dictionary"?"Dictionary":le(e)?"KnowledgeGraph":e instanceof te?"Module":P(e)?"Feature":e instanceof D?"Point":e instanceof ee?"Polygon":e instanceof X?"Polyline":e instanceof $?"Multipoint":e instanceof Q?"Extent":J(e)?"Function":ne(e)?"FeatureSet":oe(e)?"FeatureSetCollection":ae(e)?"Voxel":ie(e)?"Pixel":e===g?"":typeof e=="number"&&isNaN(e)?"Number":"Unrecognized Type"}function Ne(e){return e===g}function V(e){return e instanceof k}function P(e){return e?.arcadeDeclaredClass==="esri.arcade.Feature"}function ae(e){return e?.arcadeDeclaredClass==="esri.arcade.Voxel"}function ie(e){return e?.arcadeDeclaredClass==="esri.arcade.Pixel"}function ne(e){return e?.declaredRootClass==="esri.arcade.featureset.support.FeatureSet"}function ue(e){return e?.declaredClass==="esri.arcade.Dictionary"}function Be(e){return ue(e)||P(e)||ae(e)||ie(e)}function oe(e){return e?.declaredRootClass==="esri.arcade.featureSetCollection"}function le(e){return e?.declaredClass==="esri.rest.knowledgeGraph.KnowledgeGraph"}function T(e){return e instanceof C}function l(e){return e instanceof x}function h(e){return e instanceof De}function d(e){return e instanceof Fe}function W(e){return e!=null&&typeof e=="object"}function Ke(e,t,r,a,s){if(e.length<t||e.length>r)throw new Z(a,"WrongNumberOfParameters",s)}function Qe(e){return e==null||Ne(e)||e===""}function Xe(e){return e<0?-Math.round(-e):Math.round(e)}function ce(e,t){return isNaN(e)||t==null||t===""?e.toString():(t=I(t,"‰",""),t=I(t,"¤",""),Pe(e,{pattern:t}))}function q(e,t){return t==null||t===""?e.toISOString(!0):e.toFormat(Ze(t),{locale:ge(),numberingSystem:"latn"})}function Ze(e,t=!1){e=e.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let r="";const a=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|Z{1,5}|.)/g;for(const s of e.match(a)||[])switch(s){case"D":r+="d";break;case"DD":r+="dd";break;case"DDD":r+="o";break;case"d":r+="c";break;case"ddd":r+="ccc";break;case"dddd":r+="cccc";break;case"M":r+="L";break;case"MM":r+="LL";break;case"MMM":r+="LLL";break;case"MMMM":r+="LLLL";break;case"YY":r+="yy";break;case"Y":case"YYYY":r+="yyyy";break;case"Q":r+="q";break;case"Z":r+="Z";break;case"ZZ":r+="ZZ";break;case"ZZZ":r+="ZZZ";break;case"ZZZZ":r+=t?"[ZZZZ]":"ZZZZ";break;case"ZZZZZ":r+=t?"[ZZZZZ]":"ZZZZZ";break;case"S":r+="'S'";break;case"SS":r+="'SS'";break;case"SSS":r+="u";break;case"A":case"a":r+="a";break;case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":case"X":case"x":r+=s;break;default:s.length>=2&&s.startsWith("[")&&s.endsWith("]")?r+=`'${s.slice(1,-1)}'`:r+=`'${s}'`}return r}function u(e,t,r){switch(r){case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}return!1}function $e(e,t,r){if(e===null){if(t===null||t===g)return u(null,null,r);if(b(t))return u(0,t,r);if(y(t)||p(t))return u(0,f(t),r);if(l(t))return u(0,t.toNumber(),r);if(d(t)||h(t))return u(e,t.toNumber(),r)}if(e===g){if(t===null||t===g)return u(null,null,r);if(b(t))return u(0,t,r);if(y(t)||p(t))return u(0,f(t),r);if(l(t))return u(0,t.toNumber(),r);if(d(t)||h(t))return u(e,t.toNumber(),r)}else if(b(e)){if(b(t))return u(e,t,r);if(p(t))return u(e,f(t),r);if(t===null||t===g)return u(e,0,r);if(y(t))return u(e,f(t),r);if(l(t)||d(t)||h(t))return u(e,t.toNumber(),r)}else if(y(e)){if(y(t))return u(w(e),w(t),r);if(l(t)||d(t)||h(t))return u(f(e),t.toNumber(),r);if(b(t))return u(f(e),t,r);if(t===null||t===g)return u(f(e),0,r);if(p(t))return u(f(e),f(t),r)}else if(l(e)){if(l(t))return e.timeZone!==t.timeZone&&(e.isUnknownTimeZone?e=x.arcadeDateAndZoneToArcadeDate(e,t.timeZone):t.isUnknownTimeZone&&(t=x.arcadeDateAndZoneToArcadeDate(t,e.timeZone))),u(e.toNumber(),t.toNumber(),r);if(t===null||t===g)return u(e.toNumber(),0,r);if(b(t))return u(e.toNumber(),t,r);if(p(t)||y(t))return u(e.toNumber(),f(t),r);if(d(t))throw new Z(null,"CannotCompareDateAndTime",null);if(h(t))return u(e.toNumber(),t.toNumber(),r)}else if(p(e)){if(p(t))return u(e,t,r);if(b(t))return u(f(e),f(t),r);if(l(t)||d(t)||h(t))return u(f(e),t.toNumber(),r);if(t===null||t===g)return u(f(e),0,r);if(y(t))return u(f(e),f(t),r)}else if(h(e)){if(l(t))return u(e.toNumber(),t.toNumber(),r);if(t===null||t===g)return u(e.toNumber(),0,r);if(b(t))return u(e.toNumber(),t,r);if(p(t)||y(t))return u(e.toNumber(),f(t),r);if(d(t))throw new Z(null,"CannotCompareDateAndTime",null);if(h(t))return u(e.toNumber(),t.toNumber(),r)}else if(d(e)){if(l(t))throw new Z(null,"CannotCompareDateAndTime",null);if(t===null||t===g)return u(e.toNumber(),0,r);if(b(t))return u(e.toNumber(),t,r);if(p(t)||y(t))return u(e.toNumber(),f(t),r);if(d(t))return u(e.toNumber(),t.toNumber(),r);if(h(t))throw new Z(null,"CannotCompareDateAndTime",null)}return!!Te(e,t)&&(r==="<="||r===">=")}function Te(e,t){if(e===t||e===null&&t===g||t===null&&e===g)return!0;if(l(e)&&l(t)||d(e)&&d(t)||h(e)&&h(t))return e.equals(t);if(e instanceof re||e instanceof R)return e.equalityTest(t);if(e instanceof D&&t instanceof D){const r=e.cache._arcadeCacheId,a=t.cache._arcadeCacheId;if(r!=null)return r===a}return!!(W(e)&&W(t)&&(e._arcadeCacheId===t._arcadeCacheId&&e._arcadeCacheId!==void 0&&e._arcadeCacheId!==null||e._underlyingGraphic===t._underlyingGraphic&&e._underlyingGraphic!==void 0&&e._underlyingGraphic!==null))}function _e(e,{useNumbersForDates:t}){let r="";for(const a in e){r!==""&&(r+=",");const s=e[a];s==null?r+=JSON.stringify(a)+":null":p(s)||b(s)||y(s)?r+=JSON.stringify(a)+":"+JSON.stringify(s):V(s)?r+=JSON.stringify(a)+":"+Y(s):d(s)||h(s)?r+=`${JSON.stringify(a)}:${JSON.stringify(s.toString())}`:T(s)||Array.isArray(s)?r+=JSON.stringify(a)+":"+Y(s,null,t):l(s)?r+=t?JSON.stringify(a)+":"+JSON.stringify(s.getTime()):JSON.stringify(a)+":"+s.stringify():s!==null&&typeof s=="object"&&"castToText"in s&&(r+=JSON.stringify(a)+":"+s.castToText(t))}return"{"+r+"}"}function w(e,t){if(y(e))return e;if(e===null)return"";if(b(e))return ce(e,t);if(p(e))return e.toString();if(l(e))return q(e,t);if(d(e)||h(e))return e.toFormat(t);if(e instanceof k)return JSON.stringify(e.toJSON());if(N(e)){const r=[];for(let a=0;a<e.length;a++)r[a]=z(e[a]);return"["+r.join(",")+"]"}if(e instanceof C){const r=[];for(let a=0;a<e.length();a++)r[a]=z(e.get(a));return"["+r.join(",")+"]"}return e!==null&&typeof e=="object"&&"castToText"in e?e.castToText():J(e)?"object, Function":e===g?"":se(e)?"object, Module":""}function et(e){const t=[];if(e instanceof C){for(let r=0;r<e.length();r++)t[r]=f(e.get(r));return t}if(!N(e))return null;for(let r=0;r<e.length;r++)t[r]=f(e[r]);return t}function Y(e,t,r=!1){if(y(e))return e;if(e===null)return"";if(b(e))return ce(e,t);if(p(e))return e.toString();if(l(e))return q(e,t);if(d(e)||h(e))return e.toFormat(t);if(e instanceof k)return e instanceof Q?'{"xmin":'+e.xmin.toString()+',"ymin":'+e.ymin.toString()+","+(e.hasZ?'"zmin":'+e.zmin.toString()+",":"")+(e.hasM?'"mmin":'+e.mmin.toString()+",":"")+'"xmax":'+e.xmax.toString()+',"ymax":'+e.ymax.toString()+","+(e.hasZ?'"zmax":'+e.zmax.toString()+",":"")+(e.hasM?'"mmax":'+e.mmax.toString()+",":"")+'"spatialReference":'+B(e.spatialReference)+"}":B(e.toJSON(),(a,s)=>a.key===s.key?0:a.key==="spatialReference"?1:s.key==="spatialReference"||a.key<s.key?-1:a.key>s.key?1:0);if(N(e)){const a=[];for(let s=0;s<e.length;s++)a[s]=z(e[s],r);return"["+a.join(",")+"]"}if(e instanceof C){const a=[];for(let s=0;s<e.length();s++)a[s]=z(e.get(s),r);return"["+a.join(",")+"]"}return e!==null&&typeof e=="object"&&"castToText"in e?e.castToText(r):J(e)?"object, Function":e===g?"":se(e)?"object, Module":""}function z(e,t=!1){if(e===null)return"null";if(p(e)||y(e))return JSON.stringify(e);if(b(e))return e.toString();if(e instanceof k||e instanceof C||Array.isArray(e))return Y(e,null,t);if(l(e))return JSON.stringify(t?e.getTime():q(e,""));if(d(e)||h(e))return JSON.stringify(e.toString());if(e!==null&&typeof e=="object"){if("castToText"in e)return e.castToText(t)}else if(e===g)return"null";return"null"}function f(e,t){return b(e)?e:e===null||e===""?0:l(e)||h(e)||d(e)?NaN:p(e)?e?1:0:N(e)||e===""||e===void 0?NaN:t!==void 0&&y(e)?(t=I(t,"‰",""),t=I(t,"¤",""),je(e,{pattern:t})):e===g?0:Number(e)}function tt(e,t){if(l(e))return e;if(y(e)){const r=rt(e,t);if(r)return x.dateTimeToArcadeDate(r)}return null}function rt(e,t){const r=/ (\d\d)/,a=Oe(t);let s=ye.fromISO(e,{zone:a});return s.isValid||r.test(e)&&(e=e.replace(r,"T$1"),s=ye.fromISO(e,{zone:t}),s.isValid)?s:null}function st(e){return p(e)?e:y(e)?(e=e.toLowerCase())==="true":!!b(e)&&e!==0&&!isNaN(e)}function at(e,t){const r=JSON.parse(e);return r&&!r.spatialReference&&(r.spatialReference=t),Ye(r)}function it(e,t){return e==null?null:(e.spatialReference!==null&&e.spatialReference!==void 0||(e.spatialReference=t),e)}function nt(e){if(e===null)return null;if(e instanceof D)return e.x==="NaN"||e.x===null||isNaN(e.x)?null:e;if(e instanceof ee){if((e.curveRings??e.rings).length===0)return null;for(const t of e.curveRings??e.rings)if(t.length>0)return e;return null}if(e instanceof X){if((e.curvePaths??e.paths).length===0)return null;for(const t of e.curvePaths??e.paths)if(t.length>0)return e;return null}return e instanceof $?e.points.length===0?null:e:e instanceof Q?e.xmin==="NaN"||e.xmin===null||isNaN(e.xmin)?null:e:null}function we(e,t){if(!e||!e.domain)return t;let r=null,a=null;if(l(t))r=t.toNumber();else if(h(t))r=t.toString();else if(d(t))r=t.toStorageString();else if(e.field.type==="string"||e.field.type==="esriFieldTypeString")r=w(t);else{if(t==null)return null;if(t==="")return t;r=f(t)}for(let s=0;s<e.domain.codedValues.length;s++){const i=e.domain.codedValues[s];i.code===r&&(a=i)}return a===null?w(t):a.name}function Ce(e,t){if(!e||!e.domain)return t;let r=null;const a=w(t);for(let s=0;s<e.domain.codedValues.length;s++){const i=e.domain.codedValues[s];i.name===a&&(r=i)}return r===null?t:r.code}function E(e,t,r=null,a=null){if(!t||!t.fields)return null;let s,i,n=null;for(let S=0;S<t.fields.length;S++){const _=t.fields[S];_.name.toLowerCase()===e.toString().toLowerCase()&&(n=_)}if(n===null)throw new Z(null,"FieldNotFound",null,{key:e});let o=t.typeIdField,m="id",c=t.types;if(t.subtypeField&&(o=t.subtypeField,m="code",c=t.subtypes??[]),a===null&&r&&o)a=r.hasField(o)?r.field(o):null;else if(o&&a!==null){let S=!1;for(const _ of c||[])if(a===_[m]){S=!0;break}if(!S){for(const _ of c||[])if(a===_.name){a=_[m],S=!0;break}}S||(a=null,r&&o&&(a=r.hasField(o)?r.field(o):null))}return a!=null&&c.some(S=>S[m]===a&&(s=S.domains?.[n.name],s&&s.type==="inherited"&&(s=be(n.name,t),i=!0),!0)),i||s||(s=be(e,t)),{field:n,domain:s}}function be(e,t){let r;return t.fields.some(a=>(a.name.toLowerCase()===e.toLowerCase()&&(r=a.domain),!!r)),r}function B(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});const r=typeof t.cycles=="boolean"&&t.cycles,a=t.cmp&&(s=t.cmp,function(n){return function(o,m){const c={key:o,value:n[o]},S={key:m,value:n[m]};return s(c,S)}});var s;const i=[];return(function n(o){if(o?.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o===void 0)return;if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);let m,c;if(Array.isArray(o)){for(c="[",m=0;m<o.length;m++)m&&(c+=","),c+=n(o[m])||"null";return c+"]"}if(o===null)return"null";if(i.includes(o)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}const S=i.push(o)-1,_=Object.keys(o).sort(a?.(o));for(c="",m=0;m<_.length;m++){const he=_[m],de=n(o[he]);de&&(c&&(c+=","),c+=JSON.stringify(he)+":"+de)}return i.splice(S,1),"{"+c+"}"})(e)}function ut(e){if(e===null)return null;const t=[];for(const r of e)P(r)?t.push(r.geometry()):t.push(r);return t}function v(e,t){if(!(t instanceof D))throw new Z(null,"InvalidParameter",null);e.push(t.hasZ?t.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])}function ot(e,t){if(N(e)||T(e)){let r=!1,a=!1,s=[],i=t;if(N(e)){for(const n of e)v(s,n);s.length>0&&(i=e[0].spatialReference,r=e[0].hasZ,a=e[0].hasM)}else if(e instanceof R)s=e._elements,s.length>0&&(r=e._hasZ,a=e._hasM,i=e.get(0).spatialReference);else{if(!T(e))throw new Z(null,"InvalidParameter",null);for(const n of e.toArray())v(s,n);s.length>0&&(i=e.get(0).spatialReference,r=e.get(0).hasZ===!0,a=e.get(0).hasM===!0)}return s.length===0?null:(Le(s)||(s=s.slice().reverse()),new ee({rings:[s],spatialReference:i,hasZ:r,hasM:a}))}return e}function lt(e,t){if(N(e)||T(e)){let r=!1,a=!1,s=[],i=t;if(N(e)){for(const n of e)v(s,n);s.length>0&&(i=e[0].spatialReference,r=e[0].hasZ===!0,a=e[0].hasM===!0)}else if(e instanceof R)s=e._elements,s.length>0&&(r=e._hasZ,a=e._hasM,i=e.get(0).spatialReference);else if(T(e)){for(const n of e.toArray())v(s,n);s.length>0&&(i=e.get(0).spatialReference,r=e.get(0).hasZ===!0,a=e.get(0).hasM===!0)}return s.length===0?null:new X({paths:[s],spatialReference:i,hasZ:r,hasM:a})}return e}function ct(e,t){if(N(e)||T(e)){let r=!1,a=!1,s=[],i=t;if(N(e)){for(const n of e)v(s,n);s.length>0&&(i=e[0].spatialReference,r=e[0].hasZ===!0,a=e[0].hasM===!0)}else if(e instanceof R)s=e._elements,s.length>0&&(r=e._hasZ,a=e._hasM,i=e.get(0).spatialReference);else if(T(e)){for(const n of e.toArray())v(s,n);s.length>0&&(i=e.get(0).spatialReference,r=e.get(0).hasZ===!0,a=e.get(0).hasM===!0)}return s.length===0?null:new $({points:s,spatialReference:i,hasZ:r,hasM:a})}return e}function ft(e,t=!0){if(e==null)return[];if(N(e)){const r=[];for(const a of e){const s=w(a);(t||s!=="")&&r.push(s)}return r}if(T(e)){const r=[];for(let a=0;a<e.length();a++){const s=w(e.get(a));(t||s!=="")&&r.push(s)}return r}if(O(e)){const r=w(e);if(t||r!=="")return[r]}return[]}let H=0;function ht(e){return H++,H%100==0?(H=0,new Promise(t=>{setTimeout(()=>{t(e)},0)})):e}function dt(e,t,r){switch(r){case"&":return e&t;case"|":return e|t;case"^":return e^t;case"<<":return e<<t;case">>":return e>>t;case">>>":return e>>>t}}function F(e,t=null){return e==null?null:p(e)||b(e)||y(e)?e:e instanceof k?t?.keepGeometryType===!0?e:e.toJSON():e instanceof C?e.toArray().map(r=>F(r,t)):Array.isArray(e)?e.map(r=>F(r,t)):L(e)?e:l(e)?e.toJSDate():d(e)?e.toString():h(e)?e.toJSDate():e!==null&&typeof e=="object"&&e.castAsJson!==void 0?e.castAsJson(t):null}async function mt(e,t,r,a,s){const i=await fe(e,t,r);s[a]=i}async function fe(e,t=null,r=null){if(e instanceof C&&(e=e.toArray()),e==null)return null;if(O(e)||e instanceof k||L(e)||l(e))return F(e,r);if(Array.isArray(e)){const a=[],s=[];for(const i of e)i===null||O(i)||i instanceof k||L(i)||l(i)?s.push(F(i,r)):(s.push(null),a.push(mt(i,t,r,s.length-1,s)));return a.length>0&&await Promise.all(a),s}return e!==null&&typeof e=="object"&&e.castAsJsonAsync!==void 0?e.castAsJsonAsync(t,r):null}function j(e){return ke(e)?e.parent:e}function ke(e){return e&&"declaredClass"in e&&e.declaredClass==="esri.layers.support.SubtypeSublayer"}function yt(e){return e&&"declaredClass"in e&&e.declaredClass==="esri.layers.SubtypeGroupLayer"}function pt(e,t,r){const a=j(e.fullSchema());return a===null||!a.fields?null:E(t,a,e,r)}function bt(e){const t=j(e.fullSchema());return t===null?null:t.fields?t.subtypeField?{subtypeField:t.subtypeField,subtypes:t.subtypes?t.subtypes.map(r=>({name:r.name,code:r.code})):[]}:t.typeIdField?{subtypeField:t.typeIdField,subtypes:t.types?t.types.map(r=>({name:r.name,code:r.id})):[]}:null:null}function gt(e,t,r,a){const s=j(e.fullSchema());if(s===null||!s.fields)return null;const i=E(t,s,e,a);if(r===void 0)try{r=e.field(t)}catch{return null}return we(i,r)}function St(e,t,r,a){const s=j(e.fullSchema());if(s===null||!s.fields)return null;if(r===void 0){try{r=e.field(t)}catch{return null}return r}return Ce(E(t,s,e,a),r)}function Nt(e){return e?.timeZone??"system"}function Zt(e){const t=j(e.fullSchema());if(t===null||!t.fields)return null;const r=[];for(const a of t.fields)r.push(Re(a));return{objectIdField:t.objectIdField,globalIdField:t.globalIdField??"",geometryType:me[t.geometryType]===void 0?"":me[t.geometryType],fields:r}}function Tt(e,t){const r=x.systemTimeZoneCanonicalName;return e==="system"&&(e=r),{version:Ae,engineVersion:Me,timeZone:e,userTimeZone:r,spatialReference:t instanceof Ie?t.toJSON():t,application:Je.applicationName??"",engine:"web",locale:ge()}}const Ae="1.34",jt=Object.freeze(Object.defineProperty({__proto__:null,ImplicitResult:qe,ReturnResult:Ve,absRound:Xe,arcadeVersion:Ae,autoCastArrayOfPointsToMultiPoint:ct,autoCastArrayOfPointsToPolygon:ot,autoCastArrayOfPointsToPolyline:lt,autoCastFeatureToGeometry:ut,binaryOperator:dt,breakResult:Ee,castAsJson:F,castAsJsonAsync:fe,castRecordToText:_e,continueResult:He,defaultExecutingContext:Tt,defaultTimeZone:Nt,defaultUndefined:Ue,equalityTest:Te,featureDomainCodeLookup:St,featureDomainValueLookup:gt,featureFullDomain:pt,featureSchema:Zt,featureSubtypes:bt,fixNullGeometry:nt,fixSpatialReference:it,formatDate:q,formatNumber:ce,getDomain:E,getDomainCode:Ce,getDomainValue:we,getType:We,greaterThanLessThan:$e,isArray:N,isBoolean:p,isDate:l,isDateOnly:h,isDictionary:ue,isDictionaryLike:Be,isEmpty:Qe,isFeature:P,isFeatureSet:ne,isFeatureSetCollection:oe,isFunctionParameter:J,isGeometry:V,isGraphic:Ge,isImmutableArray:T,isInteger:ze,isJsDate:L,isKnowledgeGraph:le,isModule:se,isNumber:b,isObject:W,isPixel:ie,isSimpleType:O,isString:y,isSubtypeGrouplayer:yt,isSubtypeSublayer:ke,isTime:d,isVoid:Ne,isVoxel:ae,multiReplace:I,parseGeometryFromJson:at,pcCheck:Ke,stableStringify:B,standardiseDateFormat:Ze,tick:ht,toBoolean:st,toDate:tt,toNumber:f,toNumberArray:et,toString:w,toStringArray:ft,toStringExplicit:Y,voidOperation:g},Symbol.toStringTag,{value:"Module"}));function Lt(e){xe=e}let xe;function K(e){return e===null?null:l(e)?e.clone():O(e)?e:V(e)?e.clone():T(e)?e.toArray().map(t=>K(t)):N(e)?e.map(t=>K(t)):P(e)?xe.createFromArcadeFeature(e):oe(e)||ne(e)?e:ue(e)||e?.declaredClass==="esri.arcade.Attachment"?e.deepClone():(e?.declaredClass==="esri.arcade.Portal"||le(e)||e instanceof te||J(e),e)}function G(e,t,r=!1,a=!1){if(e==null)return null;if(b(e)||p(e)||y(e)||l(e)||h(e)||d(e))return e;if(N(e)){const i=[];for(const n of e)i.push(G(n,t,r,a));return i}if(a&&V(e))return e;const s=new A;s.immutable=!1;for(const[i,n]of Object.entries(e))n!==void 0&&s.setField(i,G(n,t,r,a));return s.immutable=r,s}class A{constructor(t){this.declaredClass="esri.arcade.Dictionary",this.plain=!1,this.immutable=!0,t instanceof A?this.attributes=t.attributes:t==null?this.attributes=Object.create(null):Object.getPrototypeOf(t)!=null?this.attributes={__proto__:null,...t}:this.attributes=t}static containerEntry(t,r){return new A({__proto__:null,key:t,value:r})}static textFormatting(){const t=new A({__proto__:null,newline:`
`,tab:"	",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});return t.immutable=!1,t}field(t){const r=t.toLowerCase(),a=this.attributes[t];if(a!==void 0)return a;for(const s in this.attributes)if(s.toLowerCase()===r)return this.attributes[s];throw new Z(null,"FieldNotFound",null,{key:t})}setField(t,r){if(this.immutable)throw new Z(null,"Immutable",null);if(J(r))throw new Z(null,"NoFunctionInDictionary",null);const a=t.toLowerCase();if(r instanceof Date&&(r=x.dateJSToArcadeDate(r)),this.attributes[t]===void 0){for(const s in this.attributes)if(s.toLowerCase()===a)return void(this.attributes[s]=r);this.attributes[t]=r}else this.attributes[t]=r}eraseField(t){if(this.immutable)throw new Z(null,"Immutable",null);if(t in this.attributes)return void delete this.attributes[t];const r=t.toLowerCase();for(const a in this.attributes)if(a.toLowerCase()===r)return void delete this.attributes[a]}hasField(t){const r=t.toLowerCase();if(this.attributes[t]!==void 0)return!0;for(const a in this.attributes)if(a.toLowerCase()===r)return!0;return!1}keys(){let t=[];for(const r in this.attributes)t.push(r);return t=t.sort(),t}values(){return this.keys().map(t=>this.attributes[t])}entryCount(){return Object.keys(this.attributes).length}isEmpty(){return this.entryCount()<=0}castToText(t=!1){return _e(this.attributes,{useNumbersForDates:t})}static convertObjectToArcadeDictionary(t,r,a=!0,s=!1){const i=new A;i.immutable=!1;for(const n in t){const o=t[n];o!==void 0&&i.setField(n.toString(),G(o,r,a,s))}return i.immutable=a,i}static convertJsonToArcade(t,r,a=!1,s=!1){return G(t,r,a,s)}castAsJson(t=null){const r=Object.create(null);for(let a in this.attributes){const s=this.attributes[a];s!==void 0&&(t?.keyTranslate&&(a=t.keyTranslate(a)),r[a]=F(s,t))}return r}async castDictionaryValueAsJsonAsync(t,r,a,s=null,i){const n=await fe(a,s,i);return t[r]=n,n}async castAsJsonAsync(t=null,r=null){const a=Object.create(null),s=[];for(let i in this.attributes){const n=this.attributes[i];r?.keyTranslate&&(i=r.keyTranslate(i)),n!==void 0&&(O(n)||n instanceof k||n instanceof x?a[i]=F(n,r):s.push(this.castDictionaryValueAsJsonAsync(a,i,n,t,r)))}return s.length>0&&await Promise.all(s),a}deepClone(){const t=new A;t.immutable=!1;for(const r of this.keys())t.setField(r,K(this.field(r)));return t}}export{V as $,A,Be as B,bt as C,it as D,Ee as E,nt as F,ut as G,He as H,I,ae as J,Ke as K,P as L,J as M,St as N,ie as O,R as P,Qe as Q,M as R,gt as S,Te as T,Ue as U,qe as V,We as W,Xe as X,jt as Y,Ne as Z,_e as _,w as a,ot as a0,lt as a1,ct as a2,et as a3,te as a4,K as a5,F as a6,Lt as a7,ft as a8,ht as a9,ke as aa,E as ab,we as ac,Ce as ad,le as ae,f as b,l as c,dt as d,pe as e,U as f,g,re as h,Nt as i,Pt as j,h as k,oe as l,d as m,$e as n,ue as o,tt as p,Ve as q,Ze as r,st as s,Tt as t,ne as u,O as v,T as w,Y as x,pt as y,Zt as z};
