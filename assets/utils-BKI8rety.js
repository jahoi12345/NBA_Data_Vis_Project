const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-C8ioMIWe.js","assets/index-DJqVgRZI.js","assets/Point-C1MrKtFQ.js","assets/jsonMap-Bs3hmeCU.js","assets/reader-DcGs6kKN.js","assets/LRUCache-fy84PBMi.js","assets/collectionUtils-0LMOubEE.js","assets/reactiveUtils-SO2Ko3sy.js","assets/Extent-BhRcB6A3.js","assets/SimpleObservable-CvFyr0NA.js","assets/aaBoundingBox-CB-h8mLX.js","assets/aaBoundingRect-CirBGiM6.js","assets/mathUtils-PIGhLnI9.js","assets/DoubleArray-DExKNiTh.js","assets/mat4f64-q_b6UJoq.js","assets/PolygonSymbol3D-akL4YFUA.js","assets/Color-CERqXxxY.js","assets/ExtrudeSymbol3DLayer-DSc1ou2x.js","assets/screenUtils-BitdhK1O.js","assets/opacityUtils-DuFH0EC9.js","assets/lineMarkers-CDwLe3J6.js","assets/Font-yLAApryG.js"])))=>i.map(i=>d[i]);
import{_ as b}from"./index-DJqVgRZI.js";import{u as s}from"./Color-CERqXxxY.js";import{a as w}from"./asyncUtils-w6KfWU41.js";import"./jsonMap-Bs3hmeCU.js";import{_ as k}from"./collectionUtils-0LMOubEE.js";import"./mat4f32-Djp3mnm5.js";import"./mat4-1jyq5T0I.js";import{S as g,u as L}from"./cimSymbolUtils-DOGwV0lV.js";import"./Point-C1MrKtFQ.js";import{e as v}from"./LRUCache-fy84PBMi.js";import{p as z}from"./ExtrudeSymbol3DLayer-DSc1ou2x.js";import{S as m,k as y}from"./typeUtils-B67GwOn_.js";new v(1e3);new s([128,128,128]);function H(r){if(r==null||!("symbolLayers"in r)||r.symbolLayers==null)return!1;switch(r.type){case"point-3d":return r.symbolLayers.some(o=>o.type==="object");case"line-3d":return r.symbolLayers.some(o=>o.type==="path");case"polygon-3d":return r.symbolLayers.some(o=>o.type==="object"||o.type==="extrude");default:return!1}}function K(r){return r.resource?.href??""}function Q(r,o){if(!r)return null;let n=null;return m(r)?n=S(r):y(r)&&(n=r.type==="cim"?L(r):r.color?new s(r.color):null),n?u(n,o):null}function S(r){const o=r.symbolLayers;if(!o)return null;let n=null;return o.forEach(t=>{t.type==="object"&&t.resource?.href||(n=t.type==="water"?t.color:t.material?t.material.color:null)}),n?new s(n):null}function u(r,o){if(o==null||r==null)return r;const n=r.toRgba();return n[3]=n[3]*o,new s(n)}function _(r,o,n){const t=r.symbolLayers;if(!t)return;const e=(l,c=!1)=>{let i=o??l??null;return n?.override!=null&&(!i&&c&&(i=new s([255,255,255])),i&&(i.a=n.override)),u(i,n?.add)};t.forEach(l=>{if(l.type==="water")return void(l.color=u(l.color,n?.add));const c=l.material!=null?l.material.color:null,i=e(c,l.type==="icon"&&l.resource?.href!=null);l.material==null?l.material=new z({color:i}):l.material.color=i,"outline"in l&&l.outline?.color&&n?.add!=null&&(l.outline.color=u(l.outline.color,n.add)),"marker"in l&&l.marker!=null&&(l.marker.color=e(l.marker.color))})}function x(r,o,n){o=o??r.color,n?.override!=null&&o&&(o.a=n.override),o&&(r.color=u(o,n?.add)),"outline"in r&&r.outline?.color&&(r.outline.color=u(r.outline.color,n?.add))}function W(r,o,n){r&&(o||n!=null)&&(o&&(o=new s(o)),m(r)?_(r,o,n):y(r)&&x(r,o,n))}async function j(r,o){const n=r.symbolLayers;n&&await w(n,async t=>E(t,o))}async function E(r,o){switch(r.type){case"extrude":R(r,o);break;case"icon":case"line":case"text":$(r,o);break;case"path":A(r,o);break;case"object":await O(r,o)}}function $(r,o){const n=d(o);n!=null&&(r.size=n)}function d(r){for(const o of r)if(typeof o=="number")return o;return null}function R(r,o){const n=o[2];typeof n=="number"&&(r.size=n)}async function O(r,o){const{resourceSize:n,symbolSize:t}=await D(r),e=h(o,n,t);e!=null&&(r.width=f(o[0],t[0],n[0],e),r.depth=f(o[1],t[1],n[1],e),r.height=f(o[2],t[2],n[2],e))}function A(r,o){const n=h(o,k,[r.width,void 0,r.height]);n!=null&&(r.width=f(o[0],r.width,1,n),r.height=f(o[2],r.height,1,n))}function h(r,o,n){for(let t=0;t<3;t++){const e=r[t];switch(e){case"symbol-value":{const l=n[t];return l!=null?l/o[t]:1}case"proportional":break;default:if(e&&o[t])return e/o[t]}}return null}async function D(r){const{computeObjectLayerResourceSize:o}=await b(()=>import("./symbolLayerUtils-C8ioMIWe.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])),n=await o(r,10),{width:t,height:e,depth:l}=r,c=[t,l,e];let i=1;for(let a=0;a<3;a++){const p=c[a];if(p!=null){i=p/n[a];break}}for(let a=0;a<3;a++)c[a]==null&&(c[a]=n[a]*i);return{resourceSize:n,symbolSize:c}}function f(r,o,n,t){switch(r){case"proportional":return n*t;case"symbol-value":return o??n;default:return r}}function P(r,o){const n=d(o);if(n!=null)switch(r.type){case"simple-marker":r.size=n;break;case"picture-marker":{const t=r.width/r.height;t>1?(r.width=n,r.height=n*t):(r.width=n*t,r.height=n);break}case"simple-line":r.width=n;break;case"text":r.font.size=n}}async function X(r,o){if(r&&o)return m(r)?j(r,o):void(y(r)&&P(r,o))}function Y(r,o,n){if(r&&o!=null){if(m(r)){const t=r.symbolLayers;t&&t.forEach(e=>{if(e.type==="object")switch(n){case"tilt":e.tilt=(e.tilt??0)+o;break;case"roll":e.roll=(e.roll??0)+o;break;default:e.heading=(e.heading??0)+o}e.type==="icon"&&(e.angle+=o)})}else if(y(r))switch(r.type){case"simple-marker":case"picture-marker":case"text":r.angle+=o;break;case"cim":g(r,o,!0)}}}function Z(r){return r!=null&&r.type==="polygon-3d"&&r.symbolLayers.some(o=>o.type==="extrude")}export{Z as A,W as L,X as M,Y as N,Q as b,K as d,H as h};
