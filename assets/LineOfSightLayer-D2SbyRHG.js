import{ak as O,a8 as $,_ as e,m as r,a as h}from"./jsonMap-Bs3hmeCU.js";import{c as R}from"./Analysis-dsHcsRtt.js";import{l as d,u as f}from"./LineOfSightAnalysisTarget-B2s7CNS4.js";import{O as y,c as g,e as L}from"./collectionUtils-0LMOubEE.js";import{l as c,w as v}from"./reactiveUtils-SO2Ko3sy.js";import{X as _}from"./projectionUtils-DgeaYumr.js";import{a as j,l as z,c as E}from"./aaBoundingBox-CB-h8mLX.js";import{s as q}from"./elevationInfoUtils-M7_FbiD_.js";import{l as A}from"./MultiOriginJSONSupport-Bd1TKmh_.js";import{b as S}from"./Layer-46hEBHG3.js";import{b as T}from"./OperationalLayer-Dx_J9Xsw.js";import"./featureReferenceUtils-D93wCTfW.js";import"./vec32-CBRzfVYF.js";import"./Polygon-Bn-bHOAm.js";import"./Extent-BhRcB6A3.js";import"./Point-C1MrKtFQ.js";import"./reader-DcGs6kKN.js";import"./index-DJqVgRZI.js";import"./aaBoundingRect-CirBGiM6.js";import"./mathUtils-PIGhLnI9.js";import"./sphere-CJMW5PSr.js";import"./mat4-1jyq5T0I.js";import"./vec4f64-DPb6J-GU.js";import"./vector-CX91PKdq.js";import"./mat4f64-q_b6UJoq.js";import"./quatf64-CCm9z-pX.js";import"./vec2f64-rIxtbMRN.js";import"./intersectorUtilsConversions-Y7Dpl_XP.js";import"./HUDIntersectorResult-OkFBtp3p.js";import"./vec42-DwKDwCwf.js";import"./Intersector-DEIzqEVE.js";import"./persistable-DiACDhNQ.js";import"./MD5-MtSiOt06.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./uuid-Oe6SV2kF.js";import"./resourceExtension-BoaXkp7k.js";import"./ElevationInfo-tmoMRTCD.js";import"./lengthUtils-S7Vd15KB.js";import"./date-IqUzANpt.js";import"./unitConversionUtils-hUSVOd8x.js";import"./SimpleObservable-CvFyr0NA.js";import"./Polyline-BX3kGhk1.js";import"./DoubleArray-DExKNiTh.js";import"./layerContainerType-CSXZNpHb.js";import"./opacityUtils-DuFH0EC9.js";const u=y.ofType(d);let o=class extends R{constructor(t){super(t),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles(c(()=>this._computeExtent(),t=>{t?.pending==null&&this._set("extent",t!=null?t.extent:null)},v))}get targets(){return this._get("targets")||new u}set targets(t){this._set("targets",g(t,this.targets,u))}get spatialReference(){return this.observer?.position!=null?this.observer.position.spatialReference:null}get valid(){return this.observer?.position!=null}async waitComputeExtent(){const t=this._computeExtent();return t!=null?t.pending:Promise.resolve()}_computeExtent(){const t=this.spatialReference;if(this.observer?.position==null||t==null)return null;const i=l=>q(l.position,l.elevationInfo)==="absolute-height",n=this.observer.position,m=j(n.x,n.y,n.z,n.x,n.y,n.z);for(const l of this.targets)if(l.position!=null){const a=_(l.position,t);if(a.pending!=null)return{pending:a.pending,extent:null};if(a.geometry!=null){const{x:b,y:x,z:w}=a.geometry;z(m,[b,x,w])}}const p=E(m,t);return i(this.observer)&&this.targets.every(i)||(p.zmin=void 0,p.zmax=void 0),{pending:null,extent:p}}clear(){this.observer=null,this.targets.removeAll()}equals(t){return this===t||super.equals(t)&&O(this.observer,t.observer)&&$(this.targets.toArray(),t.targets.toArray(),(i,n)=>i.equals(n))}};e([r({type:["line-of-sight"]})],o.prototype,"type",void 0),e([r({type:f,json:{read:!0,write:!0}})],o.prototype,"observer",void 0),e([r({cast:L,type:u,nonNullable:!0,json:{read:!0,write:!0}})],o.prototype,"targets",null),e([r({value:null,readOnly:!0})],o.prototype,"extent",void 0),e([r()],o.prototype,"spatialReference",null),e([r({readOnly:!0})],o.prototype,"valid",null),o=e([h("esri.analysis.LineOfSightAnalysis")],o);const C=y.ofType(d);let s=class extends T(A(S)){constructor(t){super(t),this.type="line-of-sight",this.operationalLayerType="LineOfSightLayer",this.analysis=new o,this.opacity=1}initialize(){this.addHandles(c(()=>this.analysis,(t,i)=>{i!=null&&i.parent===this&&(i.parent=null),t!=null&&(t.parent=this)},v))}async load(){return this.analysis!=null&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return this.analysis?.observer}set observer(t){const{analysis:i}=this;i&&(i.observer=t)}get targets(){return this.analysis!=null?this.analysis.targets:new y}set targets(t){g(t,this.analysis?.targets)}get fullExtent(){return this.analysis!=null?this.analysis.extent:null}get spatialReference(){return this.analysis!=null?this.analysis.spatialReference:null}releaseAnalysis(t){this.analysis===t&&(this.analysis=new o)}};e([r({json:{read:!1},readOnly:!0})],s.prototype,"type",void 0),e([r({type:["LineOfSightLayer"]})],s.prototype,"operationalLayerType",void 0),e([r({type:f,json:{read:!0,write:{isRequired:!0,ignoreOrigin:!0}}})],s.prototype,"observer",null),e([r({type:C,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],s.prototype,"targets",null),e([r({type:o,nonNullable:!0,json:{read:!1,write:!1}})],s.prototype,"analysis",void 0),e([r({readOnly:!0})],s.prototype,"fullExtent",null),e([r({readOnly:!0})],s.prototype,"spatialReference",null),e([r({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],s.prototype,"opacity",void 0),e([r({type:["show","hide"]})],s.prototype,"listMode",void 0),s=e([h("esri.layers.LineOfSightLayer")],s);const _t=s;export{_t as default};
