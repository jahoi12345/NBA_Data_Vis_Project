const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/unitConversion-B6wBWHb7.js","assets/enum-BzLwmiID.js","assets/jsonMap-Bs3hmeCU.js","assets/Point-fJINO2ru.js","assets/reader-DcGs6kKN.js","assets/index-ClordG0R.js","assets/index-uyDEb95I.css"])))=>i.map(i=>d[i]);
import{_ as X}from"./index-ClordG0R.js";import{e as g,D as F,h as Y,z as B,O as $,I as nn,R as tn,k as en,t as M}from"./arcade-C5PBCL45.js";import{J as d,l as q,o as m,w as Z,m as k,g as H,t as O,E as T,B as R,F as C,U,M as _,N as E,S as P,T as rn,z as b,p as x,c as D}from"./Dictionary-Dm6u5JoR.js";import{n as o}from"./enum-BzLwmiID.js";import{o as v}from"./TimeOnly-CHGkqUPg.js";import{l as V}from"./portalUtils-7_P_NEq7.js";import{a as s}from"./operatorsWorkerConnection-FTYyrsEZ.js";import{a8 as an}from"./jsonMap-Bs3hmeCU.js";import{z as L}from"./Extent-B4u1bcyL.js";import{a as on,H as K,c as w,b as A}from"./Point-fJINO2ru.js";import{y as j,m as W}from"./Polyline-33xu-nCu.js";import{P as I}from"./Polygon-Brg2ZzgS.js";import{f as p}from"./jsonUtils-D5pkeZVw.js";import{M as G}from"./collectionUtils-DO-P7c3V.js";import{u as J}from"./lengthUtils-BPaBCXl4.js";import"./arcadeEnvironment-DqZGrNFy.js";import"./Feature-DjXvblsx.js";import"./featureConversionUtils-CxwZ5qAf.js";import"./aaBoundingBox-DYUg4mSl.js";import"./aaBoundingRect-5dP796IU.js";import"./mathUtils-PIGhLnI9.js";import"./DoubleArray-DExKNiTh.js";import"./mat4f64-q_b6UJoq.js";import"./OptimizedFeature-CwRGZPwv.js";import"./memoryEstimations-Bd726a_p.js";import"./OptimizedFeatureSet-BR8EEvDc.js";import"./createFeatureId-CVwTD0fV.js";import"./FieldsIndex-2QbNHvFQ.js";import"./UnknownTimeZone-B697BDFv.js";import"./date-IqUzANpt.js";import"./reactiveUtils-SO2Ko3sy.js";import"./timeZoneUtils-BSc7-7qA.js";import"./aiServices-C4HMFXM1.js";import"./commonProperties-DHiB1uzW.js";import"./utils-BqP_yUzV.js";import"./ImmutableArray-BPVd6ESQ.js";import"./shared-rXrHx8vy.js";import"./Field-Cm_ZejYW.js";import"./Color-CERqXxxY.js";import"./reader-DcGs6kKN.js";import"./fieldType-DVUzXtk_.js";import"./WhereClause-DtSdvExf.js";import"./streamLayerUtils-DFlbJ4P1.js";import"./unitConversion-B6wBWHb7.js";import"./number-D_FvV3D1.js";import"./hash-CcEbRgUF.js";import"./uuid-Oe6SV2kF.js";import"./workers-BJnRHBT_.js";import"./Queue-CYlrXMwB.js";import"./SimpleObservable-CvFyr0NA.js";import"./intl-CUaZHILl.js";async function Q(a,t,e){if(!on?.findCredential(a.restUrl))return null;if(a.loadStatus==="loaded"&&t===""&&a.user?.sourceJSON&&e===!1)return a.user.sourceJSON;const c={responseType:"json",query:{f:"json"}};if(e&&(c.query.returnUserLicenseTypeExtensions=!0),t===""){const r=await K(a.restUrl+"/community/self",c);if(r.data){const i=r.data;if(i?.username)return i}return null}const n=await K(a.restUrl+"/community/users/"+t,c);if(n.data){const r=n.data;return r.error?null:r}return null}function y(a){if(a==null)return a;switch(typeof a){case"string":case"number":return a;default:throw new o(null,"InvalidParameter",null)}}function at(a){a.mode==="async"&&(a.functions.disjoint=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>(n=d(n),g(n,t,e),n[0]===null||n[1]===null||s("disjoint",[n[0].toJSON(),n[1].toJSON()])))},a.functions.intersects=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>(n=d(n),g(n,t,e),n[0]!==null&&n[1]!==null&&s("intersects",[n[0].toJSON(),n[1].toJSON()])))},a.functions.touches=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>(n=d(n),g(n,t,e),n[0]!==null&&n[1]!==null&&s("touches",[n[0].toJSON(),n[1].toJSON()])))},a.functions.crosses=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>(n=d(n),g(n,t,e),n[0]!==null&&n[1]!==null&&s("crosses",[n[0].toJSON(),n[1].toJSON()])))},a.functions.within=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>(n=d(n),g(n,t,e),n[0]!==null&&n[1]!==null&&s("within",[n[0].toJSON(),n[1].toJSON()])))},a.functions.contains=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>(n=d(n),g(n,t,e),n[0]!==null&&n[1]!==null&&s("contains",[n[0].toJSON(),n[1].toJSON()])))},a.functions.overlaps=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>(n=d(n),g(n,t,e),n[0]!==null&&n[1]!==null&&s("overlaps",[n[0].toJSON(),n[1].toJSON()])))},a.functions.equals=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>(m(n,2,2,t,e),n[0]===n[1]||(n[0]instanceof w&&n[1]instanceof w?s("equals",[n[0].toJSON(),n[1].toJSON()]):(q(n[0])&&q(n[1])||!!(Z(n[0])&&Z(n[1])||k(n[0])&&k(n[1])))&&n[0].equals(n[1]))))},a.functions.relate=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>{if(n=d(n),m(n,3,3,t,e),n[0]instanceof w&&n[1]instanceof w)return s("relate",[n[0].toJSON(),n[1].toJSON(),H(n[2])]);if(n[0]instanceof w&&n[1]===null||n[1]instanceof w&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new o(t,"InvalidParameter",e)})},a.functions.intersection=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>(n=d(n),g(n,t,e),n[0]===null||n[1]===null?null:p(await s("intersection",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.union=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if((n=d(n)).length===0)throw new o(t,"WrongNumberOfParameters",e);const r=[];if(n.length===1)if(J(n[0])){for(const i of d(n[0]))if(i!==null){if(!(i instanceof w))throw new o(t,"InvalidParameter",e);r.push(i.toJSON())}}else{if(!O(n[0])){if(n[0]instanceof w)return T(v(n[0]),t.spatialReference);if(n[0]===null)return null;throw new o(t,"InvalidParameter",e)}for(const i of d(n[0].toArray()))if(i!==null){if(!(i instanceof w))throw new o(t,"InvalidParameter",e);r.push(i.toJSON())}}else for(const i of n)if(i!==null){if(!(i instanceof w))throw new o(t,"InvalidParameter",e);r.push(i.toJSON())}return r.length===0?null:p(await s("union",[r]))})},a.functions.difference=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>(n=d(n),g(n,t,e),n[0]===null?null:n[1]===null?v(n[0]):p(await s("difference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.symmetricdifference=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>(n=d(n),g(n,t,e),n[0]===null&&n[1]===null?null:n[0]===null?v(n[1]):n[1]===null?v(n[0]):p(await s("symmetricDifference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.clip=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,2,2,t,e),!(n[1]instanceof L)&&n[1]!==null)throw new o(t,"InvalidParameter",e);if(n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return n[1]===null?null:p(await s("clip",[n[0].toJSON(),n[1].toJSON()]))})},a.functions.cut=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,2,2,t,e),!(n[1]instanceof j)&&n[1]!==null)throw new o(t,"InvalidParameter",e);if(n[0]===null)return[];if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return n[1]===null?[v(n[0])]:(await s("cut",[n[0].toJSON(),n[1].toJSON()])).map(r=>p(r))})},a.functions.area=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(m(n,1,2,t,e),n=d(n),R(n[0])){const i=await n[0].sumArea(y(n[1]),null,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,"Cancelled",e);return i}let r=n[0];if((J(r)||O(r))&&(r=C(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,"InvalidParameter",e);return s("area",[r.toJSON(),y(n[1])])})},a.functions.areageodetic=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{m(n,1,3,t,e);let r=(n=d(n))[0];(J(r)||O(r))&&(r=C(r,t.spatialReference));const i=y(n[1]),u=F(n[2]);if(R(r)){const l=await r.sumArea(i,u,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,"Cancelled",e);return l}if(r==null)return 0;if(!U(r))throw new o(t,"InvalidParameter",e);return s("geodeticArea",[r.toJSON(),i,u])})},a.functions.length=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(m(n,1,2,t,e),n=d(n),R(n[0])){const i=await n[0].sumLength(y(n[1]),null,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,"Cancelled",e);return i}let r=n[0];if((J(n[0])||O(n[0]))&&(r=_(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,"InvalidParameter",e);return s("length",[r.toJSON(),y(n[1])])})},a.functions.length3d=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(m(n,1,2,t,e),(n=d(n))[0]===null)return 0;let r=n[0];if((J(n[0])||O(n[0]))&&(r=_(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,"InvalidParameter",e);if(r.hasZ===!0){const{convertFromSpatialReferenceUnit:i,toLengthUnit:u}=await X(()=>import("./unitConversion-B6wBWHb7.js"),__vite__mapDeps([0,1,2,3,4,5,6])),l=Y(r);return i(r.spatialReference,u(n[1]),l)}return s("length",[r.toJSON(),y(n[1])])})},a.functions.lengthgeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{m(n,1,3,t,e);let r=(n=d(n))[0];(J(n[0])||O(n[0]))&&(r=_(n[0],t.spatialReference));const i=y(n[1]),u=F(n[2]);if(R(r)){const l=await r.sumLength(i,u,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,"Cancelled",e);return l}if(r===null)return 0;if(!U(r))throw new o(t,"InvalidParameter",e);return s("geodeticLength",[r.toJSON(),i,u])})},a.functions.distance=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{n=d(n),m(n,2,3,t,e);let r=n[0];if((J(n[0])||O(n[0]))&&(r=E(n[0],t.spatialReference)),!(r instanceof w))throw new o(t,"InvalidParameter",e);let i=n[1];if((J(n[1])||O(n[1]))&&(i=E(n[1],t.spatialReference)),!(i instanceof w))throw new o(t,"InvalidParameter",e);return s("distance",[r.toJSON(),i.toJSON(),y(n[2])])})},a.functions.distancegeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{n=d(n),m(n,2,4,t,e);const r=n[0];if(!(r instanceof A))throw new o(t,"InvalidParameter",e);const i=n[1];if(!(i instanceof A))throw new o(t,"InvalidParameter",e);const u=new j({paths:[],spatialReference:r.spatialReference});return u.addPath([r,i]),s("geodeticLength",[u.toJSON(),y(n[2]),F(n[3])])})},a.functions.densify=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);const r=P(n[1]);if(isNaN(r))throw new o(t,"InvalidParameter",e);if(r<=0)throw new o(t,"InvalidParameter",e);switch(n[0].type){case"polygon":case"polyline":case"extent":return p(await s("densify",[n[0].toJSON(),r,y(n[2])]));default:return n[0]}})},a.functions.densifygeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{n=d(n),m(n,2,4,t,e);const r=n[0];if(r==null)return null;if(!U(r))throw new o(t,"InvalidParameter",e);const i=P(n[1]);if(isNaN(i))throw new o(t,"InvalidParameter",e);if(i<=0)throw new o(t,"InvalidParameter",e);const u=y(n[2]),l=F(n[3]);switch(r.type){case"polygon":case"polyline":case"extent":return p(await s("geodeticDensify",[r.toJSON(),i,u,l]));default:return r}})},a.functions.generalize=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,2,4,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);const r=P(n[1]);if(isNaN(r))throw new o(t,"InvalidParameter",e);const i=rn(b(n[2],!0));return p(await s("generalize",[n[0].toJSON(),r,y(n[3]),{removeDegenerateParts:i}]))})},a.functions.buffer=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);const r=P(n[1]);if(isNaN(r))throw new o(t,"InvalidParameter",e);return r===0?v(n[0]):p(await s("buffer",[n[0].toJSON(),r,y(n[2])]))})},a.functions.buffergeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{n=d(n),m(n,2,4,t,e);const r=n[0];if(r==null)return null;if(!U(r))throw new o(t,"InvalidParameter",e);const i=P(n[1]);if(isNaN(i))throw new o(t,"InvalidParameter",e);if(i===0)return v(r);const u=y(n[2]),l=F(n[3]);return p(await s("geodesicBuffer",[r.toJSON(),i,u,l]))})},a.functions.offset=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{n=d(n),m(n,2,6,t,e);const r=n[0];if(r===null)return null;if(!(r instanceof I||r instanceof j))throw new o(t,"InvalidParameter",e);const i=P(n[1]);if(isNaN(i))throw new o(t,"InvalidParameter",e);const u=n[2],l=B(n[3]),h=P(b(n[4],10));if(isNaN(h))throw new o(t,"InvalidParameter",e);const S=P(b(n[5],0));if(isNaN(S))throw new o(t,"InvalidParameter",e);return p(await s("offset",[r.toJSON(),i,y(u),l,h,S]))})},a.functions.rotate=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);const r=n[0]instanceof L?I.fromExtent(n[0]):n[0],i=P(n[1]);if(isNaN(i))throw new o(t,"InvalidParameter",e);const u=b(n[2],null);if(u===null){const l=r.type==="point"?r:r.extent?.center;return p(await s("rotate",[r.toJSON(),i,l?.x,l?.y]))}if(u instanceof A)return p(await s("rotate",[r.toJSON(),i,u.x,u.y]));throw new o(t,"InvalidParameter",e)})},a.functions.centroid=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,1,2,t,e),n[0]===null)return null;const r=$(n[1]);let i=n[0];if((J(n[0])||O(n[0]))&&(i=r==="geometric"?E(n[0],t.spatialReference):C(n[0],t.spatialReference),i===null))return null;if(!(i instanceof w))throw new o(t,"InvalidParameter",e);return p(r==="geometric"?await s("centroid",[i.toJSON()]):await s("labelPoint",[i.toJSON()]))})},a.functions.measuretocoordinate=function(t,e){return a.standardFunctionAsync(t,e,nn)},a.functions.pointtocoordinate=function(t,e){return a.standardFunctionAsync(t,e,tn)},a.functions.distancetocoordinate=function(t,e){return a.standardFunctionAsync(t,e,en)},a.functions.multiparttosinglepart=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,1,1,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);if(n[0]instanceof A)return[T(v(n[0]),t.spatialReference)];if(n[0]instanceof L)return[T(v(n[0]),t.spatialReference)];const r=p(await s("simplify",[n[0].toJSON()]));if(r instanceof I){const i=[],u=[];for(let l=0;l<r.rings.length;l++)if(r.isClockwise(r.rings[l])){const h=p({rings:[r.rings[l]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(h)}else u.push({ring:r.rings[l],pt:r.getPoint(l,0)});for(let l=0;l<u.length;l++)for(let h=0;h<i.length;h++)if(i[h].contains(u[l].pt)){i[h].addRing(u[l].ring);break}return i}if(r instanceof j){const i=[];for(let u=0;u<r.paths.length;u++){const l=p({paths:[r.paths[u]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(l)}return i}if(n[0]instanceof W){const i=[],u=T(v(n[0]),t.spatialReference);for(let l=0;l<u.points.length;l++)i.push(u.getPoint(l));return i}return null})},a.functions.isselfintersecting=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{m(n,1,1,f,c);let r=(n=d(n))[0];if((J(n[0])||O(n[0]))&&(r=_(n[0],f.spatialReference)),r instanceof W){const i=r.points;for(let u=0;u<i.length;u++)for(let l=u+1;l<i.length;l++)if(an(i[u],i[l]))return!0;return!1}return(r instanceof j||r instanceof I)&&await s("isSelfIntersecting",[r.toJSON()])})},a.functions.issimple=function(t,e){return a.standardFunctionAsync(t,e,(f,c,n)=>{if(n=d(n),m(n,1,1,t,e),n[0]===null)return!0;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return s("isSimple",[n[0].toJSON()])})},a.functions.simplify=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,1,1,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return p(await s("simplify",[n[0].toJSON()]))})},a.functions.convexhull=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,1,1,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return p(await s("convexHull",[n[0].toJSON()]))})},a.functions.getuser=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{m(n,0,2,t,e);let r=b(n[1],""),i=r===!0;if(r=r===!0||r===!1?"":H(r),n.length===0||n[0]instanceof M){let l;l=t.services?.portal?t.services.portal:G.getDefault(),n.length>0&&(l=V(n[0],l));const h=await Q(l,r,i);if(h){const S=JSON.parse(JSON.stringify(h));for(const N of["lastLogin","created","modified"])S[N]!==void 0&&S[N]!==null&&(S[N]=new Date(S[N]));return x.convertObjectToArcadeDictionary(S,D(t))}return null}let u=null;if(R(n[0])&&(u=n[0]),u){if(i=!1,r)return null;await u.load();const l=await u.getOwningSystemUrl();if(!l){if(!r){const N=await u.getIdentityUser();return N?x.convertObjectToArcadeDictionary({username:N},D(t)):null}return null}let h;h=t.services?.portal?t.services.portal:G.getDefault(),h=V(new M(l),h);const S=await Q(h,r,i);if(S){const N=JSON.parse(JSON.stringify(S));for(const z of["lastLogin","created","modified"])N[z]!==void 0&&N[z]!==null&&(N[z]=new Date(N[z]));return x.convertObjectToArcadeDictionary(N,D(t))}return null}throw new o(t,"InvalidParameter",e)})},a.functions.nearestcoordinate=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,2,2,t,e),!(n[0]instanceof w||n[0]===null))throw new o(t,"InvalidParameter",e);if(!(n[1]instanceof A||n[1]===null))throw new o(t,"InvalidParameter",e);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof L?I.fromExtent(n[0]):n[0],i=await s("getNearestCoordinate",[r.toJSON(),n[1].toJSON(),{calculateLeftRightSide:!0}]);return i===null?null:x.convertObjectToArcadeDictionary({coordinate:p(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.isRightSide?"right":"left"},D(t),!1,!0)})},a.functions.nearestvertex=function(t,e){return a.standardFunctionAsync(t,e,async(f,c,n)=>{if(n=d(n),m(n,2,2,t,e),!(n[0]instanceof w||n[0]===null))throw new o(t,"InvalidParameter",e);if(!(n[1]instanceof A||n[1]===null))throw new o(t,"InvalidParameter",e);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof L?I.fromExtent(n[0]):n[0],i=await s("getNearestVertex",[r.toJSON(),n[1].toJSON()]);return i===null?null:x.convertObjectToArcadeDictionary({coordinate:p(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.isRightSide?"right":"left"},D(t),!1,!0)})})}export{at as registerFunctions};
