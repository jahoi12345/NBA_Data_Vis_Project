import{H as p,P as u,t as h}from"./Point-BfTTZoMu-DeJwQYfh.js";import{S as f}from"./query-DeNEvEsQ-DfFlUyui.js";import{t as y}from"./AttachmentInfo-f2OvCjJR-HodY2X_o.js";import"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import"./index-B0z_nLWi.js";import"./normalizeUtils-85zLqeMi-C1bdAKNn.js";import"./mathUtils-PIGhLnI9-B1tKUlUb.js";import"./Polygon-D6wEPb3W-D2MPjRU4.js";import"./Extent-CgDMOSRD-Bod5LY6s.js";import"./Polyline-CoiTLswR-DTxpB2Yg.js";import"./normalizeUtilsCommon-CnhQye_A-UWhaH-kt.js";import"./pbf-2SIhMekG-LK438LAR.js";import"./projectionUtils-BGH_5_I3-DGwchVO8.js";import"./collectionUtils-jDyktm0P-BDP2Oq99.js";import"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import"./reader-DcGs6kKN-DHJfK-tm.js";import"./pbfQueryUtils-DlZBMNQk-rXCy_evW.js";import"./OptimizedFeature-CwRGZPwv-Ddclhn0A.js";import"./memoryEstimations-Bd726a_p-0cVCY2Jz.js";import"./OptimizedFeatureSet-BR8EEvDc-CgsRgxJh.js";import"./jsonUtils-CmpazY1u-6pDLj5sx.js";import"./queryZScale-CRP3Sh_E-F3y679Wx.js";import"./Cyclical-BLSxUpe7-Bj8R2Yk-.js";import"./utils-CylVuxNi--x86XOjU.js";import"./utils-Dpg4yj1D-CeFz2JVC.js";import"./aaBoundingRect-CjwcS2F3-ri8bmh30.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";function l(n){const t=n.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t.orderByFields&&(t.orderByFields=t.orderByFields.join(",")),t}function C(n,t){const o={};for(const e of t){const{parentObjectId:r,parentGlobalId:s,attachmentInfos:m}=e;for(const a of m){const{id:c}=a,d=u(h(`${n.path}/${r}/attachments/${c}`)),i=y.fromJSON(a);i.set({url:d,parentObjectId:r,parentGlobalId:s}),o[r]?o[r].push(i):o[r]=[i]}}return o}function D(n,t,o){let e={query:f({...n.query,f:"json",...l(t)})};return o&&(e={...o,...e,query:{...o.query,...e.query}}),p(n.path+"/queryAttachments",e).then(r=>r.data.attachmentGroups)}async function E(n,t,o){const{objectIds:e}=t,r=[];for(const s of e)r.push(p(n.path+"/"+s+"/attachments",o));return Promise.all(r).then(s=>e.map((m,a)=>({parentObjectId:m,attachmentInfos:s[a].data.attachmentInfos})))}export{D as executeAttachmentQuery,E as fetchAttachments,C as processAttachmentQueryResult};
