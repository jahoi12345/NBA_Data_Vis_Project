import{Y as e,H as r,a2 as S,G as h,b7 as U,a7 as m,K as D}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{R as O,Y as v}from"./collectionUtils-jDyktm0P-ArdXNs6F.js";import{f as x,al as g,aY as w,aZ as M,aW as T,aX as A}from"./Point-BfTTZoMu-BAT2Wq6O.js";import{u as l}from"./reader-DcGs6kKN-DHJfK-tm.js";import{e as H}from"./layerContainerType-CSXZNpHb-BIF7XAYP.js";import{z as R}from"./Extent-CgDMOSRD-CU1qE5Kr.js";import{r as B}from"./HeightModelInfo-D5IdRvJ2-BK9di2bT.js";import{T as C,M as Q,j as V}from"./OperationalLayer-B6zbJ5nR-sYdHUfAL.js";import{k as F}from"./timeZoneUtils-BSc7-7qA-BAv3h8mh.js";import{j as Z,X as E,r as q,i as I,M as G,k as P,z as k}from"./featureLayerUtils-FKjLNPl_-DLktjSPx.js";import{e as N}from"./LayerFloorInfo-CTubHTci-DKf2wu5F.js";import{m as j}from"./layerUtils-DZGhvm-W-DLw3QMll.js";import{S as z,w as _}from"./multiLayerServiceUtils-CpHWiXA7-B9JDcSQL.js";import{e as L}from"./Relationship-CrANqG2c-DztISWOP.js";import{U as Y}from"./serviceCapabilitiesUtils-BV_pcUiO-CjqWUbfp.js";import{T as $}from"./Field-Cm_ZejYW-CwJZmSru.js";import{a as J,A as W}from"./portalItemUtils-CaPNUJg6-JsqddoLx.js";let d=class extends v(m){constructor(n){super(n),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};e([r()],d.prototype,"creatorField",void 0),e([r()],d.prototype,"creationDateField",void 0),e([r()],d.prototype,"editorField",void 0),e([r()],d.prototype,"editDateField",void 0),e([r()],d.prototype,"realm",void 0),e([r(F("dateFieldsTimeReference",!0))],d.prototype,"timeZone",void 0),d=e([h("esri.layers.support.EditFieldsInfo")],d);let p=class extends v(m){constructor(n){super(n)}};e([r({constructOnly:!0,json:{write:!0}})],p.prototype,"name",void 0),e([r({constructOnly:!0,json:{write:!0}})],p.prototype,"fields",void 0),e([r({constructOnly:!0,json:{write:!0}})],p.prototype,"isAscending",void 0),e([r({constructOnly:!0,json:{write:!0}})],p.prototype,"indexType",void 0),e([r({constructOnly:!0,json:{write:!0}})],p.prototype,"isUnique",void 0),e([r({constructOnly:!0,json:{write:!0}})],p.prototype,"description",void 0),p=e([h("esri.layers.support.FeatureIndex")],p);let f=class extends v(m){constructor(n){super(n),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};e([r({type:String,json:{read:{source:"shapeAreaFieldName"}}})],f.prototype,"shapeAreaField",void 0),e([r({type:String,json:{read:{source:"shapeLengthFieldName"}}})],f.prototype,"shapeLengthField",void 0),e([r({type:String,json:{read:n=>T.read(n)||A.read(n)}})],f.prototype,"units",void 0),f=e([h("esri.layers.support.GeometryFieldsInfo")],f);let u=class extends v(m){constructor(n){super(n),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(n){if(!n)return null;const c={};for(const t of Object.keys(n))c[t]=$(n[t]);return c}writeDomains(n,c){if(!n)return;const t={};for(const o of Object.keys(n))n[o]&&(t[o]=n[o]?.toJSON());c.domains=t}};e([r({type:Number,json:{write:!0}})],u.prototype,"code",void 0),e([r({type:Object,json:{write:!0}})],u.prototype,"defaultValues",void 0),e([r({json:{write:!0}})],u.prototype,"domains",void 0),e([l("domains")],u.prototype,"readDomains",null),e([D("domains")],u.prototype,"writeDomains",null),e([r({type:String,json:{write:!0}})],u.prototype,"name",void 0),u=e([h("esri.layers.support.Subtype")],u);const he=n=>{const c=n;let t=class extends c{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.fieldsIndex=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(O.ofType(p)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=x.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.uniqueIdFields=null,this.url=null,this.version=void 0,this._isUrlHostModified=!1,this._isUrlHostModificationEnabled=!1}getFieldDomain(o,i){throw new Error("Not implemented")}getField(o){return this.fieldsIndex.get(o)}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:o}=this;if(o){const{query:s,operations:a,editing:y}=o;if(!s.supportsQueryByOthers||!s.supportsQueryByAnonymous||a.supportsEditing&&!(y.supportsUpdateByOthers&&y.supportsUpdateByAnonymous&&y.supportsDeleteByOthers&&y.supportsDeleteByAnonymous))return"load"}if(E(this.serviceDefinitionExpression)||E(this.definitionExpression))return"load";if(this.userHasUpdateItemPrivileges){if(q(this))return"load";if(this.hasUpdateItemRestrictions)return o.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const i=this.editFieldsInfo;return(i?.creatorField||i?.editorField)&&o?.operations.supportsEditing?"editing":null}readCapabilitiesFromService(o,i){return Y(i,this.url)}readEditingInfo(o,i){const{editingInfo:s}=i;return s?{lastEditDate:s.lastEditDate!=null?new Date(s.lastEditDate):null}:null}get effectiveCapabilities(){const o=this.capabilities;if(!o)return null;const i=S(o),{operations:s,editing:a}=i;return I(this)?(this.userHasUpdateItemPrivileges&&(s.supportsQuery=!0),i):this.userHasUpdateItemPrivileges?(s.supportsAdd=s.supportsDelete=s.supportsEditing=s.supportsQuery=s.supportsUpdate=a.supportsDeleteByOthers=a.supportsGeometryUpdate=a.supportsUpdateByOthers=!0,i):(this.userHasFullEditingPrivileges&&s.supportsEditing&&(s.supportsAdd=s.supportsDelete=s.supportsUpdate=a.supportsGeometryUpdate=!0),i)}get effectiveEditingEnabled(){return!1}readGlobalIdFieldFromService(o,i){return G(i)}get hasFullEditingRestrictions(){const o=this.capabilities;if(!o||I(this))return!1;const{operations:i,editing:s}=o;return i.supportsEditing&&!(i.supportsAdd&&i.supportsDelete&&i.supportsUpdate&&s.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const o=this.capabilities;if(!o)return!1;const{operations:i,editing:s}=o;return I(this)?!i.supportsQuery:!(i.supportsAdd&&i.supportsDelete&&i.supportsEditing&&i.supportsQuery&&i.supportsUpdate&&s.supportsDeleteByOthers&&s.supportsGeometryUpdate&&s.supportsUpdateByOthers)}readIsTableFromService(o,i){return i.type==="Table"}readMaxScale(o,i){return i.effectiveMaxScale||o||0}readMinScale(o,i){return i.effectiveMinScale||o||0}readObjectIdFieldFromService(o,i){return P(i)}get parsedUrl(){return _(this)}readServiceDefinitionExpression(o,i){return i.definitionQuery||i.definitionExpression}readUniqueIdFields(o,i){return i.uniqueIdInfo?.OIDFieldContainsHashValue?i.uniqueIdInfo.fields:null}readVersion(o,i){return k(i)}get isUrlHostModified(){const{loaded:o,url:i,_isUrlHostModified:s}=this;if(s)return!0;if(!o||!i||this.originIdOf("url")<7)return!1;const a=this.sourceJSON?.preferredHost;if(!a||!g(i,`https://${a}`,!0))return!1;for(let y=6;y>=3;y--){const b=this.getAtOrigin("url",U(y));if(b)return!g(i,b,!0)}return!1}applyPreferredHost(o){const{url:i,portalItem:s}=this;!i||j(s)}applyHostFromPortalItem(){const{url:o,portalItem:i}=this;if(!o||this.originIdOf("url")===7||!i?.url||!j(i)||!J(i,W.HOSTED_SERVICE)||g(o,i.url,!0)||!this._isUrlHostModificationEnabled)return;const s=w(i.url);this._set("url",M(o,s)),this._isUrlHostModified=!0}};return e([r({readOnly:!0})],t.prototype,"authenticationTriggerEvent",null),e([r({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],t.prototype,"copyright",void 0),e([r({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","isDataBranchVersioned","isDataVersioned","maxRecordCount","maxRecordCountFactor","maxUniqueIDCount","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],t.prototype,"capabilities",void 0),e([l("service","capabilities")],t.prototype,"readCapabilitiesFromService",null),e([r(F("dateFieldsTimeReference"))],t.prototype,"dateFieldsTimeZone",void 0),e([r({type:Boolean})],t.prototype,"datesInUnknownTimezone",void 0),e([r({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],t.prototype,"definitionExpression",void 0),e([r({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],t.prototype,"displayField",void 0),e([r({readOnly:!0,type:d})],t.prototype,"editFieldsInfo",void 0),e([r({readOnly:!0})],t.prototype,"editingInfo",void 0),e([l("editingInfo")],t.prototype,"readEditingInfo",null),e([r({readOnly:!0})],t.prototype,"effectiveCapabilities",null),e([r()],t.prototype,"effectiveEditingEnabled",null),e([r((()=>{const o=S(C),i=o.json.origins;return i["web-map"]={read:!1,write:!1},i["portal-item"]={read:!1,write:!1},o})())],t.prototype,"elevationInfo",void 0),e([r()],t.prototype,"fieldsIndex",void 0),e([r({type:N,json:{name:"layerDefinition.floorInfo",write:{layerContainerTypes:H}}})],t.prototype,"floorInfo",void 0),e([r({type:R,json:{origins:{service:{read:{source:"extent"}}}}})],t.prototype,"fullExtent",void 0),e([r()],t.prototype,"gdbVersion",void 0),e([r({readOnly:!0,type:f,json:{read:{source:"geometryProperties"}}})],t.prototype,"geometryFieldsInfo",void 0),e([r({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:Z.read}}}})],t.prototype,"geometryType",void 0),e([r({type:String})],t.prototype,"globalIdField",void 0),e([l("service","globalIdField",["globalIdField","fields"])],t.prototype,"readGlobalIdFieldFromService",null),e([r({readOnly:!0})],t.prototype,"hasFullEditingRestrictions",null),e([r({type:Boolean,json:{origins:{service:{read:!0}}}})],t.prototype,"hasM",void 0),e([r({readOnly:!0})],t.prototype,"hasUpdateItemRestrictions",null),e([r({type:Boolean,json:{origins:{service:{read:!0}}}})],t.prototype,"hasZ",void 0),e([r({readOnly:!0,type:B})],t.prototype,"heightModelInfo",void 0),e([r({type:Date})],t.prototype,"historicMoment",void 0),e([r({type:O.ofType(p),readOnly:!0})],t.prototype,"indexes",void 0),e([r({readOnly:!0})],t.prototype,"isTable",void 0),e([l("service","isTable",["type"])],t.prototype,"readIsTableFromService",null),e([r({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],t.prototype,"layerId",void 0),e([r(Q)],t.prototype,"maxScale",void 0),e([l("service","maxScale",["maxScale","effectiveMaxScale"])],t.prototype,"readMaxScale",null),e([r(V)],t.prototype,"minScale",void 0),e([l("service","minScale",["minScale","effectiveMinScale"])],t.prototype,"readMinScale",null),e([r({type:String})],t.prototype,"objectIdField",void 0),e([l("service","objectIdField",["objectIdField","fields"])],t.prototype,"readObjectIdFieldFromService",null),e([r({readOnly:!0})],t.prototype,"parsedUrl",null),e([r(F("preferredTimeReference"))],t.prototype,"preferredTimeZone",void 0),e([r({type:[L],readOnly:!0})],t.prototype,"relationships",void 0),e([r({type:Boolean})],t.prototype,"returnM",void 0),e([r({type:Boolean})],t.prototype,"returnZ",void 0),e([r({readOnly:!0,json:{write:!1}})],t.prototype,"serverGens",void 0),e([r({readOnly:!0})],t.prototype,"serviceDefinitionExpression",void 0),e([l("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],t.prototype,"readServiceDefinitionExpression",null),e([r({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],t.prototype,"serviceItemId",void 0),e([r()],t.prototype,"sourceJSON",void 0),e([r({type:x,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],t.prototype,"spatialReference",void 0),e([r({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],t.prototype,"subtypeField",void 0),e([r({type:[u],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],t.prototype,"subtypes",void 0),e([r({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],t.prototype,"trackIdField",void 0),e([r({type:[String],readOnly:!0})],t.prototype,"uniqueIdFields",void 0),e([l("service","uniqueIdFields",["uniqueIdInfo.OIDFieldContainsHashValue","uniqueIdInfo.fields"])],t.prototype,"readUniqueIdFields",null),e([r(z({nonStandardUrlAllowed:!0}))],t.prototype,"url",void 0),e([r({json:{origins:{service:{read:!0}},read:!1}})],t.prototype,"version",void 0),e([l("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],t.prototype,"readVersion",null),e([r({readOnly:!0})],t.prototype,"isUrlHostModified",null),t=e([h("esri.layers.mixins.FeatureLayerBase")],t),t};export{he as h};
