const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/loader-CvLhmqYC-zMi5AUkS.js","assets/index-CTl7hdrJ.js","assets/index-Cv2ko1Ob.css","assets/jsonMap-Bs3hmeCU-Cusd0Fmz.js","assets/mat4f64-q_b6UJoq-Dh6sWB_w.js","assets/Point-BfTTZoMu-BAT2Wq6O.js","assets/reader-DcGs6kKN-DHJfK-tm.js","assets/Version-BtYZEj58-LyRHDnSJ.js","assets/mat4-C96X-Nn0-Do6fKsNS.js","assets/collectionUtils-jDyktm0P-ArdXNs6F.js","assets/reactiveUtils-SO2Ko3sy-BCLX8Jdy.js","assets/Extent-CgDMOSRD-CU1qE5Kr.js","assets/SimpleObservable-CvFyr0NA-DXpoMYph.js","assets/Polygon-D6wEPb3W-CpL9Efjx.js","assets/aaBoundingRect-CjwcS2F3-D7aII9DY.js","assets/mathUtils-PIGhLnI9-B1tKUlUb.js","assets/quat-B7J5v7rV-i-DOMCm_.js","assets/quatf64-CCm9z-pX-CQ7_sSji.js","assets/vec32-CewSdTn3-DHOFKD0R.js","assets/vec42-B8VM4vXb-BnA9MysM.js","assets/BufferView-Cj2sQaht-DuP-iLZg.js","assets/vec2f64-rIxtbMRN-Kai9mK1i.js","assets/vec4f64-DPb6J-GU-C7c2DqbZ.js","assets/resourceUtils-DWVfTVer-NJXuINUS.js","assets/enums-B4pqBiXb-BO-3hS_8.js"])))=>i.map(i=>d[i]);
import{H as te,_ as se}from"./index-CTl7hdrJ.js";import{v as re,j as A}from"./Color-CERqXxxY-BuYn26eI.js";import{e as oe}from"./devEnvironmentUtils-8WtPGj6h-8bFtASy7.js";import{G as D}from"./mathUtils-PIGhLnI9-B1tKUlUb.js";import{n as O,a as W,H as L,D as ie,E as ne}from"./Polygon-D6wEPb3W-CpL9Efjx.js";import{z as ae}from"./mat4-C96X-Nn0-Do6fKsNS.js";import{n as le}from"./mat4f64-q_b6UJoq-Dh6sWB_w.js";import{O as ue}from"./vec2f64-rIxtbMRN-Kai9mK1i.js";import{V as U,$ as me,p as q,x as ce,l as fe,J as pe}from"./vec32-CewSdTn3-DHOFKD0R.js";import{t as P}from"./collectionUtils-jDyktm0P-ArdXNs6F.js";import{f as de,D as z}from"./aaBoundingBox-Cn49X7ge-DORLZxoS.js";import{a1 as $,cC as xe,cB as ge,ba as S,g as he,aK as Te,d3 as be,bj as ye}from"./Texture-CFNZjV2R-lGBztxVp.js";import{m as H,F as J,_ as ve,j as we,A as Re,X as Be}from"./BufferView-Cj2sQaht-DuP-iLZg.js";import{b as je,z as Me,j as k,T as G}from"./vec3-B_phcnZY-DHC7I6xa.js";import{R as Se,x as N}from"./vec4-B7mYuNMQ-ChTBJPnP.js";import{U as _e,c as Ce}from"./indexUtils-DpmEYOW0-Be5tCvPq.js";import{y as Ee}from"./DefaultLoadingContext-DXgBe4GE-Colk9t6X.js";import{p as _}from"./resourceUtils-DWVfTVer-NJXuINUS.js";import{l as Ae,s as Oe}from"./vec2f32-CaVKkSa6-BjkBmyoj.js";import{g as Pe,w as $e}from"./wosrLoader-CIPfz1Cl-qtGxLmBP.js";import{a as B}from"./orientedBoundingBox-BLEx7wLU-CPBtS4XC.js";import"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import"./Extent-CgDMOSRD-CU1qE5Kr.js";import"./Point-BfTTZoMu-BAT2Wq6O.js";import"./reader-DcGs6kKN-DHJfK-tm.js";import"./aaBoundingRect-CjwcS2F3-D7aII9DY.js";import"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";import"./DoubleArray-DExKNiTh-CvVpHySW.js";import"./Indices-D0_UQPPr-t1Qev6md.js";import"./sphere-DLQ6p7mp-DmnRpHXV.js";import"./vec4f64-DPb6J-GU-C7c2DqbZ.js";import"./vector-B8ZDYGQ6-B1uNywRb.js";import"./quatf64-CCm9z-pX-CQ7_sSji.js";import"./frustum-CMzahy3--CFytpSYl.js";import"./vec42-B8VM4vXb-BnA9MysM.js";import"./plane-BNdSPG2o-Cq7jmU6w.js";import"./Emissions.glsl-B8XKMjLy-DXfiRNVX.js";import"./enums-B4pqBiXb-BO-3hS_8.js";import"./InterleavedLayout-B7roQAzV-CC2VYRPC.js";import"./types-BKo2foNY-DE0QfIFp.js";import"./VertexElementDescriptor-BlxU8vCE-BwuKQkTU.js";import"./screenUtils-BitdhK1O-L0FLPAMi.js";import"./lengthUtils-Dt1_RvOO-bleznLOi.js";import"./date-IqUzANpt-bLKO9IDT.js";import"./Cyclical-BLSxUpe7-Bj8R2Yk-.js";import"./projectionUtils-BGH_5_I3-BySNUA-B.js";import"./Polyline-CoiTLswR-BLagWJLS.js";import"./projectPointToVector-DL7Z4uvb-BbcUuq8O.js";import"./projectVectorToVector-Csv3NYZI-BsIKHfQD.js";import"./HUDIntersectorResult-1xTExS7z-CU1-YQoW.js";import"./normalizeUtils-85zLqeMi-DCF9gKvo.js";import"./normalizeUtilsCommon-CnhQye_A-zWtr51r8.js";import"./jsonUtils-CmpazY1u-ateEpj4Q.js";import"./utils-CylVuxNi-CqOfmBVG.js";import"./utils-Dpg4yj1D-BVnuoMV8.js";import"./videoUtils-Dwx3AEgj-CduhpDRk.js";import"./asyncUtils-w6KfWU41-HenJ0UOu.js";import"./memoryEstimations-Bd726a_p-0cVCY2Jz.js";import"./Version-BtYZEj58-LyRHDnSJ.js";import"./quat-B7J5v7rV-i-DOMCm_.js";import"./spatialReferenceEllipsoidUtils-D2JabnKt-Cip58jmo.js";import"./computeTranslationToOriginAndRotation-Bjd4esRf-CXUng2L4.js";const X=(t,s=X,o=s.f||(s.f=["assets/loader-CvLhmqYC.js","assets/jsonMap-Bs3hmeCU.js","assets/mat4f64-q_b6UJoq.js","assets/Point-BfTTZoMu.js","assets/reader-DcGs6kKN.js","assets/index-BzxsWNRw.js","assets/index-Cv2ko1Ob.css","assets/Version-BtYZEj58.js","assets/mat4-C96X-Nn0.js","assets/collectionUtils-jDyktm0P.js","assets/reactiveUtils-SO2Ko3sy.js","assets/Extent-CgDMOSRD.js","assets/SimpleObservable-CvFyr0NA.js","assets/Polygon-D6wEPb3W.js","assets/aaBoundingRect-CjwcS2F3.js","assets/mathUtils-PIGhLnI9.js","assets/quat-B7J5v7rV.js","assets/quatf64-CCm9z-pX.js","assets/vec32-CewSdTn3.js","assets/vec42-B8VM4vXb.js","assets/BufferView-Cj2sQaht.js","assets/vec2f64-rIxtbMRN.js","assets/vec4f64-DPb6J-GU.js","assets/resourceUtils-DWVfTVer.js","assets/enums-B4pqBiXb.js"]))=>t.map(r=>o[r]);function j(t){if(t==null)return null;const s=t.offset!=null?t.offset:Ae,o=t.rotation!=null?t.rotation:0,r=t.scale!=null?t.scale:Oe,m=O(1,0,0,0,1,0,s[0],s[1],1),f=O(Math.cos(o),-Math.sin(o),0,Math.sin(o),Math.cos(o),0,0,0,1),n=O(r[0],0,0,0,r[1],0,0,0,1),a=W();return L(a,f,n),L(a,m,a),a}class Fe{constructor(){this.geometries=new Array,this.materials=new Array,this.textures=new Array}}class Ie{constructor(s,o,r){this.name=s,this.lodThreshold=o,this.pivotOffset=r,this.stageResources=new Fe,this.numberOfVertices=0}}async function Ve(t,s){const o=K(oe(t));if(o.fileType==="wosr"){const l=await(s.cache?s.cache.loadWOSR(o.url,s):Pe(o.url,s)),{engineResources:d,referenceBoundingBox:x}=$e(l,s);return{lods:d,referenceBoundingBox:x,isEsriSymbolResource:!1,isWosr:!0}}let r;if(s.cache)r=await s.cache.loadGLTF(o.url,s,!!s.usePBR);else{const{loadGLTF:l}=await te(()=>se(()=>import("./loader-CvLhmqYC-zMi5AUkS.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),X([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]));r=await l(new Ee(s.streamDataRequester),o.url,s,s.usePBR)}const m=r.model.meta?.ESRI_proxyEllipsoid,f=r.meta.isEsriSymbolResource&&m!=null&&r.meta.ESRI_webstyle==="EsriRealisticTreesStyle";f&&!r.customMeta.esriTreeRendering&&(r.customMeta.esriTreeRendering=!0,ze(r,m));const n=!!s.usePBR,a=r.meta.isEsriSymbolResource?{usePBR:n,isSchematic:!1,treeRendering:f,mrrFactors:be}:{usePBR:n,isSchematic:!1,treeRendering:!1,mrrFactors:ye},u={...s.materialParameters,treeRendering:f},{engineResources:e,referenceBoundingBox:i}=De(r,a,u,s,o.specifiedLodIndex,f);return{lods:e,referenceBoundingBox:i,isEsriSymbolResource:r.meta.isEsriSymbolResource,isWosr:!1}}function K(t){const s=t.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return s?{fileType:"gltf",url:s[1],specifiedLodIndex:s[4]!=null?Number(s[4]):null}:t.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:t,specifiedLodIndex:null}:{fileType:"unknown",url:t,specifiedLodIndex:null}}function De(t,s,o,r,m,f){const n=t.model,a=new Array,u=new Map,e=new Map,i=n.lods.length,l=de();return n.lods.forEach((d,x)=>{const g=r.skipHighLods===!0&&(i>1&&x===0||i>3&&x===1)||r.skipHighLods===!1&&m!=null&&x!==m;if(g&&x!==0)return;const c=new Ie(d.name,d.lodThreshold,[0,0,0]);d.parts.forEach(h=>{const T=g?new $({},r):Le(n,h,c,s,o,u,e,r,f),{geometry:y,vertexCount:p}=Ue(h,T??new $({},r)),b=y.boundingInfo;b!=null&&x===0&&(z(l,b.bbMin),z(l,b.bbMax)),T!=null&&(c.stageResources.geometries.push(y),c.numberOfVertices+=p)}),g||a.push(c)}),{engineResources:a,referenceBoundingBox:l}}function Le(t,s,o,r,m,f,n,a,u){const e=t.materials.get(s.material);if(e==null)return null;const{normal:i,color:l,texCoord0:d,tangent:x}=s.attributes,g=s.material+(i?"_normal":"")+(l?"_color":"")+(d?"_texCoord0":"")+(x?"_tangent":""),c=s.attributes.texCoord0!=null,h=s.attributes.normal!=null,T=qe(e.alphaMode);if(!f.has(g)){if(c){const R=(M,Z=!1,Y=!1)=>{if(M!=null&&!n.has(M)){const E=t.textures.get(M);if(E){const v=E.data,ee=Z&&!_(v)?a.compressionOptions:void 0;n.set(M,new Te(_(v)?v.data:v,{...E.parameters,preMultiplyAlpha:!_(v)&&Y,encoding:_(v)?v.encoding:void 0,compressionOptions:ee}))}}},Q=T!==1&&!u;R(e.colorTexture,Q,T!==1),R(e.normalTexture),R(e.occlusionTexture,!0),R(e.emissiveTexture),R(e.metallicRoughnessTexture,!0)}const p=A(e.color[0]),b=A(e.color[1]),F=A(e.color[2]),C=e.colorTexture!=null&&c?n.get(e.colorTexture):null,I=xe(e),V=e.normalTextureTransform?.scale!=null?e.normalTextureTransform?.scale:ue;f.set(g,new $({...r,customDepthTest:1,textureAlphaMode:T,textureAlphaCutoff:e.alphaCutoff,diffuse:[p,b,F],ambient:[p,b,F],opacity:e.alphaMode==="OPAQUE"?1:e.opacity,doubleSided:e.doubleSided,doubleSidedType:"winding-order",cullFace:e.doubleSided?0:2,hasVertexColors:!!s.attributes.color,hasVertexTangents:!!s.attributes.tangent,normalType:h?0:2,castShadows:!0,receiveShadows:e.receiveShadows,receiveAmbientOcclusion:e.receiveAmbientOcclusion,textureId:C?.id,colorMixMode:e.colorMixMode,normalTextureId:e.normalTexture!=null&&c?n.get(e.normalTexture).id:void 0,textureAlphaPremultiplied:C!=null&&!!C.parameters.preMultiplyAlpha,occlusionTextureId:e.occlusionTexture!=null&&c?n.get(e.occlusionTexture).id:void 0,emissiveTextureId:e.emissiveTexture!=null&&c?n.get(e.emissiveTexture).id:void 0,metallicRoughnessTextureId:e.metallicRoughnessTexture!=null&&c?n.get(e.metallicRoughnessTexture).id:void 0,emissiveBaseColor:[e.emissiveFactor[0],e.emissiveFactor[1],e.emissiveFactor[2]],mrrFactors:I?ge:[e.metallicFactor,e.roughnessFactor,r.mrrFactors[2]],isSchematic:I,colorTextureTransformMatrix:j(e.colorTextureTransform),normalTextureTransformMatrix:j(e.normalTextureTransform),scale:[V[0],V[1]],occlusionTextureTransformMatrix:j(e.occlusionTextureTransform),emissiveTextureTransformMatrix:j(e.emissiveTextureTransform),metallicRoughnessTextureTransformMatrix:j(e.metallicRoughnessTextureTransform),...m},a))}const y=f.get(g);if(o.stageResources.materials.push(y),c){const p=b=>{b!=null&&o.stageResources.textures.push(n.get(b))};p(e.colorTexture),p(e.normalTexture),p(e.occlusionTexture),p(e.emissiveTexture),p(e.metallicRoughnessTexture)}return y}function Ue(t,s){const o=t.attributes.position.count,r=_e(t.indices||o,t.primitiveType),m=S(3*o),{typedBuffer:f,typedBufferStride:n}=t.attributes.position;je(m,f,t.transform,3,n);const a=[["position",new B(m,r,3,!0)]];if(t.attributes.normal!=null){const e=S(3*o),{typedBuffer:i,typedBufferStride:l}=t.attributes.normal;ie(w,t.transform),Me(e,i,w,3,l),D(w)&&k(e,e),a.push(["normal",new B(e,r,3,!0)])}if(t.attributes.tangent!=null){const e=S(4*o),{typedBuffer:i,typedBufferStride:l}=t.attributes.tangent;ne(w,t.transform),Se(e,i,w,4,l),D(w)&&k(e,e,4),a.push(["tangent",new B(e,r,4,!0)])}if(t.attributes.texCoord0!=null){const e=S(2*o),{typedBuffer:i,typedBufferStride:l}=t.attributes.texCoord0;Ce(e,i,2,l),a.push(["uv0",new B(e,r,2,!0)])}const u=t.attributes.color;if(u!=null){const e=new Uint8Array(4*o);u.elementCount===4?u instanceof J?N(e,u,1,255):(u instanceof ve||u instanceof we)&&N(e,u,1/255,255):(e.fill(255),u instanceof H?G(e,u.typedBuffer,1,255,4,u.typedBufferStride):(t.attributes.color instanceof Re||t.attributes.color instanceof Be)&&G(e,u.typedBuffer,1/255,255,4,t.attributes.color.typedBufferStride)),a.push(["color",new B(e,r,4,!0)])}return{geometry:new he(s,a),vertexCount:o}}const w=W();function qe(t){switch(t){case"BLEND":return 0;case"MASK":return 2;case"OPAQUE":case null:case void 0:return 1}}function ze(t,s){for(let o=0;o<t.model.lods.length;++o){const r=t.model.lods[o];for(const m of r.parts){const f=m.attributes.normal;if(f==null)return;const n=m.attributes.position,a=n.count,u=P(),e=P(),i=P(),l=new Float32Array(4*a),d=new Float32Array(3*a),x=ae(le(),m.transform);let g=0,c=0;for(let h=0;h<a;h++){n.getVec(h,e),f.getVec(h,u),U(e,e,m.transform),me(i,e,s.center),q(i,i,s.radius);const T=i[2],y=ce(i),p=Math.min(.45+.55*y*y,1)**re;q(i,i,s.radius),x!==null&&U(i,i,x),fe(i,i),o+1!==t.model.lods.length&&t.model.lods.length>1&&pe(i,i,u,T>-1?.2:Math.min(-4*T-3.8,1)),d[g]=i[0],d[g+1]=i[1],d[g+2]=i[2],g+=3,l[c]=p,l[c+1]=p,l[c+2]=p,l[c+3]=1,c+=4}m.attributes.normal=new H(d.buffer),m.attributes.color=new J(l.buffer)}}}const Zt=Object.freeze(Object.defineProperty({__proto__:null,fetch:Ve,parseUrl:K},Symbol.toStringTag,{value:"Module"}));export{Zt as o,j as s,Ve as z};
