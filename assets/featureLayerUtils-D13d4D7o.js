const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/editingSupport-CO6jXfin.js","assets/Graphic-CfT07maQ.js","assets/jsonMap-Bs3hmeCU.js","assets/getPopupProvider-zqy7P9ZA.js","assets/collectionUtils-Cc1OWTqq.js","assets/index-BiLqt4Ue.js","assets/index-Cv2ko1Ob.css","assets/Point-CMHR1y9V.js","assets/reader-DcGs6kKN.js","assets/reactiveUtils-SO2Ko3sy.js","assets/Extent-BVvEPGp_.js","assets/SimpleObservable-CvFyr0NA.js","assets/lengthUtils-1lu2BknD.js","assets/date-IqUzANpt.js","assets/Color-CERqXxxY.js","assets/mathUtils-PIGhLnI9.js","assets/Layer--kjMcEYS.js","assets/jsonUtils-BIx2Bg38.js","assets/Polyline-CYNn9agI.js","assets/Polygon-WlfMxvm8.js","assets/aaBoundingRect-WcI4brw6.js","assets/typeUtils-Dr-CEt7y.js","assets/createFeatureId-CVwTD0fV.js","assets/typeUtils-BUTeHmXX.js","assets/lineMarkers-CDwLe3J6.js","assets/PolygonSymbol3D-DOhH5ySO.js","assets/ExtrudeSymbol3DLayer-DSc1ou2x.js","assets/screenUtils-BitdhK1O.js","assets/opacityUtils-DuFH0EC9.js","assets/aaBoundingBox-CNqmdQRu.js","assets/DoubleArray-DExKNiTh.js","assets/mat4f64-q_b6UJoq.js","assets/Font-SQ7b_Y8G.js","assets/SimpleFillSymbol-CDawtd9z.js","assets/SimpleMarkerSymbol-BGAFRS9_.js","assets/PictureMarkerSymbol-6cJpxdoq.js","assets/TextSymbol-DhXD0YaH.js","assets/uuid-Oe6SV2kF.js","assets/normalizeUtils-BEJV7G0l.js","assets/Cyclical-BLSxUpe7.js","assets/normalizeUtilsCommon-DnSvD7ht.js","assets/utils-BrkeFJbU.js","assets/utils-DGvxRWBb.js","assets/EditBusLayer-CKIqgz_E.js","assets/infoFor3D-DhzudQro.js","assets/layerUtils-CCPFPk-j.js"])))=>i.map(i=>d[i]);
import{_ as D}from"./index-BiLqt4Ue.js";import{f as _,a as b}from"./Point-CMHR1y9V.js";import{b as N}from"./asyncUtils-w6KfWU41.js";import{v as E,y as A,_ as i,m as a,r as g,a as M,a9 as B,x as C,a2 as k,s as u}from"./jsonMap-Bs3hmeCU.js";import{G as z,p as G,J as H}from"./lengthUtils-1lu2BknD.js";import{e as V}from"./uuid-Oe6SV2kF.js";import{p as R,i as q}from"./Field-Cm_ZejYW.js";import{r as Q}from"./featureQueryAll-DDEwSb-l.js";import{D as Z,N as L}from"./layerUtils-CCPFPk-j.js";import J from"./SimpleRenderer-Ezg3CDnO.js";import{$ as W}from"./UniqueValueRenderer-DMf1gUze.js";import{n as U}from"./NormalizationBinParametersMixin-BK9wNkI3.js";import{R as K,b as v}from"./Query-dGEUg7py.js";import{D as X}from"./typeUtils-BUTeHmXX.js";var j;let c=class extends E{static{j=this}constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.orderByFields=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new j(A({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};i([a({type:[String],json:{write:!0}})],c.prototype,"attachmentTypes",void 0),i([a({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],c.prototype,"attachmentsWhere",void 0),i([a({type:Boolean,json:{write:!0}})],c.prototype,"cacheHint",void 0),i([a({type:[String],json:{write:!0}})],c.prototype,"keywords",void 0),i([a({type:[String],json:{write:!0}})],c.prototype,"globalIds",void 0),i([a({json:{write:!0}})],c.prototype,"name",void 0),i([a({type:Number,json:{read:{source:"resultRecordCount"}}})],c.prototype,"num",void 0),i([a({type:[Number],json:{write:!0}})],c.prototype,"objectIds",void 0),i([a({type:[String],json:{write:!0}})],c.prototype,"orderByFields",void 0),i([a({type:Boolean,json:{default:!1,write:!0}})],c.prototype,"returnMetadata",void 0),i([a({type:[Number],json:{write:!0}})],c.prototype,"size",void 0),i([a({type:Number,json:{read:{source:"resultOffset"}}})],c.prototype,"start",void 0),i([g("start"),g("num")],c.prototype,"writeStart",null),i([a({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],c.prototype,"where",void 0),c=j=i([M("esri.rest.support.AttachmentQuery")],c),c.from=B(c);var F;let l=class extends E{static{F=this}constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(e.definitionExpression="1=1")}clone(){return new F(A({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};i([a({type:Boolean,json:{write:!0}})],l.prototype,"cacheHint",void 0),i([a({type:K,json:{write:!0}})],l.prototype,"dynamicDataSource",void 0),i([a({type:String,json:{write:!0}})],l.prototype,"gdbVersion",void 0),i([a({type:Number,json:{write:!0}})],l.prototype,"geometryPrecision",void 0),i([a({type:Date})],l.prototype,"historicMoment",void 0),i([g("historicMoment")],l.prototype,"_writeHistoricMoment",null),i([a({type:Number,json:{write:!0}})],l.prototype,"maxAllowableOffset",void 0),i([a({json:{write:!0}})],l.prototype,"objectIds",void 0),i([a({type:[String],json:{write:!0}})],l.prototype,"orderByFields",void 0),i([a({type:[String],json:{write:!0}})],l.prototype,"outFields",void 0),i([a({type:_,json:{read:{source:"outSR"},write:{target:"outSR"}}})],l.prototype,"outSpatialReference",void 0),i([a({json:{write:!0}})],l.prototype,"relationshipId",void 0),i([a({type:Number,json:{read:{source:"resultOffset"}}})],l.prototype,"start",void 0),i([g("start"),g("num")],l.prototype,"writeStart",null),i([a({type:Number,json:{read:{source:"resultRecordCount"}}})],l.prototype,"num",void 0),i([a({json:{write:!0}})],l.prototype,"returnGeometry",void 0),i([a({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],l.prototype,"returnM",void 0),i([a({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],l.prototype,"returnZ",void 0),i([a({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],l.prototype,"where",void 0),l=F=i([M("esri.rest.support.RelationshipQuery")],l),l.from=B(l);const jt=Object.freeze(Object.defineProperty({__proto__:null,get default(){return l}},Symbol.toStringTag,{value:"Module"})),Ft=new C({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function St(t,e,n,r){const o=await w(t);if(await S(t,e,r),!o.addAttachment)throw new u(r,"Layer source does not support addAttachment capability");return o.addAttachment(e,n)}function S(t,e,n){const{attributes:r}=e,{objectIdField:o}=t;return t.capabilities?.data?.supportsAttachment?e?r?o&&r[o]?Promise.resolve():Promise.reject(new u(n,`feature is missing the identifying attribute ${o}`)):Promise.reject(new u(n,"'attributes' are required on a feature to query attachments")):Promise.reject(new u(n,"A feature is required to add/delete/update attachments")):Promise.reject(new u(n,"this layer doesn't support attachments"))}async function xt(t,e,n,r,o){const s=await w(t);if(await S(t,e,o),!s.updateAttachment)throw new u(o,"Layer source does not support updateAttachment capability");return s.updateAttachment(e,n,r)}async function Pt(t,e,n){const{applyEdits:r}=await D(()=>import("./editingSupport-CO6jXfin.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45])),o=await t.load();let s=n;return o.type==="feature"&&o.infoFor3D&&e.deleteFeatures!=null&&o.globalIdField!=null&&(s={...s,globalIdToObjectId:await ot(o,e.deleteFeatures,o.globalIdField)}),r(o,o.source,e,n)}async function Ot(t,e,n){const{uploadAssets:r}=await D(()=>import("./editingSupport-CO6jXfin.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45])),o=await t.load();return r(o,o.source,e,n)}async function Dt(t,e,n,r){const o=await w(t);if(await S(t,e,r),!o.deleteAttachments)throw new u(r,"Layer source does not support deleteAttachments capability");return o.deleteAttachments(e,n)}async function Et(t,e,n){const r=(await t.load({signal:e?.signal})).source;if(!r.fetchRecomputedExtents)throw new u(n,"Layer source does not support fetchUpdates capability");return r.fetchRecomputedExtents(e)}async function At(t,e,n,r){e=c.from(e),await t.load();const o=t.source,s=t.capabilities;if(!s?.data?.supportsAttachment)throw new u(r,"this layer doesn't support attachments");const{attachmentTypes:d,objectIds:y,globalIds:p,num:f,size:h,start:m,where:x}=e;if(!s?.operations?.supportsQueryAttachments&&(d?.length>0||p?.length>0||h?.length>0||f||m||x))throw new u(r,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(y?.length||p?.length||x))throw new u(r,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!o.queryAttachments)throw new u(r,"Layer source does not support queryAttachments capability",e);return!s?.attachment?.supportsOrderByFields&&e.orderByFields?.length&&((e=e.clone()).orderByFields=null),o.queryAttachments(e)}async function Mt(t,e,n,r){const o=await w(t);if(!o.queryObjectIds)throw new u(r,"Layer source does not support queryObjectIds capability");return o.queryObjectIds(v.from(e)??t.createQuery(),n)}async function Bt(t,e,n,r){const o=await w(t);if(!o.queryFeatureCount)throw new u(r,"Layer source does not support queryFeatureCount capability");return o.queryFeatureCount(v.from(e)??t.createQuery(),n)}async function Rt(t,e,n,r){const o=await w(t);if(!o.queryExtent)throw new u(r,"Layer source does not support queryExtent capability");return o.queryExtent(v.from(e)??t.createQuery(),n)}async function qt(t,e,n,r){const o=await w(t);if(!o.queryRelatedFeatures)throw new u(r,"Layer source does not support queryRelatedFeatures capability");return o.queryRelatedFeatures(l.from(e),n)}async function Lt(t,e,n,r){const o=await w(t);if(!o.queryRelatedFeaturesCount)throw new u(r,"Layer source does not support queryRelatedFeaturesCount capability");return o.queryRelatedFeaturesCount(l.from(e),n)}async function $t(t){const e=t.source;if(e?.refresh)try{const{dataChanged:n,updates:r}=await e.refresh();if(r!=null&&(t.sourceJSON={...t.sourceJSON,...r},t.read(r,{origin:"service",url:t.parsedUrl})),n)return!0}catch{}if(t.definitionExpression)try{return(await z(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function Tt(t){const e=new v;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,e.outFields=["*"],e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null;const n=t.capabilities?.query;n&&(e.compactGeometryEnabled=n.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=n.supportsDefaultSpatialReference);const r=t.capabilities?.data;r?.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),r?.supportsM&&t.returnM!=null&&(e.returnM=t.returnM);const{timeOffset:o,timeExtent:s}=t;return e.timeExtent=o!=null&&s!=null?s.offset(-o.value,o.unit):s||null,e}function _t(t){const{globalIdField:e,fields:n}=t;if(e)return e;if(n){for(const r of n)if(r.type==="esriFieldTypeGlobalID")return r.name}}function Nt(t){const{objectIdField:e,fields:n}=t;if(e)return e;if(n){for(const r of n)if(r.type==="esriFieldTypeOID")return r.name}}function Ct(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function kt(t,e,n,r){const o=n?.feature,s=!!t.subtypes?.length;if(s&&!n?.excludeImpliedDomains){const p=tt(t,e);if(p)return p}const d=s&&Y(t,o);if(d){const p=d?.domains?.[e];return p?.type==="inherited"?r:p}const y=it(t.types,t.typeIdField,o);if(y){const p=y.domains&&y.domains[e];if(p&&p?.type!=="inherited")return p}if(r)return r;if(!n?.excludeImpliedDomains){const p=et(t,e);if(p)return p}return null}function Y(t,e){const{subtypes:n,subtypeField:r}=t;if(!e?.attributes||!n?.length||!r)return null;const o=e.attributes[r];return o==null?null:n.find(s=>s.code===o)}function tt(t,e){const{fieldsIndex:n,subtypeField:r}=t,{name:o,type:s}=n.get(e)??{};if(!o)return null;if((r&&n.get(r)?.name)===o&&t.subtypes?.length){const d=t.subtypes.map(y=>new R({code:$(y.code,s),name:y.name}));if(d?.length)return new q({codedValues:d})}return null}function et(t,e){const{fieldsIndex:n}=t,{name:r,type:o}=n.get(e)??{};if(!r)return null;if(("typeIdField"in t?n.get(t.typeIdField)?.name:null)===r&&"types"in t&&t.types?.length){const s=t.types.map(d=>new R({code:$(d.id,o),name:d.name}));return new q({codedValues:s})}return null}function $(t,e){return e?G({type:e})&&typeof t=="number"?`${t}`:H({type:e})&&typeof t=="string"?Number.parseInt(t,10):t:t}async function w(t){return(await t.load()).source}async function zt(t,e){if(!b)return;const n=b.findCredential(t);if(n)return n.userId;let r;try{const o=await L(t,e);o&&(r=await b.checkSignInStatus(`${o}/sharing`))}catch{}return r?r.userId:null}async function T(t,e){if(!b||b.findCredential(t))return;let n;try{const r=await L(t,e);r&&(n=await b.checkSignInStatus(`${r}/sharing`))}catch{}if(n)try{const r=e!=null?e.signal:null;await b.getCredential(t,{signal:r})}catch{}}async function Gt(t,e,n){const r=t.parsedUrl?.path;r&&t.authenticationTriggerEvent===e&&await T(r,n)}async function Ht(t){const e=t.parsedUrl?.path;e&&rt(t)&&await T(e)}function rt(t){return nt(t)&&("serviceDefinitionExpression"in t&&P(t.serviceDefinitionExpression)||"definitionExpression"in t&&P(t.definitionExpression))}function nt(t){return!(!Z(t)||!t.capabilities?.query.supportsCurrentUser)}function P(t){return!!t?.toLowerCase().includes("current_user")}function Vt(t){return!st(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const I=k({types:X});function Qt(t,e){if(t.defaultSymbol)return t.types?.length?new W({defaultSymbol:I(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(n=>({id:n.id,symbol:I(n.symbol,n,e)}))}):new J({symbol:I(t.defaultSymbol,t,e)})}function Zt(t){let e=t.sourceJSON?.cacheMaxAge;if(!e)return!1;const n=t.editingInfo?.lastEditDate?.getTime();return n==null||(e*=1e3,Date.now()-n<e)}async function ot(t,e,n){if(e==null)return null;const r=[],{objectIdField:o}=t;if(e.forEach(f=>{let h=null;if("attributes"in f){const{attributes:m}=f;h={globalId:m[n],objectId:m[o]!=null&&m[o]!==-1?m[o]:null}}else h={globalId:f.globalId,objectId:f.objectId!=null&&f.objectId!==-1?f.objectId:null};h.globalId!=null&&(h.objectId!=null&&h.objectId!==-1||r.push(h.globalId))}),r.length===0)return null;const s=t.createQuery();s.where=r.map(f=>`${n}='${f}'`).join(" OR "),s.returnGeometry=!1,s.outFields=[o,n],s.cacheHint=!1;const d=await N(Q(t,s));if(!d.ok)return null;const y=new Map,p=d.value.features;for(const f of p){const h=f.attributes[n],m=f.attributes[o];h!=null&&m!=null&&m!==-1&&y.set(V(h),m)}return y}function it(t,e,n){if(!e||!n||!t)return null;const r=n.getAttribute(e);return r==null?null:t.find(o=>{const{id:s}=o;return s!=null&&s.toString()===r.toString()})??null}function st(t){return t.sourceJSON?.isMultiServicesView||at(t)}function at(t){return!!t.sourceJSON?.capabilities?.toLowerCase().split(",").map(e=>e.trim()).includes("map")}function Jt(t,e,n){const r=e?.queryAttributeBins;if(!e?.operations?.supportsQueryBins||!r)throw new u(n,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!r.supportsAutoInterval)throw new u(n,"Layer source does not support auto-interval binning");if(t.binParameters.normalizationType&&(!r.supportsNormalization||!O(t.binParameters.normalizationType,r.supportedNormalizationTypes)))throw new u(n,"Layer source does not support normalization binning");break;case"date":if(!r.supportsDate)throw new u(n,"Layer source does not support date binning");if(t.binParameters.snapToData&&!r.supportsSnapToData)throw new u(n,"Layer source does not support snapToData binning");if(t.binParameters.returnFullIntervalBin&&!r.supportsReturnFullIntervalBin)throw new u(n,"Layer source does not support returnFullIntervalBin binning");break;case"fixed-boundaries":if(!r.supportsFixedBoundaries)throw new u(n,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!r.supportsFixedInterval)throw new u(n,"Layer source does not support fixed-interval binning");if(t.binParameters.normalizationType&&(!r.supportsNormalization||!O(t.binParameters.normalizationType,r.supportedNormalizationTypes)))throw new u(n,"Layer source does not support normalization binning")}if(t.binParameters.stackBy&&!r.supportsStackBy)throw new u(n,"Layer source does not support stackBy binning");if(t.binParameters.splitBy&&!r.supportsSplitBy)throw new u(n,"Layer source does not support splitBy binning");if(t.binParameters.firstDayOfWeek&&!r.supportsFirstDayOfWeek)throw new u(n,"Layer source does not support firstDayOfWeek binning");const o=r?.supportedStatistics;if(t.outStatistics&&o){const s=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:d}of t.outStatistics){const y=s.get(d);if(y&&!o[y])throw new u(n,`Layer source does not support ${d} statistic type`)}}}function O(t,e){return t!=null&&!!e?.[U.toJSON(t)]}export{At as A,$t as B,Lt as C,Rt as D,Bt as E,St as F,Gt as H,zt as J,Mt as L,_t as M,kt as N,Et as O,xt as P,Y as Q,Tt as R,Ot as S,qt as T,tt as U,Ht as W,P as X,Vt as Y,Jt as a,jt as b,st as i,Ft as j,Nt as k,ot as n,it as o,c as p,Pt as q,Zt as r,Qt as t,l as u,Dt as v,Ct as z};
