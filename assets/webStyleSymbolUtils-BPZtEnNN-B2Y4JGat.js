import{m as T,e as d}from"./devEnvironmentUtils-8WtPGj6h-8bFtASy7.js";import{I as y}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{I as u,aq as h,aw as N}from"./Point-BfTTZoMu-DeJwQYfh.js";import{l as D}from"./collectionUtils-jDyktm0P-BDP2Oq99.js";import{J as A}from"./jsonUtils-C9q_FK4K-GRCbm_Pe.js";import{p as w,l as S}from"./PolygonSymbol3D-BXRHZiCQ-BjPAY2LA.js";import{k as F,C as I,A as v,D as B,M as E}from"./styleUtils-DWvicjTN-DL6_BIk4.js";import{B as M}from"./typeUtils-CXW_VpOn-BGgLp_TK.js";import"./index-B0z_nLWi.js";import"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import"./Extent-CgDMOSRD-Bod5LY6s.js";import"./Layer-DZvC7bne-D3VLDrab.js";import"./date-IqUzANpt-bLKO9IDT.js";import"./PictureMarkerSymbol-CaSh-vZk-xhjZ61bb.js";import"./Color-CERqXxxY-BuYn26eI.js";import"./mathUtils-PIGhLnI9-B1tKUlUb.js";import"./SimpleMarkerSymbol-BGAFRS9_-CVQ5NLIA.js";import"./lineMarkers-CDwLe3J6-CNUjJvs3.js";import"./SimpleFillSymbol-CDawtd9z-CWD2KI2D.js";import"./TextSymbol-hRGhyDHs-CoS7dSjf.js";import"./Font-BwmnW7d2-Dwh3xjKw.js";import"./defaults3D-C2hXSee1-CTj29-Ly.js";import"./ExtrudeSymbol3DLayer-DSc1ou2x-CsVYZCeG.js";import"./defaults-BDN9qxeN-C-EfxQM4.js";import"./aaBoundingBox-Cn49X7ge-BcYPaJ58.js";import"./mat4f64-q_b6UJoq-Dh6sWB_w.js";import"./lengthUtils-Dt1_RvOO-j3MEdmHu.js";import"./reader-DcGs6kKN-DHJfK-tm.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";import"./layerUtils-DZGhvm-W-CfyHx1TZ.js";import"./screenUtils-BitdhK1O-L0FLPAMi.js";import"./opacityUtils-DuFH0EC9-DWspTgn2.js";import"./aaBoundingRect-CjwcS2F3-ri8bmh30.js";import"./DoubleArray-DExKNiTh-CvVpHySW.js";import"./defaultsJSON-GKolV7NZ-GKolV7NZ.js";const W=["web-gltf","web","cim"];function Nt(r,t,o){const e=r.name;return e==null?Promise.reject(new y("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):r.styleName==="Esri2DPointSymbolsStyle"?x(e,t,o):v(r,t,o).then(l=>q(l,e,t,B,o))}function j(r,t){return t.items.find(o=>o.name===r)}async function q(r,t,o,e,l){const a=o?.portal!=null?o.portal:D.getDefault(),i={portal:a,url:u(r.baseUrl)},n=j(t,r.data);if(!n)throw new y("symbolstyleutils:symbol-name-not-found",`The symbol name '${t}' could not be found`,{symbolName:t});const f=l?.acceptedFormats??W,c=e(n,f);if(!c)throw new y("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${t}' does not have an accepted format (one of ${f})`,{symbolName:t});const{url:U,format:$}=c;let s=h(U,i),p=n.thumbnail?.href??null;const b=n.thumbnail?.imageData;T()&&(s=d(s)??"",p=d(p));const k={portal:a,url:u(N(s)),origin:"portal-item"};return F(s,l).then(g=>{const O=$==="cim"?I(g.data):g.data,m=A(O,k);if(m&&M(m)){if(p){const P=h(p,i);m.thumbnail=new w({url:P})}else b&&(m.thumbnail=new w({url:`data:image/png;base64,${b}`}));r.styleUrl?m.styleOrigin=new S({portal:o.portal,styleUrl:r.styleUrl,name:t}):r.styleName&&(m.styleOrigin=new S({portal:o.portal,styleName:r.styleName,name:t}))}return m})}function x(r,t,o){const e=E.replaceAll(/\{SymbolName\}/gi,r),l=t.portal!=null?t.portal:D.getDefault();return F(e,o).then(a=>{const i=I(a.data);return A(i,{portal:l,url:u(N(e)),origin:"portal-item"})})}export{q as fetchSymbolFromStyle,j as getStyleItemFromStyle,Nt as resolveWebStyleSymbol};
