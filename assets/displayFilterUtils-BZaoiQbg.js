import{m,g as N,N as s,F as a}from"./mathUtils-PIGhLnI9.js";import{r as S}from"./lengthUtils-Cm-zragw.js";function b(r,n){return{...n,filterMode:r.mode}}function y(r,n){return I(r,n).next().value??null}function E(r,n,e){const t=x(r);if(t&&(s(n,t[0])||a(e,t[1])))return"";const i=Array.from(I(r,n,e)),u=T(i,n,e)?"1=1":i.map(o=>o.where||"1=1").reduce((o,l)=>S(o,l),"");return u&&u!=="1=1"?u:""}function x(r){if(d(r)==="manual")return null;const n=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:e,maxScale:t}of r.filters)n[0]=Math.max(n[0],f(e)),n[1]=Math.min(n[1],c(t));return n}function*I(r,n,e){if(d(r)==="manual"){const t=r.filters.find(i=>i.id===r.activeFilterId);t&&(yield t)}else{typeof n=="object"&&(n=n.scale);for(const t of r.filters)h(t.minScale,t.maxScale,n,e)&&(yield t)}}function T(r,n,e){if(r.length===0)return!0;const t=f(r.at(0)?.minScale),i=c(r.at(-1)?.maxScale);if(a(t,n)||s(i,e))return!0;for(let u=0;u<r.length-1;u++){const o=r[u],l=r[u+1];if(a(f(l.minScale),c(o.maxScale)))return!0}return!1}function h(r,n,e,t){return r=f(r),e=f(e),n=c(n),!(!m(e,r)&&(t??e)>r)&&!N(n,e)&&(t===void 0||!m(t,r))}function d(r){return"mode"in r?r.mode:r.filterMode}function f(r){return r||Number.POSITIVE_INFINITY}function c(r){return r||0}export{E as c,b as i,y as u};
