import{v as re,I as L,F as le}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{b as ue,m as ce}from"./aaBoundingBox-Cn49X7ge-DORLZxoS.js";import{L as ie}from"./aaBoundingRect-CjwcS2F3-D7aII9DY.js";import{l as fe,y as ae,s as he,u as ge}from"./jsonUtils-CmpazY1u-ateEpj4Q.js";import{O as I,Y as v}from"./OptimizedFeature-CwRGZPwv-Ddclhn0A.js";import{s as me}from"./OptimizedFeatureSet-BR8EEvDc-CgsRgxJh.js";import{n as F}from"./createFeatureId-CVwTD0fV-3fKpJDrk.js";function w(e,t){return e?t?4:3:t?3:2}const $=()=>re.getLogger("esri.layers.graphics.featureConversionUtils"),_={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},de=(e,t,n,o,l,s)=>{e[n]=l,e[n+1]=s},H=(e,t,n,o,l,s)=>{e[n]=l,e[n+1]=s,e[n+2]=t[o+2]},ye=(e,t,n,o,l,s)=>{e[n]=l,e[n+1]=s,e[n+2]=t[o+3]},pe=(e,t,n,o,l,s)=>{e[n]=l,e[n+1]=s,e[n+2]=t[o+2],e[n+3]=t[o+3]};function q(e,t,n,o){if(e){if(n)return t&&o?pe:H;if(t&&o)return ye}else if(t&&o)return H;return de}function O({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function U({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function Y({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function R({scale:e,translate:t},n){return Math.round((n-t[1])/e[1])}function S({scale:e,translate:t},n,o){return n*e[o]+t[o]}function Ae(e,t,n){return e?t?n?B(e):j(e):n?A(e):z(e):null}function z(e){const t=e.coords;return{x:t[0],y:t[1]}}function J(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function j(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function we(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function A(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function Me(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function B(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function Ge(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function be(e,t,n,o){let l=z;n&&o?l=B:n?l=j:o&&(l=A);for(const s of t){const{geometry:r,attributes:u}=s,i=r!=null?l(r):null;e.push({attributes:u,geometry:i})}return e}function C(e,t){return e&&t?Ge:e?we:t?Me:J}function Ie(e,t,n,o,l){const s=C(n,o);for(const r of t){const u=r.geometry!=null?s(new I,r.geometry):null;e.push(new v(u,r.attributes,null,F(r,l)))}return e}function Te(e,t,n=C(t.z!=null,t.m!=null)){return n(e,t)}function Pe(e,t,n,o){for(const{geometry:l,attributes:s}of t)e.push({attributes:s,geometry:l!=null?K(l,n,o):null});return e}function K(e,t,n){if(e==null)return null;const o=w(t,n),l=[];for(let s=0;s<e.coords.length;s+=o){const r=[];for(let u=0;u<o;u++)r.push(e.coords[s+u]);l.push(r)}return t?n?{points:l,hasZ:t,hasM:n}:{points:l,hasZ:t}:n?{points:l,hasM:n}:{points:l}}function Ze(e,t,n,o,l){const s=w(n,o);for(const r of t){const u=r.geometry!=null?W(new I,r.geometry,s):null;e.push(new v(u,r.attributes,null,F(r,l)))}return e}function W(e,t,n=w(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const o=e.coords;let l=0;for(const s of t.points)for(let r=0;r<n;r++)o[l++]=s[r];return e}function xe(e,t,n,o){for(const{geometry:l,attributes:s}of t)e.push({attributes:s,geometry:l!=null?D(l,n,o):null});return e}function D(e,t,n){if(!e)return null;const o=w(t,n),{coords:l,lengths:s}=e,r=[];let u=0;for(const i of s){const c=[];for(let f=0;f<i;f++){const a=[];for(let h=0;h<o;h++)a.push(l[u++]);c.push(a)}r.push(c)}return t?n?{paths:r,hasZ:t,hasM:n}:{paths:r,hasZ:t}:n?{paths:r,hasM:n}:{paths:r}}function Ne(e,t,n,o,l){const s=w(n,o);for(const r of t){const u=r.geometry!=null?ee(new I,r.geometry,s):null,i=r.centroid!=null?Te(new I,r.centroid):null;e.push(new v(u,r.attributes,i,F(r,l)))}return e}function ee(e,t,n=w(t.hasZ,t.hasM)){const{lengths:o,coords:l}=e;let s=0;for(const r of t.paths){for(const u of r)for(let i=0;i<n;i++)l[s++]=u[i];o.push(r.length)}return e}function ke(e,t,n,o){for(const{geometry:l,attributes:s,centroid:r}of t){const u=l!=null?te(l,n,o):null;if(r!=null){const i=z(r);e.push({attributes:s,centroid:i,geometry:u})}else e.push({attributes:s,geometry:u})}return e}function te(e,t,n){if(!e)return null;const o=w(t,n),{coords:l,lengths:s}=e,r=[];let u=0;for(const i of s){const c=[];for(let f=0;f<i;f++){const a=[];for(let h=0;h<o;h++)a.push(l[u++]);c.push(a)}r.push(c)}return t?n?{rings:r,hasZ:t,hasM:n}:{rings:r,hasZ:t}:n?{rings:r,hasM:n}:{rings:r}}function ve(e,t,n,o,l){for(const s of t){const r=s.geometry!=null?ne(new I,s.geometry,n,o):null,u=F(s,l);s.centroid!=null?e.push(new v(r,s.attributes,J(new I,s.centroid),u)):e.push(new v(r,s.attributes,null,u))}return e}function ne(e,t,n=t.hasZ,o=t.hasM){return Ee(e,t.rings,n,o)}function Ee(e,t,n,o){const l=w(n,o),{lengths:s,coords:r}=e;let u=0;Z(e);for(const i of t){for(const c of i)for(let f=0;f<l;f++)r[u++]=c[f];s.push(i.length)}return e}const k=[],E=[];function Be(e,t,n,o,l){k[0]=e;const[s]=oe(E,k,t,n,o,l);return T(k),T(E),s}function oe(e,t,n,o,l,s){if(T(e),!n){for(const r of t){const u=F(r,s);e.push(new v(null,r.attributes,null,u))}return e}switch(n){case"esriGeometryPoint":return Ie(e,t,o,l,s);case"esriGeometryMultipoint":return Ze(e,t,o,l,s);case"esriGeometryPolyline":return Ne(e,t,o,l,s);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return ve(e,t,o,l,s);default:$().error("convertToFeatureSet:unknown-geometry",new L("internal:geometry",`Unable to parse unknown geometry type '${n}'`)),T(e)}return e}function Ce(e,t,n,o){E[0]=e,se(k,E,t,n,o);const l=k[0];return T(k),T(E),l}function He(e,t,n){if(e==null)return null;const o=new I;return"hasZ"in e&&t==null&&(t=e.hasZ),"hasM"in e&&n==null&&(n=e.hasM),fe(e)?C(t??e.z!=null,n??e.m!=null)(o,e):ae(e)?ne(o,e,t,n):he(e)?ee(o,e,w(t,n)):ge(e)?W(o,e,w(t,n)):void $().error("convertFromGeometry:unknown-geometry",new L("internal:geometry",`Unable to parse unknown geometry type '${e}'`))}function Fe(e,t,n,o){const l=e&&("coords"in e?e:e.geometry);if(l==null)return null;switch(t){case"esriGeometryPoint":{let s=z;return n&&o?s=B:n?s=j:o&&(s=A),s(l)}case"esriGeometryMultipoint":return K(l,n,o);case"esriGeometryPolyline":return D(l,n,o);case"esriGeometryPolygon":return te(l,n,o);default:return $().error("convertToGeometry:unknown-geometry",new L("internal:geometry",`Unable to parse unknown geometry type '${t}'`)),null}}function Le(e,t){for(const n of t)e.push({attributes:n.attributes});return e}function se(e,t,n,o,l){if(T(e),n==null)return Le(e,t);switch(n){case"esriGeometryPoint":return be(e,t,o,l);case"esriGeometryMultipoint":return Pe(e,t,o,l);case"esriGeometryPolyline":return xe(e,t,o,l);case"esriGeometryPolygon":return ke(e,t,o,l);default:$().error("convertToFeatureSet:unknown-geometry",new L("internal:geometry",`Unable to parse unknown geometry type '${n}'`))}return e}function Qe(e){const{spatialReference:t,transform:n,fields:o,hasM:l,hasZ:s,features:r,geometryType:u,exceededTransferLimit:i,queryGeometry:c,queryGeometryType:f}=e,a={features:se([],r,u,s,l),fields:o,geometryType:u,spatialReference:t,queryGeometry:Fe(c,f,!1,!1)};return n&&(a.transform=n),i&&(a.exceededTransferLimit=i),l&&(a.hasM=l),s&&(a.hasZ=s),a}function Xe(e,t){const n=new me,{hasM:o,hasZ:l,features:s,spatialReference:r,geometryType:u,exceededTransferLimit:i,transform:c,fields:f}=e;return f&&(n.fields=f),n.geometryType=u??null,n.spatialReference=r??null,s&&oe(n.features,s,u,l,o,t),i&&(n.exceededTransferLimit=i),o&&(n.hasM=o),l&&(n.hasZ=l),c&&(n.transform=c),n}function Je(e){const{transform:t,features:n,hasM:o,hasZ:l}=e;if(!t)return e;for(const s of n)s.geometry!=null&&X(s.geometry,s.geometry,o,l,t),s.centroid!=null&&X(s.centroid,s.centroid,o,l,t);return e.transform=null,e}function Ke(e,t){const{geometryType:n,features:o,hasM:l,hasZ:s}=t;if(!e)return t;for(let r=0;r<o.length;r++){const u=o[r],i=u.weakClone();i.geometry=new I,Q(i.geometry,u.geometry,l,s,n,e),u.centroid&&(i.centroid=new I,Q(i.centroid,u.centroid,l,s,"esriGeometryPoint",e)),o[r]=i}return t.transform=e,t}function Q(e,t,n,o,l,s,r=n,u=o){if(Z(e),!t?.coords.length)return null;const i=_[l],{coords:c,lengths:f}=t,a=w(n,o),h=w(n&&r,o&&u),m=q(n,o,r,u);if(!f.length)return m(e.coords,c,0,0,O(s,c[0]),U(s,c[1])),Z(e,a,0),e;let g,y,M,b,p=0,d=0,G=d;for(const x of f){if(x<i)continue;let P=0;d=G,M=g=O(s,c[p]),b=y=U(s,c[p+1]),m(e.coords,c,d,p,M,b),P++,p+=a,d+=h;for(let N=1;N<x;N++,p+=a)M=O(s,c[p]),b=U(s,c[p+1]),M===g&&b===y||(m(e.coords,c,d,p,M-g,b-y),d+=h,P++,g=M,y=b);P>=i&&(e.lengths.push(P),G=d)}return T(e.coords,G),e.coords.length?e:null}function We(e,t,n,o,l,s,r=n,u=o){if(Z(e),!t?.coords.length)return null;const i=_[l],{coords:c,lengths:f}=t,a=w(n,o),h=w(n&&r,o&&u),m=q(n,o,r,u);if(!f.length)return m(e.coords,c,0,0,c[0],c[1]),Z(e,a,0),e;let g=0;const y=s*s;for(const M of f){if(M<i){g+=M*a;continue}const b=e.coords.length/h,p=g,d=g+(M-1)*a;m(e.coords,c,e.coords.length,p,c[p],c[p+1]),V(e.coords,c,a,y,m,p,d),m(e.coords,c,e.coords.length,d,c[d],c[d+1]);const G=e.coords.length/h-b;G>=i?e.lengths.push(G):T(e.coords,b*h),g+=M*a}return e.coords.length?e:null}function $e(e,t,n,o){const l=e[t],s=e[t+1],r=e[n],u=e[n+1],i=e[o],c=e[o+1];let f=r,a=u,h=i-f,m=c-a;if(h!==0||m!==0){const g=((l-f)*h+(s-a)*m)/(h*h+m*m);g>1?(f=i,a=c):g>0&&(f+=h*g,a+=m*g)}return h=l-f,m=s-a,h*h+m*m}function V(e,t,n,o,l,s,r){let u,i=o,c=0;for(let f=s+n;f<r;f+=n)u=$e(t,f,s,r),u>i&&(c=f,i=u);i>o&&(c-s>n&&V(e,t,n,o,l,s,c),l(e,t,e.length,c,t[c],t[c+1]),r-c>n&&V(e,t,n,o,l,c,r))}function De(e,t,n,o){if(!t?.coords?.length)return null;const l=w(n,o);let s=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(t&&t.coords){const c=t.coords;for(let f=0;f<c.length;f+=l){const a=c[f],h=c[f+1];s=Math.min(s,a),u=Math.max(u,a),r=Math.min(r,h),i=Math.max(i,h)}}return ue(e)?ce(e,s,r,u,i):ie(s,r,u,i,e),e}function X(e,t,n,o,l){const{coords:s,lengths:r}=t,u=w(n,o);if(!s.length)return e!==t&&Z(e),e;le(l);const{originPosition:i,scale:c,translate:f}=l,a=Ue;a.originPosition=i;const h=a.scale;h[0]=c[0]??1,h[1]=-(c[1]??1),h[2]=c[2]??1,h[3]=c[3]??1;const m=a.translate;if(m[0]=f[0]??0,m[1]=f[1]??0,m[2]=f[2]??0,m[3]=f[3]??0,!r.length){for(let y=0;y<u;++y)e.coords[y]=S(a,s[y],y);return e!==t&&Z(e,u,0),e}let g=0;for(let y=0;y<r.length;y++){const M=r[y];e.lengths[y]=M;for(let d=0;d<u;++d)e.coords[g+d]=S(a,s[g+d],d);let b=e.coords[g],p=e.coords[g+1];g+=u;for(let d=1;d<M;d++,g+=u){b+=s[g]*h[0],p+=s[g+1]*h[1],e.coords[g]=b,e.coords[g+1]=p;for(let G=2;G<u;++G)e.coords[g+G]=S(a,s[g+G],G)}}return e!==t&&Z(e,s.length,r.length),e}function et(e,t,n,o,l,s){if(Z(e),e.lengths.push(...t.lengths),n===l&&o===s)for(let r=0;r<t.coords.length;r++)e.coords.push(t.coords[r]);else{const r=w(n,o),u=q(n,o,l,s),i=t.coords;for(let c=0;c<i.length;c+=r)u(e.coords,i,e.coords.length,c,i[c],i[c+1])}return e}function ze(e,t,n,o){let l=0,s=e[o*t],r=e[o*(t+1)];for(let u=1;u<n;u++){const i=s+e[o*(t+u)],c=r+e[o*(t+u)+1],f=(i-s)*(c+r);s=i,r=c,l+=f}return .5*l}function tt(e,t){const{coords:n,lengths:o}=e;let l=0,s=0;for(let r=0;r<o.length;r++){const u=o[r];s+=ze(n,l,u,t),l+=u}return Math.abs(s)}function Oe(e,t,n,o){return e*o-n*t===0&&e*n+t*o>0}function nt(e,t,n,o,l){const s=w(o,l);if(!e.lengths.length){if(e.coords.length<2)return null;const[a,h]=e.coords,m=Y(t,a),g=R(t,h);return new I([],[m,g])}const r=new I([],[0,0]),u=_[n],i=n==="esriGeometryPolygon"||n==="esriGeometryPolyline";let c=0,f=0;for(let a=0;a<e.lengths.length;a++){const h=e.lengths[a],m=f;let g=Y(t,e.coords[s*c]),y=R(t,e.coords[s*c+1]);r.coords[f++]=g,r.coords[f++]=y;let M=0,b=0,p=1;for(let d=1;d<h;d++){const G=Y(t,e.coords[s*(d+c)]),x=R(t,e.coords[s*(d+c)+1]);if(G!==g||x!==y){const P=G-g,N=x-y;i&&Oe(M,b,P,N)?(r.coords[f-2]+=P,r.coords[f-1]+=N,g+=P,y+=N):(r.coords[f++]=G,r.coords[f++]=x,g=G,y=x,M=P,b=N,p+=1)}}p<u?f=m:r.lengths.push(p),c+=h}return r.lengths.length===0?null:r}function Z(e,t=0,n=0){T(e.lengths,n),T(e.coords,t)}function T(e,t=0){e.length!==t&&(e.length=t)}const Ue={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{D as $,Ce as B,Ee as E,Fe as F,He as H,Q as J,X as K,Ae as O,Je as Q,O as R,U as S,Te as T,K as W,We as X,De as a,Xe as b,Ke as c,nt as d,tt as e,Qe as f,Be as j,ne as n,te as o,et as r,oe as t};
