import{a8 as C}from"./jsonMap-Bs3hmeCU.js";import{M as D}from"./mathUtils-PIGhLnI9.js";import{i as d,g as E}from"./aaBoundingRect-C2DMsiYR.js";import{r as b,h as P,i as v,k as F,s as q,t as z,c as U,g as G,w as H}from"./Polygon-BuPlovwL.js";import{c as I}from"./curveOperationUtils-CMBSKx7W.js";function R(n,o,e,t){if(n.type==="point")return n.x+=o,n.y+=e,n.hasZ&&t!=null,n;if(n.type==="multipoint"){const r=n.points;for(let s=0;s<r.length;s++)r[s]=k(r[s],o,e,t);return n}if(n.type==="extent")return n.xmin+=o,n.xmax+=o,n.ymin+=e,n.ymax+=e,n;const i=n.type==="polyline"?n.curvePaths??n.paths:n.curveRings??n.rings,c=F(n);for(let r=0;r<i.length;r++){const s=i[r];for(let p=0;p<s.length;p++)s[p]=K(s[p],o,e,t)}return"paths"in n?c?n.curvePaths=i:n.paths=i:c?n.curveRings=i:n.rings=i,n}function W(n,o,e,t,i){const c=n.clone();if(i){const{resolution:r}=t;R(c,o*r,-e*r)}else{const{dxMap:r,dyMap:s}=J(o,e,t);R(c,r,s)}return c}function J(n,o,e){const t=e.state.inverseTransform;return{dxMap:t[0]*n+t[2]*o,dyMap:t[1]*n+t[3]*o}}function k(n,o,e,t){return w(n,n[0]+o,n[1]+e,n[2]!=null&&t!=null?n[2]+t:void 0)}function K(n,o,e,t){const i=k(v(n),o,e,t);if(q(n))return i;if(z(n)){const[,s,p]=n.b;return{b:[i,[s[0]+o,s[1]+e],[p[0]+o,p[1]+e]]}}if(U(n)){const[,s]=n.c;return{c:[i,[s[0]+o,s[1]+e]]}}const[,c,...r]=n.a;return{a:[i,[c[0]+o,c[1]+e],...r]}}function X(n,o,e,t){if(n.type==="point"){const{x:u,y:a}=n,x=t?t[0]:u,l=t?t[1]:a,m=n.clone(),y=(u-x)*o+x,f=(a-l)*e+l;return m.x=y,m.y=f,m}if(n.type==="extent"){const{xmin:u,xmax:a,ymin:x,ymax:l}=n,m=t?t[0]:(u+a)/2,y=t?t[1]:(l+x)/2,f=n.clone();if(f.xmin=(u-m)*o+m,f.ymax=(l-y)*e+y,f.xmax=(a-m)*o+m,f.ymin=(x-y)*e+y,f.xmin>f.xmax){const h=f.xmin,M=f.xmax;f.xmin=M,f.xmax=h}if(f.ymin>f.ymax){const h=f.ymin,M=f.ymax;f.ymin=M,f.ymax=h}return f}let i=null;if(!t){i=b(n);const u=d(),a=P(u,i);if(!a)return n.clone();const[x,l,m,y]=a;t=[(x+m)/2,(l+y)/2]}const[c,r]=t;if(n.type==="multipoint"){const u=n.clone(),a=u.points;for(let x=0;x<a.length;x++){const l=a[x],[m,y]=l,f=(m-c)*o+c,h=(y-r)*e+r;a[x]=w(l,f,h,void 0)}return u.points=a,u}const s=n.clone();i??=b(n);const p=s.type==="polygon",g=p?s.curveRings??s.rings:s.curvePaths??s.paths;if(!t){const u=d(),a=P(u,g,!1,!1);if(!a)return s;t=E(a)}for(const u of g){let a=null;const x=p&&u.length>0&&C(v(u[0]),v(u.at(-1)));for(let l=0;l<u.length;l++){const m=u[l];u[l]=L(m,o,e,c,r,a),a=m}x&&(u[0]=[...v(u.at(-1))])}return s}function j(n,o,e,t,i){const[c,r,...s]=n;return[(c-t)*o+t,(r-i)*e+i,...s]}function L(n,o,e,t,i,c){if(q(n))return j(n,o,e,t,i);if(z(n)){const[T,Z,A]=n.b.map(B=>j(B,o,e,t,i));return{b:[T,Z,A]}}if(!c)return n;const r=v(c),s=U(n)?G(r,n):n,[p,g,u,a,x,l,m]=s.a,y=x??0,f=l??Math.hypot(p[0]-g[0],p[1]-g[1]),h=m??1,M=I(t,i,1,0,0,1,o,e);return H(r,{a:[[...p],[...g],u,a,y,f,h]},M)}function Y(n,o,e,t,i,c){const r=Math.sqrt((e-n)*(e-n)+(t-o)*(t-o));return Math.sqrt((i-n)*(i-n)+(c-o)*(c-o))/r}function _(n,o,e,t=!1){const i=Math.atan2(o.y-e.y,o.x-e.x)-Math.atan2(n.y-e.y,n.x-e.x),c=Math.atan2(Math.sin(i),Math.cos(i));return t?c:D(c)}function w(n,o,e,t){const i=[o,e];return n.length>2&&i.push(t??n[2]),n.length>3&&i.push(n[3]),i}export{X as M,Y as U,_ as b,J as h,W as x};
