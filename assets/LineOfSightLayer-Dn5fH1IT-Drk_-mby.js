import{bc as j,ar as O,Y as e,H as r,G as h}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{a as R}from"./Analysis-C-jU7dDl-CpOyKr7-.js";import{r as d,j as f}from"./LineOfSightAnalysisTarget-BF1yUkY_-CtzXt_k6.js";import{R as y,C as g,w as L}from"./collectionUtils-jDyktm0P-BDP2Oq99.js";import{j as c,l as v}from"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import{X as z}from"./projectionUtils-BGH_5_I3-DGwchVO8.js";import{z as C,D as E,j as _}from"./aaBoundingBox-Cn49X7ge-BcYPaJ58.js";import{c as q}from"./elevationInfoUtils-B8MpdRMP-CDlK86wO.js";import{k as A}from"./MultiOriginJSONSupport-Bd1TKmh_-BHNF5tHX.js";import{o as $}from"./Layer-DZvC7bne-D3VLDrab.js";import{C as H}from"./OperationalLayer-B6zbJ5nR-DyK_ztCk.js";import"./featureReferenceUtils-CSsVlhur-Bq31yTLX.js";import"./vec32-CewSdTn3-VRto2OOh.js";import"./Polygon-D6wEPb3W-D2MPjRU4.js";import"./Extent-CgDMOSRD-Bod5LY6s.js";import"./Point-BfTTZoMu-DeJwQYfh.js";import"./index-B0z_nLWi.js";import"./mathUtils-PIGhLnI9-B1tKUlUb.js";import"./sphere-DLQ6p7mp-DyEe1Vll.js";import"./mat4-C96X-Nn0-BrMLOLCb.js";import"./vec4f64-DPb6J-GU-C7c2DqbZ.js";import"./vector-B8ZDYGQ6-DRILJdcx.js";import"./mat4f64-q_b6UJoq-Dh6sWB_w.js";import"./quatf64-CCm9z-pX-CQ7_sSji.js";import"./vec2f64-rIxtbMRN-Kai9mK1i.js";import"./vec42-B8VM4vXb-B6OGOEI9.js";import"./resourceExtension-DOTCeiZj-C2WIbjQM.js";import"./ElevationInfo-Cw2HaA6E-CuK5hJ96.js";import"./lengthUtils-Dt1_RvOO-j3MEdmHu.js";import"./date-IqUzANpt-bLKO9IDT.js";import"./unitConversionUtils-4vB4Ezlp-DnY5MDxd.js";import"./Polyline-CoiTLswR-DTxpB2Yg.js";import"./persistable-CdoDQOTR-BklJqWTn.js";import"./MD5-MtSiOt06-jWr180Yc.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw-DH8sdIsE.js";import"./uuid-Oe6SV2kF-IYX19xBA.js";import"./reader-DcGs6kKN-DHJfK-tm.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";import"./aaBoundingRect-CjwcS2F3-ri8bmh30.js";import"./DoubleArray-DExKNiTh-CvVpHySW.js";import"./layerContainerType-CSXZNpHb-BIF7XAYP.js";import"./opacityUtils-DuFH0EC9-DWspTgn2.js";import"./intersectorUtilsConversions-pLQPEbcN-Ck-nyNYa.js";import"./HUDIntersectorResult-1xTExS7z-dL9SFL6u.js";import"./Intersector-DS9YtyQY-DMoYp6i0.js";const u=y.ofType(d);let o=class extends R{constructor(t){super(t),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles(c(()=>this._computeExtent(),t=>{t?.pending==null&&this._set("extent",t!=null?t.extent:null)},v))}get targets(){return this._get("targets")||new u}set targets(t){this._set("targets",g(t,this.targets,u))}get spatialReference(){return this.observer?.position!=null?this.observer.position.spatialReference:null}get valid(){return this.observer?.position!=null}async waitComputeExtent(){const t=this._computeExtent();return t!=null?t.pending:Promise.resolve()}_computeExtent(){const t=this.spatialReference;if(this.observer?.position==null||t==null)return null;const i=a=>q(a.position,a.elevationInfo)==="absolute-height",n=this.observer.position,m=C(n.x,n.y,n.z,n.x,n.y,n.z);for(const a of this.targets)if(a.position!=null){const l=z(a.position,t);if(l.pending!=null)return{pending:l.pending,extent:null};if(l.geometry!=null){const{x:b,y:x,z:w}=l.geometry;E(m,[b,x,w])}}const p=_(m,t);return i(this.observer)&&this.targets.every(i)||(p.zmin=void 0,p.zmax=void 0),{pending:null,extent:p}}clear(){this.observer=null,this.targets.removeAll()}equals(t){return this===t||super.equals(t)&&j(this.observer,t.observer)&&O(this.targets.toArray(),t.targets.toArray(),(i,n)=>i.equals(n))}};e([r({type:["line-of-sight"]})],o.prototype,"type",void 0),e([r({type:f,json:{read:!0,write:!0}})],o.prototype,"observer",void 0),e([r({cast:L,type:u,nonNullable:!0,json:{read:!0,write:!0}})],o.prototype,"targets",null),e([r({value:null,readOnly:!0})],o.prototype,"extent",void 0),e([r()],o.prototype,"spatialReference",null),e([r({readOnly:!0})],o.prototype,"valid",null),o=e([h("esri.analysis.LineOfSightAnalysis")],o);const S=y.ofType(d);let s=class extends H(A($)){constructor(t){super(t),this.type="line-of-sight",this.operationalLayerType="LineOfSightLayer",this.analysis=new o,this.opacity=1}initialize(){this.addHandles(c(()=>this.analysis,(t,i)=>{i!=null&&i.parent===this&&(i.parent=null),t!=null&&(t.parent=this)},v))}async load(){return this.analysis!=null&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return this.analysis?.observer}set observer(t){const{analysis:i}=this;i&&(i.observer=t)}get targets(){return this.analysis!=null?this.analysis.targets:new y}set targets(t){g(t,this.analysis?.targets)}get fullExtent(){return this.analysis!=null?this.analysis.extent:null}get spatialReference(){return this.analysis!=null?this.analysis.spatialReference:null}releaseAnalysis(t){this.analysis===t&&(this.analysis=new o)}};e([r({json:{read:!1},readOnly:!0})],s.prototype,"type",void 0),e([r({type:["LineOfSightLayer"]})],s.prototype,"operationalLayerType",void 0),e([r({type:f,json:{read:!0,write:{isRequired:!0,ignoreOrigin:!0}}})],s.prototype,"observer",null),e([r({type:S,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],s.prototype,"targets",null),e([r({type:o,nonNullable:!0,json:{read:!1,write:!1}})],s.prototype,"analysis",void 0),e([r({readOnly:!0})],s.prototype,"fullExtent",null),e([r({readOnly:!0})],s.prototype,"spatialReference",null),e([r({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],s.prototype,"opacity",void 0),e([r({type:["show","hide"]})],s.prototype,"listMode",void 0),s=e([h("esri.layers.LineOfSightLayer")],s);const zt=s;export{zt as default};
