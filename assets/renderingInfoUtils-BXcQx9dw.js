import{u as b}from"./Color-CERqXxxY.js";import{l as c}from"./ShadowCastClear.glsl-Bhq9MYuW.js";import{D as y}from"./visualVariableUtils-CQqBkcYu.js";function f(r,e){if(r.symbol!=null)return r.symbol;const n=e?.renderer;return n!=null&&n.type!=="dot-density"?n.getSymbol(r,e):null}function w(r,e){const n=f(r,e);if(n==null)return null;const a=e?.renderer,o=new c(a,n);if(a==null||!("visualVariables"in a)||!a.visualVariables)return o;const p=y(a,r,e)??[],t=["proportional","proportional","proportional"];for(const{variable:i,value:l}of p)if(l!=null||i.type==="size"&&i.useSymbolValue)switch(i.type){case"color":o.color=l?.toRgba();break;case"size":if(i.target==="outline")o.outlineSize=l;else{const u=i.axis,s=i.useSymbolValue?"symbol-value":l??"proportional";switch(u){case"width":t[0]=s;break;case"depth":t[1]=s;break;case"height":t[2]=s;break;case"width-and-depth":t[0]=t[1]=s;break;default:t[0]=t[1]=t[2]=s}}break;case"opacity":o.opacity=l;break;case"rotation":switch(i.axis){case"tilt":o.tilt=l;break;case"roll":o.roll=l;break;default:o.heading=l}}return t[0]==="proportional"&&t[1]==="proportional"&&t[2]==="proportional"||(o.size=t),o}async function d(r,e){return r.symbol!=null?r.symbol:e?.renderer?.getSymbolAsync(r,e)??null}async function g(r,e){const n=await d(r,e);if(!n)return null;const a=e?.renderer,o=new c(a,n);if(!a||!("visualVariables"in a)||!a.visualVariables)return o;const p=y(a,r,e)??[],t=["proportional","proportional","proportional"];for(const{variable:i,value:l}of p)if(i.type==="color")o.color=b.toUnitRGBA(l);else if(i.type==="size")if(i.target==="outline")o.outlineSize=l;else{const u=i.axis,s=i.useSymbolValue?"symbol-value":l;u==="width"?t[0]=s:u==="depth"?t[1]=s:u==="height"?t[2]=s:t[0]=t[1]=u==="width-and-depth"?s:t[2]=s}else i.type==="opacity"?o.opacity=l:i.type==="rotation"&&i.axis==="tilt"?o.tilt=l:i.type==="rotation"&&i.axis==="roll"?o.roll=l:i.type==="rotation"&&(o.heading=l);return(isFinite(t[0])||isFinite(t[1])||isFinite(t[2]))&&(o.size=t),o}function k(r,e=0){const n=r[e];return typeof n=="number"&&isFinite(n)?n:null}function z(r){for(let e=0;e<3;e++){const n=r[e];if(typeof n=="number")return isFinite(n)?n:0}return 0}export{k as a,g as n,w as r,z as s};
