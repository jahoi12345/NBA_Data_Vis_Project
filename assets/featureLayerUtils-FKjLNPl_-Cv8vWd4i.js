const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/editingSupport-DvBiDsO_-ChSwHhBh.js","assets/Graphic-DgGzDmqW-d1CNicxz.js","assets/jsonMap-Bs3hmeCU-Cusd0Fmz.js","assets/getPopupProvider-CmskPttI-CzUWpGwk.js","assets/collectionUtils-jDyktm0P-BDP2Oq99.js","assets/index-B0z_nLWi.js","assets/index-Cv2ko1Ob.css","assets/Point-BfTTZoMu-DeJwQYfh.js","assets/reader-DcGs6kKN-DHJfK-tm.js","assets/reactiveUtils-SO2Ko3sy-BCLX8Jdy.js","assets/Extent-CgDMOSRD-Bod5LY6s.js","assets/SimpleObservable-CvFyr0NA-DXpoMYph.js","assets/lengthUtils-Dt1_RvOO-j3MEdmHu.js","assets/date-IqUzANpt-bLKO9IDT.js","assets/Color-CERqXxxY-BuYn26eI.js","assets/mathUtils-PIGhLnI9-B1tKUlUb.js","assets/Layer-DZvC7bne-D3VLDrab.js","assets/jsonUtils-CmpazY1u-6pDLj5sx.js","assets/Polyline-CoiTLswR-DTxpB2Yg.js","assets/Polygon-D6wEPb3W-D2MPjRU4.js","assets/aaBoundingRect-CjwcS2F3-ri8bmh30.js","assets/typeUtils-DqrRcjBx-DZ6_Gsbu.js","assets/createFeatureId-CVwTD0fV-3fKpJDrk.js","assets/typeUtils-CXW_VpOn-BGgLp_TK.js","assets/lineMarkers-CDwLe3J6-CNUjJvs3.js","assets/PolygonSymbol3D-BXRHZiCQ-BjPAY2LA.js","assets/ExtrudeSymbol3DLayer-DSc1ou2x-CsVYZCeG.js","assets/screenUtils-BitdhK1O-L0FLPAMi.js","assets/opacityUtils-DuFH0EC9-DWspTgn2.js","assets/aaBoundingBox-Cn49X7ge-BcYPaJ58.js","assets/DoubleArray-DExKNiTh-CvVpHySW.js","assets/mat4f64-q_b6UJoq-Dh6sWB_w.js","assets/Font-BwmnW7d2-Dwh3xjKw.js","assets/SimpleFillSymbol-CDawtd9z-CWD2KI2D.js","assets/SimpleMarkerSymbol-BGAFRS9_-CVQ5NLIA.js","assets/PictureMarkerSymbol-CaSh-vZk-xhjZ61bb.js","assets/TextSymbol-hRGhyDHs-CoS7dSjf.js","assets/uuid-Oe6SV2kF-IYX19xBA.js","assets/normalizeUtils-85zLqeMi-C1bdAKNn.js","assets/Cyclical-BLSxUpe7-Bj8R2Yk-.js","assets/normalizeUtilsCommon-CnhQye_A-UWhaH-kt.js","assets/utils-CylVuxNi--x86XOjU.js","assets/utils-Dpg4yj1D-CeFz2JVC.js","assets/EditBusLayer-rxUbWTiY-BxA39RQ7.js","assets/infoFor3D-DhzudQro-CCYgWfsv.js","assets/layerUtils-DZGhvm-W-CfyHx1TZ.js"])))=>i.map(i=>d[i]);
import{H as B,_ as C}from"./index-B0z_nLWi.js";import{a as b,f as k}from"./Point-BfTTZoMu-DeJwQYfh.js";import{$ as z}from"./asyncUtils-w6KfWU41-HenJ0UOu.js";import{aK as $,bk as G,I as u,a7 as E,a2 as M,Y as i,H as a,K as g,G as L,L as A}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{H as U,N as H,w as V}from"./lengthUtils-Dt1_RvOO-j3MEdmHu.js";import{u as W}from"./uuid-Oe6SV2kF-IYX19xBA.js";import{d as R,l as q}from"./Field-Cm_ZejYW-CwJZmSru.js";import{d as Z}from"./featureQueryAll-BfDWA5Wx-BKksFkIA.js";import{F as T,g as Q}from"./layerUtils-DZGhvm-W-CfyHx1TZ.js";import J from"./SimpleRenderer-CEmCWePp-BJ25mYcH.js";import{n as Y}from"./UniqueValueRenderer-JPjz9Qvs-Duu1CubQ.js";import{y as K}from"./NormalizationBinParametersMixin-BK9wNkI3-BKYeOhDN.js";import{o as j,y as X}from"./Query-BlS0WPDF-jdXS_Qhy.js";import{Y as tt}from"./typeUtils-CXW_VpOn-BGgLp_TK.js";import"./reader-DcGs6kKN-DHJfK-tm.js";import"./date-IqUzANpt-bLKO9IDT.js";import"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import"./Color-CERqXxxY-BuYn26eI.js";import"./mathUtils-PIGhLnI9-B1tKUlUb.js";import"./fieldType-DVUzXtk_-tUuvnZJM.js";import"./collectionUtils-jDyktm0P-BDP2Oq99.js";import"./Extent-CgDMOSRD-Bod5LY6s.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";import"./Layer-DZvC7bne-D3VLDrab.js";import"./commonProperties-DbO613LF-CHjBvYhj.js";import"./colorRamps-DswZzxkO-BqSFavfl.js";import"./ColorStop-De5gQTjr-C1lw16u9.js";import"./opacityUtils-DuFH0EC9-DWspTgn2.js";import"./screenUtils-BitdhK1O-L0FLPAMi.js";import"./visualVariableUtils-ma4r7Z2K-Df6C3Hkh.js";import"./Graphic-DgGzDmqW-d1CNicxz.js";import"./getPopupProvider-CmskPttI-CzUWpGwk.js";import"./jsonUtils-CmpazY1u-6pDLj5sx.js";import"./Polyline-CoiTLswR-DTxpB2Yg.js";import"./Polygon-D6wEPb3W-D2MPjRU4.js";import"./aaBoundingRect-CjwcS2F3-ri8bmh30.js";import"./typeUtils-DqrRcjBx-DZ6_Gsbu.js";import"./createFeatureId-CVwTD0fV-3fKpJDrk.js";import"./PolygonSymbol3D-BXRHZiCQ-BjPAY2LA.js";import"./ExtrudeSymbol3DLayer-DSc1ou2x-CsVYZCeG.js";import"./aaBoundingBox-Cn49X7ge-BcYPaJ58.js";import"./DoubleArray-DExKNiTh-CvVpHySW.js";import"./mat4f64-q_b6UJoq-Dh6sWB_w.js";import"./lineMarkers-CDwLe3J6-CNUjJvs3.js";import"./Font-BwmnW7d2-Dwh3xjKw.js";import"./jsonUtils-C9q_FK4K-GRCbm_Pe.js";import"./PictureMarkerSymbol-CaSh-vZk-xhjZ61bb.js";import"./SimpleMarkerSymbol-BGAFRS9_-CVQ5NLIA.js";import"./SimpleFillSymbol-CDawtd9z-CWD2KI2D.js";import"./TextSymbol-hRGhyDHs-CoS7dSjf.js";import"./defaults3D-C2hXSee1-CTj29-Ly.js";import"./defaults-BDN9qxeN-C-EfxQM4.js";import"./defaultsJSON-GKolV7NZ-GKolV7NZ.js";import"./diffUtils-wTC1YzlE-DCTUTUs8.js";import"./RendererLegendOptions-ByGHYLtx-Bwoo6l33.js";import"./styleUtils-DWvicjTN-DL6_BIk4.js";const F=(t,e=F,r=e.f||(e.f=["assets/editingSupport-DvBiDsO_.js","assets/Graphic-DgGzDmqW.js","assets/jsonMap-Bs3hmeCU.js","assets/getPopupProvider-CmskPttI.js","assets/collectionUtils-jDyktm0P.js","assets/index-BzxsWNRw.js","assets/index-Cv2ko1Ob.css","assets/Point-BfTTZoMu.js","assets/reader-DcGs6kKN.js","assets/reactiveUtils-SO2Ko3sy.js","assets/Extent-CgDMOSRD.js","assets/SimpleObservable-CvFyr0NA.js","assets/lengthUtils-Dt1_RvOO.js","assets/date-IqUzANpt.js","assets/Color-CERqXxxY.js","assets/mathUtils-PIGhLnI9.js","assets/Layer-DZvC7bne.js","assets/jsonUtils-CmpazY1u.js","assets/Polyline-CoiTLswR.js","assets/Polygon-D6wEPb3W.js","assets/aaBoundingRect-CjwcS2F3.js","assets/typeUtils-DqrRcjBx.js","assets/createFeatureId-CVwTD0fV.js","assets/typeUtils-CXW_VpOn.js","assets/lineMarkers-CDwLe3J6.js","assets/PolygonSymbol3D-BXRHZiCQ.js","assets/ExtrudeSymbol3DLayer-DSc1ou2x.js","assets/screenUtils-BitdhK1O.js","assets/opacityUtils-DuFH0EC9.js","assets/aaBoundingBox-Cn49X7ge.js","assets/DoubleArray-DExKNiTh.js","assets/mat4f64-q_b6UJoq.js","assets/Font-BwmnW7d2.js","assets/SimpleFillSymbol-CDawtd9z.js","assets/SimpleMarkerSymbol-BGAFRS9_.js","assets/PictureMarkerSymbol-CaSh-vZk.js","assets/TextSymbol-hRGhyDHs.js","assets/uuid-Oe6SV2kF.js","assets/normalizeUtils-85zLqeMi.js","assets/Cyclical-BLSxUpe7.js","assets/normalizeUtilsCommon-CnhQye_A.js","assets/utils-CylVuxNi.js","assets/utils-Dpg4yj1D.js","assets/EditBusLayer-rxUbWTiY.js","assets/infoFor3D-DhzudQro.js","assets/layerUtils-DZGhvm-W.js"]))=>t.map(s=>r[s]);var I;let p=class extends E{static{I=this}constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.orderByFields=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new I(M({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};i([a({type:[String],json:{write:!0}})],p.prototype,"attachmentTypes",void 0),i([a({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],p.prototype,"attachmentsWhere",void 0),i([a({type:Boolean,json:{write:!0}})],p.prototype,"cacheHint",void 0),i([a({type:[String],json:{write:!0}})],p.prototype,"keywords",void 0),i([a({type:[String],json:{write:!0}})],p.prototype,"globalIds",void 0),i([a({json:{write:!0}})],p.prototype,"name",void 0),i([a({type:Number,json:{read:{source:"resultRecordCount"}}})],p.prototype,"num",void 0),i([a({type:[Number],json:{write:!0}})],p.prototype,"objectIds",void 0),i([a({type:[String],json:{write:!0}})],p.prototype,"orderByFields",void 0),i([a({type:Boolean,json:{default:!1,write:!0}})],p.prototype,"returnMetadata",void 0),i([a({type:[Number],json:{write:!0}})],p.prototype,"size",void 0),i([a({type:Number,json:{read:{source:"resultOffset"}}})],p.prototype,"start",void 0),i([g("start"),g("num")],p.prototype,"writeStart",null),i([a({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],p.prototype,"where",void 0),p=I=i([L("esri.rest.support.AttachmentQuery")],p),p.from=A(p);var S;let l=class extends E{static{S=this}constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(e.definitionExpression="1=1")}clone(){return new S(M({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};i([a({type:Boolean,json:{write:!0}})],l.prototype,"cacheHint",void 0),i([a({type:X,json:{write:!0}})],l.prototype,"dynamicDataSource",void 0),i([a({type:String,json:{write:!0}})],l.prototype,"gdbVersion",void 0),i([a({type:Number,json:{write:!0}})],l.prototype,"geometryPrecision",void 0),i([a({type:Date})],l.prototype,"historicMoment",void 0),i([g("historicMoment")],l.prototype,"_writeHistoricMoment",null),i([a({type:Number,json:{write:!0}})],l.prototype,"maxAllowableOffset",void 0),i([a({json:{write:!0}})],l.prototype,"objectIds",void 0),i([a({type:[String],json:{write:!0}})],l.prototype,"orderByFields",void 0),i([a({type:[String],json:{write:!0}})],l.prototype,"outFields",void 0),i([a({type:k,json:{read:{source:"outSR"},write:{target:"outSR"}}})],l.prototype,"outSpatialReference",void 0),i([a({json:{write:!0}})],l.prototype,"relationshipId",void 0),i([a({type:Number,json:{read:{source:"resultOffset"}}})],l.prototype,"start",void 0),i([g("start"),g("num")],l.prototype,"writeStart",null),i([a({type:Number,json:{read:{source:"resultRecordCount"}}})],l.prototype,"num",void 0),i([a({json:{write:!0}})],l.prototype,"returnGeometry",void 0),i([a({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],l.prototype,"returnM",void 0),i([a({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],l.prototype,"returnZ",void 0),i([a({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],l.prototype,"where",void 0),l=S=i([L("esri.rest.support.RelationshipQuery")],l),l.from=A(l);const de=Object.freeze(Object.defineProperty({__proto__:null,get default(){return l}},Symbol.toStringTag,{value:"Module"})),ye=new $({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function me(t,e,r,s){const o=await w(t);if(await x(t,e,s),!o.addAttachment)throw new u(s,"Layer source does not support addAttachment capability");return o.addAttachment(e,r)}function x(t,e,r){const{attributes:s}=e,{objectIdField:o}=t;return t.capabilities?.data?.supportsAttachment?e?s?o&&s[o]?Promise.resolve():Promise.reject(new u(r,`feature is missing the identifying attribute ${o}`)):Promise.reject(new u(r,"'attributes' are required on a feature to query attachments")):Promise.reject(new u(r,"A feature is required to add/delete/update attachments")):Promise.reject(new u(r,"this layer doesn't support attachments"))}async function he(t,e,r,s,o){const n=await w(t);if(await x(t,e,o),!n.updateAttachment)throw new u(o,"Layer source does not support updateAttachment capability");return n.updateAttachment(e,r,s)}async function fe(t,e,r){const{applyEdits:s}=await B(()=>C(()=>import("./editingSupport-DvBiDsO_-ChSwHhBh.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45])),F([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45])),o=await t.load();let n=r;return o.type==="feature"&&o.infoFor3D&&e.deleteFeatures!=null&&o.globalIdField!=null&&(n={...n,globalIdToObjectId:await nt(o,e.deleteFeatures,o.globalIdField)}),s(o,o.source,e,r)}async function we(t,e,r){const{uploadAssets:s}=await B(()=>C(()=>import("./editingSupport-DvBiDsO_-ChSwHhBh.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45])),F([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45])),o=await t.load();return s(o,o.source,e,r)}async function be(t,e,r,s){const o=await w(t);if(await x(t,e,s),!o.deleteAttachments)throw new u(s,"Layer source does not support deleteAttachments capability");return o.deleteAttachments(e,r)}async function ge(t,e,r){const s=(await t.load({signal:e?.signal})).source;if(!s.fetchRecomputedExtents)throw new u(r,"Layer source does not support fetchUpdates capability");return s.fetchRecomputedExtents(e)}async function je(t,e,r,s){e=p.from(e),await t.load();const o=t.source,n=t.capabilities;if(!n?.data?.supportsAttachment)throw new u(s,"this layer doesn't support attachments");const{attachmentTypes:d,objectIds:y,globalIds:c,num:m,size:h,start:f,where:D}=e;if(!n?.operations?.supportsQueryAttachments&&(d?.length>0||c?.length>0||h?.length>0||m||f||D))throw new u(s,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(y?.length||c?.length||D))throw new u(s,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!o.queryAttachments)throw new u(s,"Layer source does not support queryAttachments capability",e);return!n?.attachment?.supportsOrderByFields&&e.orderByFields?.length&&((e=e.clone()).orderByFields=null),o.queryAttachments(e)}async function ve(t,e,r,s){const o=await w(t);if(!o.queryObjectIds)throw new u(s,"Layer source does not support queryObjectIds capability");return o.queryObjectIds(j.from(e)??t.createQuery(),r)}async function Ie(t,e,r,s){const o=await w(t);if(!o.queryFeatureCount)throw new u(s,"Layer source does not support queryFeatureCount capability");return o.queryFeatureCount(j.from(e)??t.createQuery(),r)}async function Se(t,e,r,s){const o=await w(t);if(!o.queryExtent)throw new u(s,"Layer source does not support queryExtent capability");return o.queryExtent(j.from(e)??t.createQuery(),r)}async function Fe(t,e,r,s){const o=await w(t);if(!o.queryRelatedFeatures)throw new u(s,"Layer source does not support queryRelatedFeatures capability");return o.queryRelatedFeatures(l.from(e),r)}async function xe(t,e,r,s){const o=await w(t);if(!o.queryRelatedFeaturesCount)throw new u(s,"Layer source does not support queryRelatedFeaturesCount capability");return o.queryRelatedFeaturesCount(l.from(e),r)}async function De(t){const e=t.source;if(e?.refresh)try{const{dataChanged:r,updates:s}=await e.refresh();if(s!=null&&(t.sourceJSON={...t.sourceJSON,...s},t.read(s,{origin:"service",url:t.parsedUrl})),r)return!0}catch{}if(t.definitionExpression)try{return(await U(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function Pe(t){const e=new j;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,e.outFields=["*"],e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null;const r=t.capabilities?.query;r&&(e.compactGeometryEnabled=r.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference);const s=t.capabilities?.data;s?.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),s?.supportsM&&t.returnM!=null&&(e.returnM=t.returnM);const{timeOffset:o,timeExtent:n}=t;return e.timeExtent=o!=null&&n!=null?n.offset(-o.value,o.unit):n||null,e}function Oe(t){const{globalIdField:e,fields:r}=t;if(e)return e;if(r){for(const s of r)if(s.type==="esriFieldTypeGlobalID")return s.name}}function Be(t){const{objectIdField:e,fields:r}=t;if(e)return e;if(r){for(const s of r)if(s.type==="esriFieldTypeOID")return s.name}}function Ce(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function Ee(t,e,r,s){const o=r?.feature,n=!!t.subtypes?.length;if(n&&!r?.excludeImpliedDomains){const c=st(t,e);if(c)return c}const d=n&&et(t,o);if(d){const c=d?.domains?.[e];return c?.type==="inherited"?s:c}const y=at(t.types,t.typeIdField,o);if(y){const c=y.domains&&y.domains[e];if(c&&c?.type!=="inherited")return c}if(s)return s;if(!r?.excludeImpliedDomains){const c=rt(t,e);if(c)return c}return null}function et(t,e){const{subtypes:r,subtypeField:s}=t;if(!e?.attributes||!r?.length||!s)return null;const o=e.attributes[s];return o==null?null:r.find(n=>n.code===o)}function st(t,e){const{fieldsIndex:r,subtypeField:s}=t,{name:o,type:n}=r.get(e)??{};if(!o)return null;if((s&&r.get(s)?.name)===o&&t.subtypes?.length){const d=t.subtypes.map(y=>new R({code:_(y.code,n),name:y.name}));if(d?.length)return new q({codedValues:d})}return null}function rt(t,e){const{fieldsIndex:r}=t,{name:s,type:o}=r.get(e)??{};if(!s)return null;if(("typeIdField"in t?r.get(t.typeIdField)?.name:null)===s&&"types"in t&&t.types?.length){const n=t.types.map(d=>new R({code:_(d.id,o),name:d.name}));return new q({codedValues:n})}return null}function _(t,e){return e?H({type:e})&&typeof t=="number"?`${t}`:V({type:e})&&typeof t=="string"?Number.parseInt(t,10):t:t}async function w(t){return(await t.load()).source}async function Me(t,e){if(!b)return;const r=b.findCredential(t);if(r)return r.userId;let s;try{const o=await T(t,e);o&&(s=await b.checkSignInStatus(`${o}/sharing`))}catch{}return s?s.userId:null}async function N(t,e){if(!b||b.findCredential(t))return;let r;try{const s=await T(t,e);s&&(r=await b.checkSignInStatus(`${s}/sharing`))}catch{}if(r)try{const s=e!=null?e.signal:null;await b.getCredential(t,{signal:s})}catch{}}async function Le(t,e,r){const s=t.parsedUrl?.path;s&&t.authenticationTriggerEvent===e&&await N(s,r)}async function Ae(t){const e=t.parsedUrl?.path;e&&ot(t)&&await N(e)}function ot(t){return it(t)&&("serviceDefinitionExpression"in t&&P(t.serviceDefinitionExpression)||"definitionExpression"in t&&P(t.definitionExpression))}function it(t){return!(!Q(t)||!t.capabilities?.query.supportsCurrentUser)}function P(t){return!!t?.toLowerCase().includes("current_user")}function Re(t){return!ut(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const v=G({types:tt});function qe(t,e){if(t.defaultSymbol)return t.types?.length?new Y({defaultSymbol:v(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(r=>({id:r.id,symbol:v(r.symbol,r,e)}))}):new J({symbol:v(t.defaultSymbol,t,e)})}function Te(t){let e=t.sourceJSON?.cacheMaxAge;if(!e)return!1;const r=t.editingInfo?.lastEditDate?.getTime();return r==null||(e*=1e3,Date.now()-r<e)}async function nt(t,e,r){if(e==null)return null;const s=[],{objectIdField:o}=t;if(e.forEach(m=>{let h=null;if("attributes"in m){const{attributes:f}=m;h={globalId:f[r],objectId:f[o]!=null&&f[o]!==-1?f[o]:null}}else h={globalId:m.globalId,objectId:m.objectId!=null&&m.objectId!==-1?m.objectId:null};h.globalId!=null&&(h.objectId!=null&&h.objectId!==-1||s.push(h.globalId))}),s.length===0)return null;const n=t.createQuery();n.where=s.map(m=>`${r}='${m}'`).join(" OR "),n.returnGeometry=!1,n.outFields=[o,r],n.cacheHint=!1;const d=await z(Z(t,n));if(!d.ok)return null;const y=new Map,c=d.value.features;for(const m of c){const h=m.attributes[r],f=m.attributes[o];h!=null&&f!=null&&f!==-1&&y.set(W(h),f)}return y}function at(t,e,r){if(!e||!r||!t)return null;const s=r.getAttribute(e);return s==null?null:t.find(o=>{const{id:n}=o;return n!=null&&n.toString()===s.toString()})??null}function ut(t){return t.sourceJSON?.isMultiServicesView||lt(t)}function lt(t){return!!t.sourceJSON?.capabilities?.toLowerCase().split(",").map(e=>e.trim()).includes("map")}function _e(t,e,r){const s=e?.queryAttributeBins;if(!e?.operations?.supportsQueryBins||!s)throw new u(r,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!s.supportsAutoInterval)throw new u(r,"Layer source does not support auto-interval binning");if(t.binParameters.normalizationType&&(!s.supportsNormalization||!O(t.binParameters.normalizationType,s.supportedNormalizationTypes)))throw new u(r,"Layer source does not support normalization binning");break;case"date":if(!s.supportsDate)throw new u(r,"Layer source does not support date binning");if(t.binParameters.snapToData&&!s.supportsSnapToData)throw new u(r,"Layer source does not support snapToData binning");if(t.binParameters.returnFullIntervalBin&&!s.supportsReturnFullIntervalBin)throw new u(r,"Layer source does not support returnFullIntervalBin binning");break;case"fixed-boundaries":if(!s.supportsFixedBoundaries)throw new u(r,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!s.supportsFixedInterval)throw new u(r,"Layer source does not support fixed-interval binning");if(t.binParameters.normalizationType&&(!s.supportsNormalization||!O(t.binParameters.normalizationType,s.supportedNormalizationTypes)))throw new u(r,"Layer source does not support normalization binning")}if(t.binParameters.stackBy&&!s.supportsStackBy)throw new u(r,"Layer source does not support stackBy binning");if(t.binParameters.splitBy&&!s.supportsSplitBy)throw new u(r,"Layer source does not support splitBy binning");if(t.binParameters.firstDayOfWeek&&!s.supportsFirstDayOfWeek)throw new u(r,"Layer source does not support firstDayOfWeek binning");const o=s?.supportedStatistics;if(t.outStatistics&&o){const n=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:d}of t.outStatistics){const y=n.get(d);if(y&&!o[y])throw new u(r,`Layer source does not support ${d} statistic type`)}}}function O(t,e){return t!=null&&!!e?.[K.toJSON(t)]}export{je as A,De as B,xe as C,Se as D,Ie as E,me as F,Le as H,Me as J,ve as L,Oe as M,Ee as N,ge as O,he as P,et as Q,Pe as R,we as S,Fe as T,st as U,Ae as W,P as X,Re as Y,_e as a,de as b,ut as i,ye as j,Be as k,nt as n,at as o,p,fe as q,Te as r,qe as t,l as u,be as v,Ce as z};
