import{b as O,r as Q}from"./mathUtils-PIGhLnI9.js";import{A as l,P as f,o as A,u as I,g as h,r as z,I as J,c as M,_,s as R,H as D}from"./vec32-BF0cLBAR.js";import{n as i}from"./collectionUtils-yEu3-UXw.js";import"./vec42-Cr02Pi7P.js";import{r as S,c as b,f as E}from"./vector-B05yfH0j.js";function an(t){const n=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],r=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],u=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(n,r,u))}function fn(t,n){const r=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),u=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),o=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return A(t,r,u,o),t}function hn(t,n,r){r=r||t;const u=f(t,n);A(r,t[0]-u*n[0],t[1]-u*n[1],t[2]-u*n[2]),l(r,r)}function T(t,n,r){Math.abs(t[0])>Math.abs(t[1])?A(n,0,1,0):A(n,1,0,0),_(r,t,n),_(n,r,t),l(r,r),l(n,n)}function gn(t,n,r,u,o,e){const c=t+(n-t)*o;return c+(r+(u-r)*o-c)*e}function $n(t,n,r,u=i()){const o=z(t),e=z(n),c=f(t,n)/(o*e);if(c<.9999999999999999){const s=Math.acos(c),a=((1-r)*o+r*e)/Math.sin(s),$=a/o*Math.sin((1-r)*s),g=a/e*Math.sin(r*s);return h(y,t,$),h(d,n,g),I(u,y,d)}return J(u,t,n,r)}function ln(t,n,r,u=i(),o=i()){const e=z(t),c=z(n),s=f(t,n)/(e*c);if(s<.9999999999999999){const a=Math.acos(s),$=Math.sin(a),g=Math.sin(r*a),v=Math.sin((1-r)*a),q=(1-r)*e+r*c;{const m=q/$,p=m/c*g;h(y,t,m/e*v),h(d,n,p),I(u,y,d)}{const m=1/e*(-Math.cos((1-r)*a)*a*q+v*(-e+c));h(y,t,m);const p=1/c*(Math.cos(r*a)*a*q+g*(-e+c));h(d,n,p),I(o,y,d),h(o,o,1/$)}return o}return J(u,t,n,r),M(o,n,t),l(o,o),o}function Mn(t,n,r){t=l(y,t),n=l(d,n);const u=O(f(t,n));if(r){const o=_(V,t,n);if(f(o,r)<0)return-u}return u}function mn(t){const n=t.length;return r=>{if(r<=t[0][0])return t[0][1];if(r>=t[n-1][0])return t[n-1][1];let u=1;for(;r>t[u][0];)u++;const o=t[u-1][0],e=t[u][0],c=(e-r)/(e-o);return c*t[u-1][1]+(1-c)*t[u][1]}}function bn(t,n,r,u){M(F,n,t),M(G,r,t),_(u,F,G),l(u,u),u[3]=-f(t,u)}function qn(t,n){if(A(n,0,0,0),t.length>0){for(let r=0;r<t.length;++r)I(n,n,t[r]);h(n,n,1/t.length)}}const F=i(),G=i(),V=i(),y=i(),d=i();function K(t=U){return[t[0],t[1],t[2],t[3]]}function pn(t=U[0],n=U[1],r=U[2],u=U[3]){return L(t,n,r,u,S.get())}function W(t,n){return L(n[0],n[1],n[2],n[3],t)}function xn(t){return t}function L(t,n,r,u,o=K()){return o[0]=t,o[1]=n,o[2]=r,o[3]=u,o}function yn(t,n,r){return R(r,t),r[3]=n,r}function X(t,n,r){const u=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],o=Math.abs(u-1)>1e-5&&u>1e-12?1/Math.sqrt(u):1;return r[0]=n[0]*o,r[1]=n[1]*o,r[2]=n[2]*o,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function Y(t,n,r,u=K()){const o=r[0]-n[0],e=r[1]-n[1],c=r[2]-n[2],s=t[0]-n[0],a=t[1]-n[1],$=t[2]-n[2],g=e*$-c*a,v=c*s-o*$,q=o*a-e*s,m=g*g+v*v+q*q,p=Math.abs(m-1)>1e-5&&m>1e-12?1/Math.sqrt(m):1;return u[0]=g*p,u[1]=v*p,u[2]=q*p,u[3]=-(u[0]*t[0]+u[1]*t[1]+u[2]*t[2]),u}function N(t,n,r,u=0,o=Math.floor(r*(1/3)),e=Math.floor(r*(2/3))){if(r<3)return!1;n(P,u);let c=o,s=!1;for(;c<r-1&&!s;)n(H,c),c++,s=!D(P,H);if(!s)return!1;for(c=Math.max(c,e),s=!1;c<r&&!s;)n(x,c),c++,M(k,P,H),l(k,k),M(w,H,x),l(w,w),s=!D(P,x)&&!D(H,x)&&Math.abs(f(k,w))<Z;return s?(Y(P,H,x,t),!0):(u!==0||o!==1||e!==2)&&N(t,n,r,0,1,2)}function dn(t,n,r=!0){const u=n.length/3;return N(t,(o,e)=>A(o,n[3*e+0],n[3*e+1],n[3*e+2]),r?u-1:u)}const Z=.99619469809,P=i(),H=i(),x=i(),k=i(),w=i();function An(t,n,r){return n!==t&&W(t,n),t[3]=-f(t,r),t}function vn(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function Hn(t,n,r,u){return _(x,n,t),X(r,x,u)}function In(t,n,r,u){return B(C(t,n,M(b.get(),r,n),tn,u))}function Pn(t,n,r){return n!=null&&B(C(t,n.origin,n.direction,rn,r))}function Un(t,n,r){return B(C(t,n.origin,n.vector,0,r))}function _n(t,n,r){return B(C(t,n.origin,n.vector,1,r))}function jn(t,n){return j(t,n)>=0}function kn(t,n){const r=f(t,n.ray.direction),u=-j(t,n.ray.origin);if(u<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return u>0;if((u<0||r<0)&&!(u<0&&r<0))return!0;const o=u/r;return r>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function wn(t,n){const r=f(t,n.ray.direction),u=-j(t,n.ray.origin);if(r>-1e-6&&r<1e-6)return u>0;const o=u/r;return r>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function zn(t,n,r){const u=h(b.get(),t,-t[3]),o=nn(t,M(b.get(),n,u),b.get());return I(r,o,u),r}function Bn(t,n,r,u){const o=t,e=b.get(),c=b.get();T(o,e,c);const s=M(b.get(),r,n),a=E(e,s),$=E(c,s),g=E(o,s);return A(u,a,$,g)}function nn(t,n,r){const u=h(b.get(),t,f(t,n));return M(r,n,u),r}function Cn(t,n){return Math.abs(j(t,n))}function j(t,n){return f(t,n)+t[3]}function B(t){return t===0||t===1}function C(t,n,r,u,o){const e=f(t,r),c=j(t,n);if(e===0)return c>=0?2:3;let s=-c/e;return 1&u&&(s=Q(s,0,1)),!(4&u)&&s<0||!(8&u)&&s>1?c>=0?2:3:(I(o,n,h(o,r,s)),c>=0?0:1)}const U=[0,0,1,0],tn=12,rn=8;export{An as G,vn as H,Hn as I,In as J,Pn as K,Un as L,_n as N,jn as O,kn as P,wn as Q,zn as R,N as S,Bn as T,bn as U,Cn as W,j as X,C as Z,X as a,L as b,T as c,pn as d,yn as e,qn as f,fn as g,hn as h,mn as i,K as j,xn as k,an as m,gn as p,$n as q,Mn as v,Y as w,ln as x,W as y,dn as z};
