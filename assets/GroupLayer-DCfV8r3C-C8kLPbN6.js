const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/groupLayerUtils-CR3-hRcn-CJYLWHh9.js","assets/utils-CwBq5UrM-DFr-_PPw.js","assets/jsonMap-Bs3hmeCU-Cusd0Fmz.js","assets/originUtils-CPX8CCAY-UgTmEqwz.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw-DH8sdIsE.js","assets/collectionUtils-jDyktm0P-ArdXNs6F.js","assets/index-CTl7hdrJ.js","assets/index-Cv2ko1Ob.css","assets/Point-BfTTZoMu-BAT2Wq6O.js","assets/reader-DcGs6kKN-DHJfK-tm.js","assets/reactiveUtils-SO2Ko3sy-BCLX8Jdy.js","assets/Extent-CgDMOSRD-CU1qE5Kr.js","assets/SimpleObservable-CvFyr0NA-DXpoMYph.js","assets/PortalItem-DnxMlRVo-Dhq4alsp.js","assets/jsonContext-C00-qqFg-DK7bPg6q.js","assets/portalItemUtils-CaPNUJg6-JsqddoLx.js","assets/projectionUtils-BGH_5_I3-BySNUA-B.js","assets/Polyline-CoiTLswR-BLagWJLS.js","assets/Polygon-D6wEPb3W-CpL9Efjx.js","assets/aaBoundingRect-CjwcS2F3-D7aII9DY.js","assets/mathUtils-PIGhLnI9-B1tKUlUb.js","assets/saveUtils-BO8L-Vl8-bXGcqq8I.js","assets/Layer-DZvC7bne-m1cEC_yw.js","assets/date-IqUzANpt-bLKO9IDT.js","assets/resourceUtils-CuDSt9J_-__mGPp3j.js","assets/uuid-Oe6SV2kF-IYX19xBA.js","assets/resourceUtils-DmUA0Cus-Bw11eSoc.js"])))=>i.map(i=>d[i]);
import{H as u,_ as c}from"./index-CTl7hdrJ.js";import{aU as v,v as b,J as f,aa as _,Y as o,H as l,K as m,G as j}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{r as w}from"./CollectionFlattener-D6h2Fkvj-qnUHjb1M.js";import{A as g}from"./loadAll-BCyxerwc-DK9uHnLK.js";import{k as I}from"./MultiOriginJSONSupport-Bd1TKmh_-BHNF5tHX.js";import{j as p,l as L,t as C,i as y}from"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import{u as O}from"./reader-DcGs6kKN-DHJfK-tm.js";import{o as P}from"./Layer-DZvC7bne-m1cEC_yw.js";import{y as M}from"./BlendLayer-HE_aYHHW-CZa4IAJu.js";import{C as S}from"./OperationalLayer-B6zbJ5nR-sYdHUfAL.js";import{z as U}from"./PortalLayer-CbFNhtZ4-CCXE0v4V.js";import{s as x}from"./ScaleRangeLayer-DQr2T3Hh-Dh1UYk4i.js";import{populateGroupLayer as A}from"./layersCreator-CzVBH43O-CUZWEtWW.js";import{u as V}from"./lazyLayerLoader-3N9j85rv-B0M-59EP.js";import G from"./PortalItem-DnxMlRVo-Dhq4alsp.js";import{F as R,A as T,_ as D}from"./TablesMixin-Q80MT3nU-CFBTh0j7.js";import{e as H}from"./tagSymbols-BPcGfZon-BPcGfZon.js";import{c as $}from"./saveUtils-BO8L-Vl8-bXGcqq8I.js";import{h as E}from"./writeUtils-DEFpwIW1-D44H3UWs.js";import"./collectionUtils-jDyktm0P-ArdXNs6F.js";import"./Point-BfTTZoMu-BAT2Wq6O.js";import"./Extent-CgDMOSRD-CU1qE5Kr.js";import"./asyncUtils-w6KfWU41-HenJ0UOu.js";import"./date-IqUzANpt-bLKO9IDT.js";import"./Color-CERqXxxY-BuYn26eI.js";import"./mat4f32-Djp3mnm5-DzYG3LYB.js";import"./mat4-C96X-Nn0-Do6fKsNS.js";import"./mathUtils-PIGhLnI9-B1tKUlUb.js";import"./Polygon-D6wEPb3W-CpL9Efjx.js";import"./ElevationInfo-Cw2HaA6E-Br1RWTYu.js";import"./lengthUtils-Dt1_RvOO-bleznLOi.js";import"./unitConversionUtils-4vB4Ezlp-B0eWR3Ls.js";import"./projectionUtils-BGH_5_I3-BySNUA-B.js";import"./Polyline-CoiTLswR-BLagWJLS.js";import"./layerContainerType-CSXZNpHb-BIF7XAYP.js";import"./jsonUtils-CY6YsQMo-SliJcuqs.js";import"./screenUtils-BitdhK1O-L0FLPAMi.js";import"./opacityUtils-DuFH0EC9-DWspTgn2.js";import"./layerUtils-DZGhvm-W-DLw3QMll.js";import"./portalItemUtils-CaPNUJg6-JsqddoLx.js";import"./loadUtils-CsdEVatB-CNXJGHBW.js";import"./fetchService-Bb67nyFD-D3deLDTw.js";import"./associatedFeatureServiceUtils-BBHOCEqH-Bd4iLAWO.js";import"./portalLayers-CuUf8b9P-DkyLEy57.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";import"./aaBoundingRect-CjwcS2F3-D7aII9DY.js";import"./styleUtils-CZJC3pZm-BNE6B1Si.js";const h=(e,t=h,s=t.f||(t.f=["assets/groupLayerUtils-CR3-hRcn.js","assets/utils-CwBq5UrM.js","assets/jsonMap-Bs3hmeCU.js","assets/originUtils-CPX8CCAY.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw.js","assets/collectionUtils-jDyktm0P.js","assets/index-BzxsWNRw.js","assets/index-Cv2ko1Ob.css","assets/Point-BfTTZoMu.js","assets/reader-DcGs6kKN.js","assets/reactiveUtils-SO2Ko3sy.js","assets/Extent-CgDMOSRD.js","assets/SimpleObservable-CvFyr0NA.js","assets/PortalItem-DnxMlRVo.js","assets/jsonContext-C00-qqFg.js","assets/portalItemUtils-CaPNUJg6.js","assets/projectionUtils-BGH_5_I3.js","assets/Polyline-CoiTLswR.js","assets/Polygon-D6wEPb3W.js","assets/aaBoundingRect-CjwcS2F3.js","assets/mathUtils-PIGhLnI9.js","assets/saveUtils-BO8L-Vl8.js","assets/Layer-DZvC7bne.js","assets/date-IqUzANpt.js","assets/resourceUtils-CuDSt9J_.js","assets/uuid-Oe6SV2kF.js","assets/resourceUtils-DmUA0Cus.js"]))=>e.map(r=>s[r]);let i=class extends M(x(S(U(R(T(I(P))))))){constructor(e){super(e),this.allLayers=new w({getCollections:()=>[this.layers],getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=D(this),this.fullExtent=void 0,this.operationalLayerType="GroupLayer",this.spatialReference=void 0,this.type="group",this._debouncedSaveOperations=v(async(t,s,r)=>{const{save:a,saveAs:n}=await u(()=>c(()=>import("./groupLayerUtils-CR3-hRcn-CJYLWHh9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])),h([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]));switch(t){case 0:return a(this,s);case 1:return n(this,r,s)}})}initialize(){this._enforceVisibility(this.visibilityMode,this.visible),this.addHandles([p(()=>{let e=this.parent;for(;e&&"parent"in e&&e.parent;)e=e.parent;return e&&H in e},e=>{const t="prevent-adding-tables";this.removeHandles(t),e&&(this.tables.removeAll(),this.addHandles(C(()=>this.tables,"before-add",s=>{s.preventDefault(),b.getLogger(this).errorOnce("tables","tables in group layers in a webscene are not supported. Please move the tables from the group layer to the webscene if you want to persist them.")}),t))},L),p(()=>this.visible,this._onVisibilityChange.bind(this),y)])}destroy(){this.allLayers.destroy(),this.allTables.destroy()}get sourceIsPortalItem(){return this.portalItem&&this.originIdOf("portalItem")===7}_writeLayers(e,t,s,r){const a=[];if(!e)return a;e.forEach(n=>{const d=E(n,r.webmap?r.webmap.getLayerJSONFromResourceInfo(n):null,r);d?.layerType&&a.push(d)}),t.layers=a}set portalItem(e){this._set("portalItem",e)}readPortalItem(e,t,s){const{itemId:r,layerType:a}=t;if(a==="GroupLayer"&&r)return new G({id:r,portal:s?.portal})}writePortalItem(e,t){e?.id&&(t.itemId=e.id)}set visibilityMode(e){const t=this._get("visibilityMode")!==e;this._set("visibilityMode",e),t&&this._enforceVisibility(e,this.visible)}async beforeSave(){return $(this)}load(e){const t=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Group Layer","Scene Service","Video Service"],layerModuleTypeMap:V,populateGroupLayer:A},e).catch(s=>{if(f(s),this.sourceIsPortalItem)throw s});return this.addResolvingPromise(t),Promise.resolve(this)}async loadAll(){return g(this,e=>{e(this.layers,this.tables)})}async save(e){return this._debouncedSaveOperations(0,e)}async saveAs(e,t){return this._debouncedSaveOperations(1,t,e)}layerAdded(e){e.visible&&this.visibilityMode==="exclusive"?this._turnOffOtherLayers(e):this.visibilityMode==="inherited"&&(e.visible=this.visible),this.hasHandles(e.uid)?console.error(`Layer read to Grouplayer: uid=${e.uid}`):this.addHandles(p(()=>e.visible,t=>this._onChildVisibilityChange(e,t),y),e.uid)}layerRemoved(e){this.removeHandles(e.uid),this._enforceVisibility(this.visibilityMode,this.visible)}_turnOffOtherLayers(e){this.layers.forEach(t=>{t!==e&&(t.visible=!1)})}_enforceVisibility(e,t){if(!_(this).initialized)return;const s=this.layers;let r=s.find(a=>a.visible);switch(e){case"exclusive":s.length&&!r&&(r=s.at(0),r.visible=!0),this._turnOffOtherLayers(r);break;case"inherited":s.forEach(a=>{a.visible=t})}}_onVisibilityChange(e){this.visibilityMode==="inherited"&&this.layers.forEach(t=>{t.visible=e})}_onChildVisibilityChange(e,t){switch(this.visibilityMode){case"exclusive":t?this._turnOffOtherLayers(e):this._isAnyLayerVisible()||(e.visible=!0);break;case"inherited":e.visible=this.visible}}_isAnyLayerVisible(){return this.layers.some(e=>e.visible)}};o([l({readOnly:!0,dependsOn:[]})],i.prototype,"allLayers",void 0),o([l({readOnly:!0})],i.prototype,"allTables",void 0),o([l({json:{read:!0,write:!0}})],i.prototype,"blendMode",void 0),o([l()],i.prototype,"fullExtent",void 0),o([l({readOnly:!0})],i.prototype,"sourceIsPortalItem",null),o([l({json:{read:!1,write:{ignoreOrigin:!0}}})],i.prototype,"layers",void 0),o([m("layers")],i.prototype,"_writeLayers",null),o([l({type:["GroupLayer"]})],i.prototype,"operationalLayerType",void 0),o([l({json:{origins:{"web-map":{read:!1,write:{overridePolicy(e,t,s){return{enabled:e?.type==="Group Layer"&&s?.initiator!==this}}}},"web-scene":{read:!1,write:!1}}}})],i.prototype,"portalItem",null),o([O("web-map","portalItem",["itemId"])],i.prototype,"readPortalItem",null),o([m("web-map","portalItem",{itemId:{type:String}})],i.prototype,"writePortalItem",null),o([l()],i.prototype,"spatialReference",void 0),o([l({json:{read:!1},readOnly:!0,value:"group"})],i.prototype,"type",void 0),o([l({type:["independent","inherited","exclusive"],value:"independent",json:{write:!0,origins:{"web-map":{type:["independent","exclusive"],write:(e,t,s)=>{e!=="inherited"&&(t[s]=e)}}}}})],i.prototype,"visibilityMode",null),i=o([j("esri.layers.GroupLayer")],i);const Ge=i;export{Ge as default};
