import{i as m,_ as N,L as s,T as a}from"./mathUtils-PIGhLnI9-B1tKUlUb.js";import{i as S}from"./lengthUtils-Dt1_RvOO-bleznLOi.js";function y(t,e){return{...e,filterMode:t.mode}}function E(t,e){return I(t,e).next().value??null}function F(t,e,i){const n=T(t);if(n&&(s(e,n[0])||a(i,n[1])))return"";const u=Array.from(I(t,e,i)),o=x(u,e,i)?"1=1":u.map(r=>r.where||"1=1").reduce((r,l)=>S(r,l),"");return o&&o!=="1=1"?o:""}function T(t){if(d(t)==="manual")return null;const e=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:i,maxScale:n}of t.filters)e[0]=Math.max(e[0],f(i)),e[1]=Math.min(e[1],c(n));return e}function*I(t,e,i){if(d(t)==="manual"){const n=t.filters.find(u=>u.id===t.activeFilterId);n&&(yield n)}else{typeof e=="object"&&(e=e.scale);for(const n of t.filters)h(n.minScale,n.maxScale,e,i)&&(yield n)}}function x(t,e,i){if(t.length===0)return!0;const n=f(t.at(0)?.minScale),u=c(t.at(-1)?.maxScale);if(a(n,e)||s(u,i))return!0;for(let o=0;o<t.length-1;o++){const r=t[o],l=t[o+1];if(a(f(l.minScale),c(r.maxScale)))return!0}return!1}function h(t,e,i,n){return t=f(t),i=f(i),e=c(e),!(!m(i,t)&&(n??i)>t)&&!N(e,i)&&(n===void 0||!m(n,t))}function d(t){return"mode"in t?t.mode:t.filterMode}function f(t){return t||Number.POSITIVE_INFINITY}function c(t){return t||0}export{F as E,y as b,E as y};
