import{r as w}from"./mathUtils-PIGhLnI9.js";import{s as N,v as R,b as V,a as G}from"./sphere-CJMW5PSr.js";import{c as x,P as j,j as H,u as h,g as E,s as k,v as L,r as I,o as J}from"./vec32-CBRzfVYF.js";import{t as _,n as g}from"./collectionUtils-0LMOubEE.js";import{c as $,a as K,r as T}from"./vector-CX91PKdq.js";import{c as W,h as Y}from"./mat4-1jyq5T0I.js";import{z as Z}from"./vec42-DwKDwCwf.js";import{r as v}from"./vec4f64-DPb6J-GU.js";import{y as nn,j as f,w as b,X as tn,P as rn,Q as on}from"./plane-B9g_Fkw2.js";function P(n){return n?{origin:_(n.origin),vector:_(n.vector)}:{origin:g(),vector:g()}}function en(n,t){const r=an.get();return r.origin=n,r.vector=t,r}function wn(n,t=P()){return cn(n.origin,n.vector,t)}function cn(n,t,r=P()){return k(r.origin,n),k(r.vector,t),r}function xn(n,t,r=P()){return k(r.origin,n),x(r.vector,t,n),r}function kn(n,t){const r=x($.get(),t,n.origin),o=j(n.vector,r),a=j(n.vector,n.vector),e=w(o/a,0,1),u=x($.get(),E($.get(),n.vector,e),r);return j(u,u)}function zn(n,t,r){return un(n,t,0,1,r)}function En(n,t,r){return h(r,n.origin,E(r,n.vector,t))}function un(n,t,r,o,a){const{vector:e,origin:u}=n,s=x($.get(),t,u),A=j(e,s)/H(e);return E(a,e,w(A,r,o)),h(a,a,n.origin)}function Pn(n,t){if(C(n,en(t.origin,t.direction),!1,z)){const{tA:r,pB:o,distance2:a}=z;if(r>=0&&r<=1)return a;if(r<0)return L(n.origin,o);if(r>1)return L(h($.get(),n.origin,n.vector),o)}return null}function Xn(n,t,r){return!!C(n,t,!0,z)&&(k(r,z.pA),!0)}function C(n,t,r,o){const e=n.origin,u=h($.get(),e,n.vector),s=t.origin,A=h($.get(),s,t.vector),m=$.get(),i=$.get();if(m[0]=e[0]-s[0],m[1]=e[1]-s[1],m[2]=e[2]-s[2],i[0]=A[0]-s[0],i[1]=A[1]-s[1],i[2]=A[2]-s[2],Math.abs(i[0])<1e-6&&Math.abs(i[1])<1e-6&&Math.abs(i[2])<1e-6)return!1;const c=$.get();if(c[0]=u[0]-e[0],c[1]=u[1]-e[1],c[2]=u[2]-e[2],Math.abs(c[0])<1e-6&&Math.abs(c[1])<1e-6&&Math.abs(c[2])<1e-6)return!1;const S=m[0]*i[0]+m[1]*i[1]+m[2]*i[2],B=i[0]*c[0]+i[1]*c[1]+i[2]*c[2],Q=m[0]*c[0]+m[1]*c[1]+m[2]*c[2],q=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],U=(c[0]*c[0]+c[1]*c[1]+c[2]*c[2])*q-B*B;if(Math.abs(U)<1e-6)return!1;let p=(S*B-Q*q)/U,l=(S+B*p)/q;r&&(p=w(p,0,1),l=w(l,0,1));const y=$.get(),M=$.get();return y[0]=e[0]+p*c[0],y[1]=e[1]+p*c[1],y[2]=e[2]+p*c[2],M[0]=s[0]+l*i[0],M[1]=s[1]+l*i[1],M[2]=s[2]+l*i[2],o.tA=p,o.tB=l,o.pA=y,o.pB=M,o.distance2=L(y,M),!0}const z={tA:0,tB:0,pA:g(),pB:g(),distance2:0},an=new N(()=>P());function X(n){return n?{ray:V(n.ray),c0:n.c0,c1:n.c1}:{ray:V(),c0:0,c1:Number.MAX_VALUE}}function sn(n,t=X()){return R(n,t.ray),t.c0=0,t.c1=Number.MAX_VALUE,t}function fn(n,t,r=X()){const o=I(n.vector);return G(n.origin,t,r.ray),r.c0=0,r.c1=o,r}function qn(n,t){return D(n,n.c0,t)}function Ln(n,t){return D(n,n.c1,t)}function D(n,t,r){return h(r,n.ray.origin,E(r,n.ray.direction,t))}new N(()=>X());function Nn(n){return n?[f(n[0]),f(n[1]),f(n[2]),f(n[3]),f(n[4]),f(n[5])]:[f(),f(),f(),f(),f(),f()]}function gn(){return[g(),g(),g(),g(),g(),g(),g(),g()]}function Sn(n,t){for(let r=0;r<d;r++)nn(n[r],t[r]);return n}function Un(n,t,r,o=pn){const a=W(K.get(),t,n);Y(a,a);for(let e=0;e<mn;++e){const u=Z(T.get(),vn[e],a);J(o[e],u[0]/u[3],u[1]/u[3],u[2]/u[3])}$n(r,o)}function $n(n,t){b(t[4],t[0],t[3],n[0]),b(t[1],t[5],t[6],n[1]),b(t[4],t[5],t[1],n[2]),b(t[3],t[2],t[6],n[3]),b(t[0],t[1],t[2],n[4]),b(t[5],t[4],t[7],n[5])}function Vn(n,t){for(let r=0;r<d;r++){const o=n[r];if(o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]>=t[3])return!1}return!0}function _n(n,t){return F(n,sn(t,O.get()))}function Cn(n,t){for(let r=0;r<d;r++){const o=n[r];if(!on(o,t))return!1}return!0}function Dn(n,t,r){return F(n,fn(t,r,O.get()))}function Fn(n,t){for(let r=0;r<d;r++)if(tn(n[r],t)>0)return!1;return!0}function F(n,t){for(let r=0;r<d;r++)if(!rn(n[r],t))return!1;return!0}const On={bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,3,2,6]},d=6,mn=8,vn=[v(-1,-1,-1,1),v(1,-1,-1,1),v(1,1,-1,1),v(-1,1,-1,1),v(-1,-1,1,1),v(1,-1,1,1),v(1,1,1,1),v(-1,1,1,1)],O=new N(X),pn=gn();export{On as A,Xn as B,kn as M,_n as O,Cn as R,$n as S,X as a,xn as b,Ln as c,Un as d,Dn as e,Pn as f,wn as g,Nn as h,cn as i,zn as j,gn as k,En as l,en as m,un as n,d as o,qn as p,Fn as q,P as v,Vn as w,Sn as x,sn as y};
