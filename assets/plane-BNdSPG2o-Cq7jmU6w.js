import{A as V,s as W}from"./mathUtils-PIGhLnI9-B1tKUlUb.js";import{A as i,x as P,O as B,k as h,J,l,c as C,$,L as v,I as X,F as z}from"./vec32-CewSdTn3-DHOFKD0R.js";import{t as f}from"./collectionUtils-jDyktm0P-ArdXNs6F.js";import"./vec42-B8VM4vXb-BnA9MysM.js";import{B as Y,z as p,F as O}from"./vector-B8ZDYGQ6-B1uNywRb.js";function un(t){const n=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],s=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],c=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(n,s,c))}function fn(t,n){const s=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),c=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),r=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return v(t,s,c,r),t}function hn(t,n,s){s=s||t;const c=i(t,n);v(s,t[0]-c*n[0],t[1]-c*n[1],t[2]-c*n[2]),l(s,s)}function Z(t,n,s){Math.abs(t[0])>Math.abs(t[1])?v(n,0,1,0):v(n,1,0,0),z(s,t,n),z(n,s,t),l(s,s),l(n,n)}function Mn(t,n,s,c,r,e){const o=t+(n-t)*r;return o+(s+(c-s)*r-o)*e}function gn(t,n,s,c=f()){const r=P(t),e=P(n),o=i(t,n)/(r*e);if(o<.9999999999999999){const a=Math.acos(o),u=((1-s)*r+s*e)/Math.sin(a),g=u/r*Math.sin((1-s)*a),M=u/e*Math.sin(s*a);return h(y,t,g),h(d,n,M),B(c,y,d)}return J(c,t,n,s)}function ln(t,n,s,c=f(),r=f()){const e=P(t),o=P(n),a=i(t,n)/(e*o);if(a<.9999999999999999){const u=Math.acos(a),g=Math.sin(u),M=Math.sin(s*u),k=Math.sin((1-s)*u),q=(1-s)*e+s*o;{const m=q/g,b=m/o*M;h(y,t,m/e*k),h(d,n,b),B(c,y,d)}{const m=1/e*(-Math.cos((1-s)*u)*u*q+k*(-e+o));h(y,t,m);const b=1/o*(Math.cos(s*u)*u*q+M*(-e+o));h(d,n,b),B(r,y,d),h(r,r,1/g)}return r}return J(c,t,n,s),$(r,n,t),l(r,r),r}function $n(t,n,s){t=l(y,t),n=l(d,n);const c=V(i(t,n));if(s){const r=z(D,t,n);if(i(r,s)<0)return-c}return c}function mn(t){const n=t.length;return s=>{if(s<=t[0][0])return t[0][1];if(s>=t[n-1][0])return t[n-1][1];let c=1;for(;s>t[c][0];)c++;const r=t[c-1][0],e=t[c][0],o=(e-s)/(e-r);return o*t[c-1][1]+(1-o)*t[c][1]}}function pn(t,n,s,c){$(_,n,t),$(G,s,t),z(c,_,G),l(c,c),c[3]=-i(t,c)}function qn(t,n){if(v(n,0,0,0),t.length>0){for(let s=0;s<t.length;++s)B(n,n,t[s]);h(n,n,1/t.length)}}const _=f(),G=f(),D=f(),y=f(),d=f();function K(t=w){return[t[0],t[1],t[2],t[3]]}function bn(t=w[0],n=w[1],s=w[2],c=w[3]){return N(t,n,s,c,Y.get())}function E(t,n){return N(n[0],n[1],n[2],n[3],t)}function xn(t){return t}function N(t,n,s,c,r=K()){return r[0]=t,r[1]=n,r[2]=s,r[3]=c,r}function yn(t,n,s){return X(s,t),s[3]=n,s}function Q(t,n,s){const c=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],r=Math.abs(c-1)>1e-5&&c>1e-12?1/Math.sqrt(c):1;return s[0]=n[0]*r,s[1]=n[1]*r,s[2]=n[2]*r,s[3]=-(s[0]*t[0]+s[1]*t[1]+s[2]*t[2]),s}function R(t,n,s,c=K()){const r=s[0]-n[0],e=s[1]-n[1],o=s[2]-n[2],a=t[0]-n[0],u=t[1]-n[1],g=t[2]-n[2],M=e*g-o*u,k=o*a-r*g,q=r*u-e*a,m=M*M+k*k+q*q,b=Math.abs(m-1)>1e-5&&m>1e-12?1/Math.sqrt(m):1;return c[0]=M*b,c[1]=k*b,c[2]=q*b,c[3]=-(c[0]*t[0]+c[1]*t[1]+c[2]*t[2]),c}function T(t,n,s,c=0,r=Math.floor(s*(1/3)),e=Math.floor(s*(2/3))){if(s<3)return!1;n(F,c);let o=r,a=!1;for(;o<s-1&&!a;)n(A,o),o++,a=!C(F,A);if(!a)return!1;for(o=Math.max(o,e),a=!1;o<s&&!a;)n(x,o),o++,$(I,F,A),l(I,I),$(L,A,x),l(L,L),a=!C(F,x)&&!C(A,x)&&Math.abs(i(I,L))<S;return a?(R(F,A,x,t),!0):(c!==0||r!==1||e!==2)&&T(t,n,s,0,1,2)}function dn(t,n,s=!0){const c=n.length/3;return T(t,(r,e)=>v(r,n[3*e+0],n[3*e+1],n[3*e+2]),s?c-1:c)}const S=.99619469809,F=f(),A=f(),x=f(),I=f(),L=f();function vn(t,n,s){return n!==t&&E(t,n),t[3]=-i(t,s),t}function kn(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function An(t,n,s,c){return z(x,n,t),Q(s,x,c)}function Bn(t,n,s,c){return U(j(t,n,$(p.get(),s,n),tn,c))}function Fn(t,n,s){return n!=null&&U(j(t,n.origin,n.direction,sn,s))}function wn(t,n,s){return U(j(t,n.origin,n.vector,0,s))}function zn(t,n,s){return U(j(t,n.origin,n.vector,1,s))}function Hn(t,n){return H(t,n)>=0}function In(t,n){const s=i(t,n.ray.direction),c=-H(t,n.ray.origin);if(c<0&&s>=0)return!1;if(s>-1e-6&&s<1e-6)return c>0;if((c<0||s<0)&&!(c<0&&s<0))return!0;const r=c/s;return s>0?r<n.c1&&(n.c1=r):r>n.c0&&(n.c0=r),n.c0<=n.c1}function Ln(t,n){const s=i(t,n.ray.direction),c=-H(t,n.ray.origin);if(s>-1e-6&&s<1e-6)return c>0;const r=c/s;return s>0?r<n.c1&&(n.c1=r):r>n.c0&&(n.c0=r),n.c0<=n.c1}function Pn(t,n,s){const c=h(p.get(),t,-t[3]),r=nn(t,$(p.get(),n,c),p.get());return B(s,r,c),s}function Un(t,n,s,c){const r=t,e=p.get(),o=p.get();Z(r,e,o);const a=$(p.get(),s,n),u=O(e,a),g=O(o,a),M=O(r,a);return v(c,u,g,M)}function nn(t,n,s){const c=h(p.get(),t,i(t,n));return $(s,n,c),s}function jn(t,n){return Math.abs(H(t,n))}function H(t,n){return i(t,n)+t[3]}function U(t){return t===0||t===1}function j(t,n,s,c,r){const e=i(t,s),o=H(t,n);if(e===0)return o>=0?2:3;let a=-o/e;return 1&c&&(a=W(a,0,1)),!(4&c)&&a<0||!(8&c)&&a>1?o>=0?2:3:(B(r,n,h(r,s,a)),o>=0?0:1)}const w=[0,0,1,0],tn=12,sn=8;export{gn as $,vn as A,Un as B,j as C,An as H,Bn as I,K,N as L,$n as M,T as N,Fn as P,Z as T,wn as U,E as W,Q as X,R as Y,zn as _,un as a,Hn as b,jn as c,pn as d,dn as e,fn as f,Mn as g,hn as h,H as j,In as k,ln as l,mn as m,bn as p,qn as q,kn as v,Ln as w,xn as x,yn as y,Pn as z};
