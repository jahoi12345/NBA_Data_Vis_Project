const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ElevationQuery-DzlYa4L4-DkUTW9Ak.js","assets/asyncUtils-w6KfWU41-HenJ0UOu.js","assets/jsonMap-Bs3hmeCU-Cusd0Fmz.js","assets/Point-BfTTZoMu-DeJwQYfh.js","assets/index-B0z_nLWi.js","assets/index-Cv2ko1Ob.css","assets/reader-DcGs6kKN-DHJfK-tm.js","assets/projectionUtils-BGH_5_I3-DGwchVO8.js","assets/SimpleObservable-CvFyr0NA-DXpoMYph.js","assets/collectionUtils-jDyktm0P-BDP2Oq99.js","assets/reactiveUtils-SO2Ko3sy-BCLX8Jdy.js","assets/Extent-CgDMOSRD-Bod5LY6s.js","assets/Polyline-CoiTLswR-DTxpB2Yg.js","assets/Polygon-D6wEPb3W-D2MPjRU4.js","assets/aaBoundingRect-CjwcS2F3-ri8bmh30.js","assets/mathUtils-PIGhLnI9-B1tKUlUb.js","assets/TileKey-CXWFOqOI-Lra6v-mg.js","assets/layersCreator-CzVBH43O-By2kCmFf.js","assets/loadUtils-CsdEVatB-CJ6RroRL.js","assets/fetchService-Bb67nyFD-BmjCOSQ9.js","assets/layerUtils-DZGhvm-W-CfyHx1TZ.js","assets/Layer-DZvC7bne-D3VLDrab.js","assets/date-IqUzANpt-bLKO9IDT.js","assets/associatedFeatureServiceUtils-BBHOCEqH-B0C_-24D.js","assets/PortalItem-DnxMlRVo-CI4Ns2_M.js","assets/lazyLayerLoader-3N9j85rv-KxWzY4-B.js","assets/portalLayers-CuUf8b9P-CGHBSFCH.js","assets/portalItemUtils-CaPNUJg6-CXDHI5LA.js","assets/styleUtils-CZJC3pZm-BNE6B1Si.js"])))=>i.map(i=>d[i]);
import{H as I,_ as A}from"./index-B0z_nLWi.js";import{c as T,aE as G,w as K,v as j,aF as V,I as Z,o as O,a2 as P,L as q,i as Y,Y as r,H as a,G as y,K as Q,aG as $,a7 as M}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{a as U,F as g}from"./Basemap-CL_uaRmk-O3l-dbYk.js";import{B as X,F as H}from"./Color-CERqXxxY-BuYn26eI.js";import{R as L,C as ee,k as te,Y as se,b as J}from"./collectionUtils-jDyktm0P-BDP2Oq99.js";import{r as E}from"./CollectionFlattener-D6h2Fkvj-WVl2BXw-.js";import{A as re}from"./loadAll-BCyxerwc-B4Lp8wGC.js";import{m as oe,o as ae}from"./opacityUtils-DuFH0EC9-DWspTgn2.js";import{s as ie,j as ne,l as le,J as pe}from"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import{bk as de,aq as ue,H as ye,s as R}from"./Point-BfTTZoMu-DeJwQYfh.js";import{r as ce}from"./uuid-Oe6SV2kF-IYX19xBA.js";import{u as me}from"./reader-DcGs6kKN-DHJfK-tm.js";import{L as he}from"./persistable-CdoDQOTR-BklJqWTn.js";import{O as h}from"./PolygonCollection-HNNpnBH7-5UHgGprq.js";import{o as fe}from"./Layer-DZvC7bne-D3VLDrab.js";import{G as ge,J as ve}from"./layerUtils-DZGhvm-W-CfyHx1TZ.js";import"./mat4f32-Djp3mnm5-DzYG3LYB.js";import"./mat4-C96X-Nn0-BrMLOLCb.js";import{F as be,A as we,_ as je}from"./TablesMixin-Q80MT3nU-CBB9B-b6.js";import"./PortalItem-DnxMlRVo-CI4Ns2_M.js";import"./Extent-CgDMOSRD-Bod5LY6s.js";import"./intl-DRFqUect-DPhFaHB2.js";import"./date-IqUzANpt-bLKO9IDT.js";import"./writeUtils-DEFpwIW1-AHZYPaSV.js";import"./mathUtils-PIGhLnI9-B1tKUlUb.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";import"./asyncUtils-w6KfWU41-HenJ0UOu.js";import"./MD5-MtSiOt06-jWr180Yc.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw-DH8sdIsE.js";import"./resourceExtension-DOTCeiZj-C2WIbjQM.js";import"./Polygon-D6wEPb3W-D2MPjRU4.js";import"./aaBoundingRect-CjwcS2F3-ri8bmh30.js";import"./projectionUtils-BGH_5_I3-DGwchVO8.js";import"./Polyline-CoiTLswR-DTxpB2Yg.js";const v=(e,t=v,s=t.f||(t.f=["assets/ElevationQuery-DzlYa4L4.js","assets/asyncUtils-w6KfWU41.js","assets/jsonMap-Bs3hmeCU.js","assets/Point-BfTTZoMu.js","assets/reader-DcGs6kKN.js","assets/index-BzxsWNRw.js","assets/index-Cv2ko1Ob.css","assets/projectionUtils-BGH_5_I3.js","assets/SimpleObservable-CvFyr0NA.js","assets/collectionUtils-jDyktm0P.js","assets/reactiveUtils-SO2Ko3sy.js","assets/Extent-CgDMOSRD.js","assets/Polyline-CoiTLswR.js","assets/Polygon-D6wEPb3W.js","assets/aaBoundingRect-CjwcS2F3.js","assets/mathUtils-PIGhLnI9.js","assets/TileKey-CXWFOqOI.js","assets/layersCreator-CzVBH43O.js","assets/loadUtils-CsdEVatB.js","assets/fetchService-Bb67nyFD.js","assets/layerUtils-DZGhvm-W.js","assets/Layer-DZvC7bne.js","assets/date-IqUzANpt.js","assets/associatedFeatureServiceUtils-BBHOCEqH.js","assets/PortalItem-DnxMlRVo.js","assets/lazyLayerLoader-3N9j85rv.js","assets/portalLayers-CuUf8b9P.js","assets/portalItemUtils-CaPNUJg6.js","assets/styleUtils-CZJC3pZm.js"]))=>e.map(o=>s[o]),f=new WeakMap;function k(e){return!e.destroyed&&(f.has(e)||e.addHandles([ne(()=>{const{parent:t}=e;return!!(t&&t instanceof fe)&&(t.type==="catalog-dynamic-group"||k(t))},t=>f.set(e,t),le),Y(()=>f.delete(e))]),f.get(e))}var N;let b=N=class extends M{constructor(e){super(e),this.type="none"}clone(){return new N({type:this.type})}};r([X({none:"none",stayAbove:"stay-above"}),a({json:{write:{isRequired:!0}}})],b.prototype,"type",void 0),b=N=r([y("esri.ground.NavigationConstraint")],b);const W=Symbol("GroundInstance");function ut(e){return e!=null&&typeof e=="object"&&W in e}var x,F;let i=F=class extends G(te){static{x=W}constructor(e){super(e),this[x]=!0,this.parent=null,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new L;const t=o=>{const{parent:l}=o;l&&l!==this&&"remove"in l&&l.remove?.(o),o.parent=this,o.type!=="elevation"&&o.type!=="base-elevation"&&j.getLogger(this).error(`Layer '${o.title}, id:${o.id}' of type '${o.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},s=o=>{o.parent=null};this.addHandles([this.layers.on("after-add",o=>t(o.item)),this.layers.on("after-remove",o=>s(o.item))]),this.allLayers=new E({getCollections:()=>[this.layers,this.parent?.basemap?.groundLayers]})}removeChildLayer(e){this.layers.remove(e)}initialize(){this.when().catch(e=>{K(e)||j.getLogger(this).error("#load()","Failed to load ground",e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}get integratedMeshGround(){const e=this.parent?.basemap?.groundLayers.at(0);return e?.replacesTerrain?e:null}destroy(){const e=this.layers.removeAll();for(const t of e)T(t);this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}get loaded(){return super.loaded}get layers(){return this._get("layers")}set layers(e){this._set("layers",ee(e,this._get("layers")))}writeLayers(e,t,s,o){const l=[];e&&(o={...o,layerContainerType:"ground"},e.forEach(p=>{if("write"in p){const u={};V(p)().write(u,o)&&l.push(u)}else o?.messages&&o.messages.push(new Z("layer:unsupported",`Layers (${p.title}, ${p.id}) of type '${p.declaredClass}' cannot be persisted in the ground`,{layer:p}))})),t.layers=l}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return re(this,e=>{e(this.layers)})}async queryElevation(e,t){await this.load({signal:t?.signal});const{queryAll:s}=await I(()=>A(()=>import("./ElevationQuery-DzlYa4L4-DkUTW9Ak.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(o=>o.E),v([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]));return O(t),s(this.layers.filter(B).toArray(),e,t)}async createElevationSampler(e,t){await this.load({signal:t?.signal});const{createSampler:s}=await I(()=>A(()=>import("./ElevationQuery-DzlYa4L4-DkUTW9Ak.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(o=>o.E),v([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]));return O(t),s(this.layers.filter(B).toArray(),e,t)}clone(){const e={opacity:this.opacity,surfaceColor:P(this.surfaceColor),navigationConstraint:P(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new F({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){const t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve()}async _loadLayersFromJSON(e,t,s){const o=t?.origin||"web-scene",l=t?.portal||null,p=t?.url||null,{populateOperationalLayers:u}=await I(async()=>{const{populateOperationalLayers:C}=await A(()=>import("./layersCreator-CzVBH43O-By2kCmFf.js"),__vite__mapDeps([17,9,4,5,2,3,6,10,11,8,18,19,20,21,22,23,24,25,26,27,7,12,13,14,15,28,1]));return{populateOperationalLayers:C}},v([17,9,2,5,6,3,4,10,11,8,18,19,20,21,22,23,24,25,26,27,7,12,13,14,15,28,1]));O(s);const c=[];if(e.layers&&Array.isArray(e.layers)){const C={context:{origin:o,url:p,portal:l,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};c.push(u(this.layers,e.layers,C))}await Promise.allSettled(c)}};function B(e){return e&&"createElevationSampler"in e}r([a()],i.prototype,"parent",void 0),r([a()],i.prototype,"integratedMeshGround",null),r([a({json:{read:!1,write:{isRequired:!0}}})],i.prototype,"layers",null),r([a()],i.prototype,"allLayers",void 0),r([Q("layers")],i.prototype,"writeLayers",null),r([a({readOnly:!0})],i.prototype,"resourceInfo",void 0),r([a({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:$,read:{reader:oe,source:"transparency"},write:{writer:(e,t)=>{t.transparency=ae(e)},target:"transparency"}}})],i.prototype,"opacity",void 0),r([a({type:H,json:{type:[$],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],i.prototype,"surfaceColor",void 0),r([a({type:b,json:{write:!0}})],i.prototype,"navigationConstraint",void 0),i=F=r([y("esri.Ground")],i);const _=i;let w=class extends se(M){constructor(e){super(e),this.color=null}};r([a({type:H,json:{type:[$],write:!0}})],w.prototype,"color",void 0),w=r([y("esri.effects.FocusAreaOutline")],w);const Le=w;let d=class extends G(J){constructor(e){super(e),this.id=`focusarea-${ce()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new h}readGeometries(e,t,s){Array.isArray(e)?this.geometries=h.fromJSON(e,s):s.origin!=="web-scene"&&s.origin!=="portal-item"||s.hooks?.onAfterLoad?.(()=>this._loadGeometries(ue(e,s),s))}async _loadGeometries(e,t){const s=await ye(e,{responseType:"json"});this.geometries=h.fromJSON(s.data,t)}};r([a({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),a()],d.prototype,"id",void 0),r([a({type:String,json:{write:!0}})],d.prototype,"title",void 0),r([a({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],d.prototype,"enabled",void 0),r([a({type:Le,json:{write:!0}})],d.prototype,"outline",void 0),r([a({type:h,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:e=>new h(e.items.map(t=>t.clone()))}),he({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],d.prototype,"geometries",void 0),r([me(["web-scene","portal-item","service"],"geometries")],d.prototype,"readGeometries",null),d=r([y("esri.effects.FocusArea")],d);const _e=d;let m=class extends G(J){constructor(e){super(e),this.areas=new L,this.style="bright"}};r([a({type:L.ofType(_e),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:e=>new L(e.items.map(t=>t.clone()))})],m.prototype,"areas",void 0),r([a({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],m.prototype,"style",void 0),m=r([y("esri.effects.FocusAreas")],m);const z=m;function Ce(e){return typeof e=="object"&&e!=null&&"loaded"in e&&e.loaded===!0&&"type"in e}function Ie(e){return!(!Ce(e)||!ge(e)?.operations?.supportsEditing||"editingEnabled"in e&&!ve(e)||k(e))}const S=()=>j.getLogger("esri.support.basemapUtils");function Ae(){return{}}function Oe(e){for(const t in e){const s=e[t];s&&!s.destroyed&&s.destroy(),delete e[t]}}function Se(e,t){let s;if(typeof e=="string"){const o=e in U,l=!o&&e.includes("/");if(!o&&!l){if(de())S().warn(`Unable to find basemap definition for: ${e}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const p=Object.entries(U).filter(([u,c])=>c.classic||c.is3d).map(([u])=>`"${u}"`).sort().join(", ");S().warn(`Unable to find basemap definition for: ${e}. Try one of these: ${p}`)}return null}t&&(s=t[e]),s||(s=o?g.fromId(e):new g({style:{id:e}}),t&&(t[e]=s))}else s=q(g,e);return s?.destroyed&&(S().warn("The provided basemap is already destroyed",{basemap:s}),s=null),s}const D={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function Te(e){let t=null;if(typeof e=="string")if(e in D){const s=D[e];t=new _({resourceInfo:{data:{layers:[s]}}})}else j.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`);else t=q(_,e);return t}let n=class extends be(we(pe)){constructor(e){super(e),this.allLayers=new E({getCollections:()=>[this.basemap?.baseLayers,this.basemap?.groundLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:t=>"layers"in t?t.layers:null}),this.focusAreas=new z,this.allTables=je(this),this.basemap=null,this.editableLayers=new E({getCollections:()=>[this.allLayers],itemFilterFunction:Ie}),this.ground=new _,this._basemapCache=Ae(),this.addHandles(ie(()=>this.ground,(t,s)=>{s?.parent===this&&(s.parent=null),t.parent=this},{sync:!0}))}destroy(){Oe(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=T(this.basemap),T(this.ground),this._set("ground",null)}castBasemap(e){return Se(e,this._basemapCache)}castGround(e){return Te(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};r([a({readOnly:!0,dependsOn:[]})],n.prototype,"allLayers",void 0),r([a({type:z,nonNullable:!0,json:{write:{overridePolicy:e=>({enabled:e.areas.length>0,ignoreOrigin:!0})}}})],n.prototype,"focusAreas",void 0),r([a({readOnly:!0})],n.prototype,"allTables",void 0),r([a({type:g,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],n.prototype,"basemap",void 0),r([R("basemap")],n.prototype,"castBasemap",null),r([a({readOnly:!0})],n.prototype,"editableLayers",void 0),r([a({type:_,nonNullable:!0})],n.prototype,"ground",void 0),r([R("ground")],n.prototype,"castGround",null),r([a()],n.prototype,"undoRedo",void 0),n=r([y("esri.Map")],n);const $e=n,yt=Object.freeze(Object.defineProperty({__proto__:null,default:$e},Symbol.toStringTag,{value:"Module"}));export{$e as L,yt as M,Ie as e,ut as o};
