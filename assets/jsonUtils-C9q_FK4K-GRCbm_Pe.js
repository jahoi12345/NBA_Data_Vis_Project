import{I as m,bh as S}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{U as c}from"./layerUtils-DZGhvm-W-CfyHx1TZ.js";import{Q as C,B as u,h as b,f as w,g as I,c as h,i as d}from"./typeUtils-CXW_VpOn-BGgLp_TK.js";import{a as M}from"./PictureMarkerSymbol-CaSh-vZk-xhjZ61bb.js";import{g as x}from"./PolygonSymbol3D-BXRHZiCQ-BjPAY2LA.js";import{o as $}from"./SimpleFillSymbol-CDawtd9z-CWD2KI2D.js";import{m as k,u as D}from"./SimpleMarkerSymbol-BGAFRS9_-CVQ5NLIA.js";import{t as L}from"./TextSymbol-hRGhyDHs-CoS7dSjf.js";import{O as v,M as U}from"./defaults3D-C2hXSee1-CTj29-Ly.js";const p="#useCIMFallbackSymbology()",i={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function F(o,r=i){if(!o)return{symbol:null};const{retainId:s=i.retainId,ignoreDrivers:n=i.ignoreDrivers,hasLabelingContext:l=i.hasLabelingContext,retainCIM:a=i.retainCIM,cimFallbackEnabled:t=i.cimFallbackEnabled}=r;let e=null;if(u(o))e=o.clone();else if(o.type==="web-style")e=o.clone();else if(o.type==="cim"){const y=o.data?.symbol?.type;switch(y){case"CIMPointSymbol":e=a?o.clone():b.fromCIMSymbol(o);break;case"CIMLineSymbol":t&&(e=U.clone(),r?.logWarning?.(p,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":t&&(e=v.clone(),r?.logWarning?.(p,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!e)return{error:new m("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${y||"unknown"}' is unsupported in 3D`,{symbol:o})}}else if(o instanceof k)e=w.fromSimpleLineSymbol(o);else if(o instanceof D)e=b.fromSimpleMarkerSymbol(o);else if(o instanceof M)e=b.fromPictureMarkerSymbol(o);else if(o instanceof $)e=r.geometryType&&r.geometryType==="mesh"?I.fromSimpleFillSymbol(o):x.fromSimpleFillSymbol(o);else{if(!(o instanceof L))return{error:new m("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${o.type||o.declaredClass}' is unsupported in 3D`,{symbol:o})};e=l?h.fromTextSymbol(o):b.fromTextSymbol(o)}return s&&e&&e.type!=="cim"&&(e.id=o.id),!n||e.type==="cim"||e instanceof d||e.symbolLayers.forEach(y=>y.ignoreDrivers=!0),{symbol:e}}function O(o,r,s,n){const l=g(o,{},{context:n,isLabelSymbol:!1});l!=null&&S(s,l,r)}function j(o,r,s,n){const l=g(o,{},{context:n,isLabelSymbol:!0});l!=null&&(r[s]=l)}function f(o){return u(o)||o instanceof d}function T(o){return o?.type==="polygon-3d"||o?.type==="line-3d"}function g(o,r,s){if(o==null)return null;const{context:n,isLabelSymbol:l}=s,a=n?.origin,t=n?.messages;if(a==="web-scene"&&!f(o)){const e=F(o,{retainCIM:!0,hasLabelingContext:l});return e.symbol!=null?e.symbol.write(r,n):(t?.push(new m("symbol:unsupported",`Symbols of type '${o.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:o,context:n,error:e.error})),null)}return c(n?.layer)&&T(o)?(t?.push(new m("symbol:unsupported",`Symbols of type '${o.declaredClass}' are not supported on layers of type '${n?.layer?.declaredClass}'.`,{symbol:o,context:n})),null):(a==="web-map"||a==="portal-item"&&!c(n?.layer))&&f(o)?(t?.push(new m("symbol:unsupported",`Symbols of type '${o.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:o,context:n})),null):o.write(r,n)}function q(o,r){return C(o,null,r)}export{O as G,j as H,q as J,F as T,i};
