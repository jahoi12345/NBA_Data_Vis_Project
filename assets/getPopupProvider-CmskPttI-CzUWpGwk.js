import{a1 as Se,N as Re,v as _e,a2 as T,a7 as u,q as Zt,Y as e,H as i,G as l,aK as te,aG as v,aM as Te,K as E}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{Y as b,R as L}from"./collectionUtils-jDyktm0P-BDP2Oq99.js";import{s as Ae}from"./Point-BfTTZoMu-DeJwQYfh.js";import{u as qt}from"./reader-DcGs6kKN-DHJfK-tm.js";import{A as Oe,x as Ce,h as Me,_ as Be,T as Ee,p as $e,u as ke,D as Je}from"./lengthUtils-Dt1_RvOO-j3MEdmHu.js";import{B as Dt,F as qe}from"./Color-CERqXxxY-BuYn26eI.js";import{M as De}from"./date-IqUzANpt-bLKO9IDT.js";import{x as Le}from"./Layer-DZvC7bne-D3VLDrab.js";let it=class extends u{constructor(t){super(t),this.type=null}};e([i({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],it.prototype,"type",void 0),it=e([l("esri.popup.content.Content")],it);const j=it,ot=new te({asc:"ascending",desc:"descending"});let W=class extends b(u){constructor(t){super(t),this.field=null,this.order="ascending"}};e([i({type:String,json:{write:!0}})],W.prototype,"field",void 0),e([i({type:ot.apiValues,json:{type:ot.jsonValues,read:ot.read,write:ot.write}})],W.prototype,"order",void 0),W=e([l("esri.popup.support.AttachmentsOrderByInfo")],W);const We=W;let f=class extends b(j){constructor(t){super(t),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};e([i({type:[String],json:{write:!0}})],f.prototype,"attachmentKeywords",void 0),e([i({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],f.prototype,"attachmentTypes",void 0),e([i({type:String,json:{write:!0}})],f.prototype,"description",void 0),e([i({type:["auto","preview","list"],json:{write:!0}})],f.prototype,"displayType",void 0),e([i({type:[We],json:{write:!0}})],f.prototype,"orderByFields",void 0),e([i({type:String,json:{write:!0}})],f.prototype,"title",void 0),e([i({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],f.prototype,"type",void 0),f=e([l("esri.popup.content.AttachmentsContent")],f);const X=f;var wt;let A=wt=class extends j{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new wt({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?T(this.outFields):null})}};e([i()],A.prototype,"creator",void 0),e([i()],A.prototype,"destroyer",void 0),e([i()],A.prototype,"outFields",void 0),e([i({type:["custom"],readOnly:!0})],A.prototype,"type",void 0),A=wt=e([l("esri.popup.content.CustomContent")],A);const Ge=A;var vt;let $=vt=class extends u{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new vt({title:this.title,expression:this.expression})}};e([i({type:String,json:{write:!0}})],$.prototype,"title",void 0),e([i({type:String,json:{write:!0}})],$.prototype,"expression",void 0),e([i({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],$.prototype,"returnType",void 0),$=vt=e([l("esri.popup.ElementExpressionInfo")],$);const Ue=$;var gt;let G=gt=class extends j{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new gt({expressionInfo:this.expressionInfo?.clone()})}};e([i({type:Ue,json:{write:!0}})],G.prototype,"expressionInfo",void 0),e([i({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],G.prototype,"type",void 0),G=gt=e([l("esri.popup.content.ExpressionContent")],G);const ct=G;let rt=class extends b(u){constructor(t){super(t),this.type=null}};e([i({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],rt.prototype,"type",void 0),rt=e([l("esri.layers.support.FieldFormat")],rt);const Lt=rt,ee="auto";let F=class extends Lt{constructor(t){super(t),this.dateStyle=null,this.hour12=ee,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};e([i({type:["full","long","medium","short"],json:{write:!0}})],F.prototype,"dateStyle",void 0),e([i({type:["always","auto","never"],nonNullable:!0,json:{default:ee,write:!0}})],F.prototype,"hour12",void 0),e([i({type:["long","short"],json:{write:!0}})],F.prototype,"month",void 0),e([i({type:["full","long","medium","short"],json:{write:!0}})],F.prototype,"timeStyle",void 0),e([i({type:["date-time"]})],F.prototype,"type",void 0),e([i({type:["numeric"],json:{write:!0}})],F.prototype,"year",void 0),F=e([l("esri.layers.support.DateTimeFieldFormat")],F);const B=F,Kt={min:0,max:20},oe=2,ie=0,re="decimal",se="auto";let N=class extends Lt{constructor(t){super(t),this.maximumFractionDigits=oe,this.minimumFractionDigits=ie,this.style=re,this.type="number",this.useGrouping=se}};e([i({type:v,nonNullable:!0,range:Kt,json:{default:oe,write:!0}})],N.prototype,"maximumFractionDigits",void 0),e([i({type:v,nonNullable:!0,range:Kt,json:{default:ie,write:!0}})],N.prototype,"minimumFractionDigits",void 0),e([i({type:["decimal"],nonNullable:!0,json:{default:re,write:!0}})],N.prototype,"style",void 0),e([i({type:["number"]})],N.prototype,"type",void 0),e([i({type:["always","auto","never"],nonNullable:!0,json:{default:se,write:!0}})],N.prototype,"useGrouping",void 0),N=e([l("esri.layers.support.NumberFieldFormat")],N);const dt=N;let k=class extends b(u){constructor(t){super(t),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};e([Dt(De)],k.prototype,"dateFormat",void 0),e([i({type:Boolean,json:{write:!0}})],k.prototype,"digitSeparator",void 0),e([i({type:v,json:{write:!0}})],k.prototype,"places",void 0),k=e([l("esri.popup.support.FieldInfoFormat")],k);const q=k,Pe={base:Lt,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":B,number:dt}};function xo(t,o){const{format:r}=t;return o&&yt(o)?r?ne(r,o):st(o,{hour12:"always",useGrouping:"always"}):null}function ne(t,o){const{dateFormat:r}=t;if(!o)return r?zt(t):Vt(t);if(!yt(o))return;const s={hour12:"always"};switch(o.type){case"integer":case"small-integer":case"big-integer":case"long":return le(t);case"single":case"double":return Vt(t);case"date":case"timestamp-offset":return r?zt(t):st(o,s);case"date-only":return r?Ke(t):st(o);case"time-only":return r?Ve(t):st(o,s)}}function yt(t){return Oe(t)||Ce(t)||Me(t)||Be(t)||Ee(t)}function le(t){return new dt({useGrouping:t.digitSeparator?"always":"never"})}function Vt(t){const o=le(t),{places:r}=t;return o.minimumFractionDigits=r??0,o.maximumFractionDigits=r??2,o}function zt(t){return new B({dateStyle:ae(t),year:ce(t),month:ue(t),timeStyle:de(t),hour12:pe(t)})}function Ke(t){return new B({dateStyle:ae(t),year:ce(t),month:ue(t)})}function Ve(t){return new B({timeStyle:de(t),hour12:pe(t)})}function ae(t){const{dateFormat:o}=t;return o?o.startsWith("short-date")?"short":o.startsWith("day-short-month-year")?"medium":o.startsWith("long-month-day-year")?"long":o.startsWith("long-date")?"full":null:null}function pe(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function ue(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function de(t){const{dateFormat:o}=t;return o?o.includes("short-time")?"short":o.includes("long-time")?"medium":null:null}function ce(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function ze(t,o){const r=t.type==="number",s=t.type==="date-time";if(!o)return r?Yt(t):s?Ht(t):null;if(yt(o))switch(o.type){case"integer":case"small-integer":case"big-integer":case"long":return r?ye(t):null;case"single":case"double":return r?Yt(t):null;case"date":case"timestamp-offset":return s?Ht(t):null;case"date-only":return s?Ye(t):null;case"time-only":return s?He(t):null}}function ye(t){return new q({digitSeparator:t.useGrouping!=="never"})}function Yt(t){const o=ye(t);return o.places=t.maximumFractionDigits,o}function Ht(t){let o;const r=he(t),s=me(t),n=t.hour12==="never"?"24":null,a=t.year==="numeric"?"year":null,c=fe(t);return r&&s&&n?o=`${r}-${s}-${n}`:r&&s?o=`${r}-${s}`:r?o=r:a&&c?o=`${c}-${a}`:a&&(o=a),o?new q({dateFormat:o}):null}function Ye(t){let o;const r=he(t),s=t.year==="numeric"?"year":null,n=fe(t);return r?o=r:s&&n?o=`${n}-${s}`:s&&(o=s),o?new q({dateFormat:o}):null}function He(t){let o;const r=me(t),s=t.hour12==="never"?"24":null;return r&&s?o=`short-date-${r}-${s}`:r&&(o=`short-date-${r}`),o?new q({dateFormat:o}):null}function he(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function me(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function fe(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function st(t,o){if(!yt(t))return;const r=o?.useGrouping??"auto",s=o?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new dt({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:r});case"single":case"double":return new dt({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:r});case"date":case"timestamp-offset":return new B({dateStyle:"short",timeStyle:"short",hour12:s});case"date-only":return new B({dateStyle:"short"});case"time-only":return new B({timeStyle:"short",hour12:s})}}let d=class extends b(u){constructor(t){super(t),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(t){this._set("fieldFormat",t),this._set("format",t?ze(t):null)}set format(t){this._set("format",t),this._set("fieldFormat",t?ne(t):null)}readFormat(t,o){if(!o.fieldFormat)return t?q.fromJSON(t):null}clone(){const t=super.clone();return t._set("format",this.format?.clone()),t._set("fieldFormat",this.fieldFormat?.clone()),t}};e([i({value:null,clonable:!1,types:Pe,json:{write:{overridePolicy(t,o,r){const{fieldName:s}=this;return{enabled:!!s&&!s.startsWith("expression/")&&!s.startsWith("relationships/")&&!!r?.writeFieldFormat}}}}})],d.prototype,"fieldFormat",null),e([i({type:String,json:{write:!0}})],d.prototype,"fieldName",void 0),e([i({value:null,clonable:!1,type:q,json:{write:!0}})],d.prototype,"format",null),e([qt("format")],d.prototype,"readFormat",null),e([i({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],d.prototype,"isEditable",void 0),e([i({type:String,json:{write:!0}})],d.prototype,"label",void 0),e([i({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],d.prototype,"statisticType",void 0),e([Dt(new te({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],d.prototype,"stringFieldOption",void 0),e([i({type:String,json:{write:!0}})],d.prototype,"tooltip",void 0),e([i({type:Boolean,json:{write:!0}})],d.prototype,"visible",void 0),d=e([l("esri.popup.FieldInfo")],d);const we=d;var xt;let S=xt=class extends j{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new xt(T({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};e([i({type:Object,json:{write:!0}})],S.prototype,"attributes",void 0),e([i({type:String,json:{write:!0}})],S.prototype,"description",void 0),e([i({type:[we],json:{write:!0}})],S.prototype,"fieldInfos",void 0),e([i({type:String,json:{write:!0}})],S.prototype,"title",void 0),e([i({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],S.prototype,"type",void 0),S=xt=e([l("esri.popup.content.FieldsContent")],S);const Q=S;let O=class extends u{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null}};e([i({type:String,json:{write:!0}})],O.prototype,"altText",void 0),e([i({type:String,json:{write:!0}})],O.prototype,"caption",void 0),e([i({type:String,json:{write:!0}})],O.prototype,"title",void 0),e([i({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],O.prototype,"type",void 0),O=e([l("esri.popup.content.mixins.MediaInfo")],O);const Wt=O;var Ft;let C=Ft=class extends Zt{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new Ft({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};e([i()],C.prototype,"color",void 0),e([i()],C.prototype,"fieldName",void 0),e([i()],C.prototype,"tooltip",void 0),e([i()],C.prototype,"value",void 0),C=Ft=e([l("esri.popup.content.support.ChartMediaInfoValueSeries")],C);const Xe=C;var It;let R=It=class extends u{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new It({colors:T(this.colors),fields:T(this.fields),normalizeField:this.normalizeField,series:T(this.series),tooltipField:this.tooltipField})}};e([i({type:[qe],json:{type:[[v]],write:!0}})],R.prototype,"colors",void 0),e([i({type:[String],json:{write:{isRequired:!0}}})],R.prototype,"fields",void 0),e([i({type:String,json:{write:!0}})],R.prototype,"normalizeField",void 0),e([i({type:[Xe],json:{read:!1}})],R.prototype,"series",void 0),e([i({type:String,json:{write:!0}})],R.prototype,"tooltipField",void 0),R=It=e([l("esri.popup.content.support.ChartMediaInfoValue")],R);const Qe=R;let U=class extends Wt{constructor(t){super(t),this.type=null,this.value=void 0}};e([i({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],U.prototype,"type",void 0),e([i({type:Qe,json:{write:{isRequired:!0}}})],U.prototype,"value",void 0),U=e([l("esri.popup.content.mixins.ChartMediaInfo")],U);const ht=U,mt=Te()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var bt;let nt=bt=class extends ht{constructor(t){super(t),this.type="bar-chart"}clone(){return new bt({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};e([i({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:mt.write,isRequired:!0}}})],nt.prototype,"type",void 0),nt=bt=e([l("esri.popup.content.BarChartMediaInfo")],nt);const ve=nt;var jt;let lt=jt=class extends ht{constructor(t){super(t),this.type="column-chart"}clone(){return new jt({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};e([i({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:mt.write,isRequired:!0}}})],lt.prototype,"type",void 0),lt=jt=e([l("esri.popup.content.ColumnChartMediaInfo")],lt);const ge=lt;var Nt;let P=Nt=class extends u{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new Nt({linkURL:this.linkURL,sourceURL:this.sourceURL})}};e([i({type:String,json:{write:!0}})],P.prototype,"linkURL",void 0),e([i({type:String,json:{write:{isRequired:!0}}})],P.prototype,"sourceURL",void 0),P=Nt=e([l("esri.popup.content.support.ImageMediaInfoValue")],P);const Ze=P;var St;let J=St=class extends Wt{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new St({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};e([i({type:Number,json:{write:!0}})],J.prototype,"refreshInterval",void 0),e([i({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],J.prototype,"type",void 0),e([i({type:Ze,json:{write:{isRequired:!0}}})],J.prototype,"value",void 0),J=St=e([l("esri.popup.content.ImageMediaInfo")],J);const xe=J;var Rt;let at=Rt=class extends ht{constructor(t){super(t),this.type="line-chart"}clone(){return new Rt({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};e([i({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:mt.write,isRequired:!0}}})],at.prototype,"type",void 0),at=Rt=e([l("esri.popup.content.LineChartMediaInfo")],at);const Fe=at;var _t;let pt=_t=class extends ht{constructor(t){super(t),this.type="pie-chart"}clone(){return new _t({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};e([i({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:mt.write,isRequired:!0}}})],pt.prototype,"type",void 0),pt=_t=e([l("esri.popup.content.PieChartMediaInfo")],pt);const Ie=pt,Tt={base:Wt,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":ve,"column-chart":ge,"line-chart":Fe,"pie-chart":Ie,image:xe}};var At;let h=At=class extends j{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(o=>o.type==="image"?xe.fromJSON(o):o.type==="barchart"?ve.fromJSON(o):o.type==="columnchart"?ge.fromJSON(o):o.type==="linechart"?Fe.fromJSON(o):o.type==="piechart"?Ie.fromJSON(o):void 0).filter(Boolean)}writeMediaInfos(t,o){o.mediaInfos=t&&t.map(r=>r.toJSON())}clone(){return new At(T({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};e([i()],h.prototype,"activeMediaInfoIndex",void 0),e([i({type:Object,json:{write:!0}})],h.prototype,"attributes",void 0),e([i({type:String,json:{write:!0}})],h.prototype,"description",void 0),e([i({types:[Tt]})],h.prototype,"mediaInfos",void 0),e([qt("mediaInfos")],h.prototype,"readMediaInfos",null),e([E("mediaInfos")],h.prototype,"writeMediaInfos",null),e([i({type:String,json:{write:!0}})],h.prototype,"title",void 0),e([i({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],h.prototype,"type",void 0),h=At=e([l("esri.popup.content.MediaContent")],h);const Z=h;var Ot;let K=Ot=class extends u{constructor(t){super(t),this.field=null,this.order=null}clone(){return new Ot({field:this.field,order:this.order})}};e([i({type:String,json:{write:!0}})],K.prototype,"field",void 0),e([i({type:["asc","desc"],json:{write:!0}})],K.prototype,"order",void 0),K=Ot=e([l("esri.popup.support.RelatedRecordsInfoFieldOrder")],K);const be=K;let w=class extends b(j){constructor(t){super(t),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};e([i({type:String,json:{write:!0}})],w.prototype,"description",void 0),e([i({type:Number,json:{type:v,write:!0}})],w.prototype,"displayCount",void 0),e([i({type:["list"],json:{write:{isRequired:!0}}})],w.prototype,"displayType",void 0),e([i({type:[be],json:{write:!0}})],w.prototype,"orderByFields",void 0),e([i({type:Number,json:{type:v,write:{isRequired:!0}}})],w.prototype,"relationshipId",void 0),e([i({type:String,json:{write:!0}})],w.prototype,"title",void 0),e([i({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],w.prototype,"type",void 0),w=e([l("esri.popup.content.RelationshipContent")],w);const tt=w;var Ct;let V=Ct=class extends j{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new Ct({text:this.text})}};e([i({type:String,json:{write:!0}})],V.prototype,"text",void 0),e([i({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],V.prototype,"type",void 0),V=Ct=e([l("esri.popup.content.TextContent")],V);const et=V;let I=class extends b(u){constructor(t){super(t),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};e([i({type:String,json:{write:!0}})],I.prototype,"title",void 0),e([i({type:String,json:{write:!0}})],I.prototype,"description",void 0),e([i({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],I.prototype,"type",void 0),e([i({type:Number,json:{type:v,write:!0}})],I.prototype,"associatedNetworkSourceId",void 0),e([i({type:Number,json:{type:v,write:!0}})],I.prototype,"associatedAssetGroup",void 0),e([i({type:Number,json:{type:v,write:!0}})],I.prototype,"associatedAssetType",void 0),I=e([l("esri.popup.support.UtilityNetworkAssociationType")],I);const to=I;let _=class extends b(j){constructor(t){super(t),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};e([i({type:String,json:{write:!0}})],_.prototype,"description",void 0),e([i({type:Number,json:{type:v,write:!0}})],_.prototype,"displayCount",void 0),e([i({type:String,json:{write:!0}})],_.prototype,"title",void 0),e([i({type:[to],json:{write:!0}})],_.prototype,"associationTypes",void 0),e([Dt({utilityNetworkAssociations:"utility-network-associations"})],_.prototype,"type",void 0),_=e([l("esri.popup.content.UtilityNetworkAssociationsContent")],_);const Gt=_,eo={base:null,key:"type",typeMap:{attachment:X,media:Z,text:et,expression:ct,field:Q,relationship:tt,utilityNetworkAssociations:Gt}},oo={base:null,key:"type",typeMap:{attachment:X,media:Z,text:et,expression:ct,field:Q,relationship:tt}};var Mt;let M=Mt=class extends u{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new Mt({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};e([i({type:String,json:{write:!0}})],M.prototype,"name",void 0),e([i({type:String,json:{write:!0}})],M.prototype,"title",void 0),e([i({type:String,json:{write:!0}})],M.prototype,"expression",void 0),e([i({type:["string","number"],json:{write:!0}})],M.prototype,"returnType",void 0),M=Mt=e([l("esri.popup.ExpressionInfo")],M);const io=M;var Bt;let z=Bt=class extends u{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new Bt({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};e([i({type:Boolean,json:{write:!0}})],z.prototype,"returnTopmostRaster",void 0),e([i({type:Boolean,json:{write:!0}})],z.prototype,"showNoDataRecords",void 0),z=Bt=e([l("esri.popup.LayerOptions")],z);const ro=z;var Et;let Y=Et=class extends u{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new Et({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?T(this.orderByFields):null})}};e([i({type:Boolean,json:{write:!0}})],Y.prototype,"showRelatedRecords",void 0),e([i({type:[be],json:{write:!0}})],Y.prototype,"orderByFields",void 0),Y=Et=e([l("esri.popup.RelatedRecordsInfo")],Y);const Xt=Y;var $t;let y=$t=class extends Le(Zt){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new $t({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};e([i()],y.prototype,"active",void 0),e([i()],y.prototype,"className",void 0),e([i()],y.prototype,"disabled",void 0),e([i()],y.prototype,"icon",void 0),e([i()],y.prototype,"id",void 0),e([i()],y.prototype,"indicator",void 0),e([i()],y.prototype,"title",void 0),e([i()],y.prototype,"type",void 0),e([i()],y.prototype,"visible",void 0),y=$t=e([l("esri.support.actions.ActionBase")],y);const Ut=y;var kt;let ut=kt=class extends Ut{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new kt({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};e([i()],ut.prototype,"image",void 0),ut=kt=e([l("esri.support.actions.ActionButton")],ut);const so=ut;var Jt;let H=Jt=class extends Ut{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new Jt({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};e([i()],H.prototype,"image",void 0),e([i()],H.prototype,"value",void 0),H=Jt=e([l("esri.support.actions.ActionToggle")],H);const no=H,D="relationships/",Qt="expression/",lo=L.ofType({key:"type",defaultKeyValue:"button",base:Ut,typeMap:{button:so,toggle:no}}),ao={base:j,key:"type",typeMap:{media:Z,custom:Ge,text:et,attachments:X,fields:Q,expression:ct,relationship:tt,utilityNetworkAssociations:Gt}},je=new Set(["attachments","fields","media","text","expression","relationship"]),po=new Set([...je,"utility-network-associations"]);let p=class extends b(u){constructor(t){super(t),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(t){return Array.isArray(t)?t.map(o=>Se(ao,o)):typeof t=="string"||typeof t=="function"||t instanceof HTMLElement||Re(t)?t:(_e.getLogger(this).error("content error","unsupported content value",{value:t}),null)}readContent(t,o){const{popupElements:r}=o;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(o.description,o.mediaInfos,r):this._readPopupInfo(o)}writeWebSceneContent(t,o,r,s){this._writePopupTemplateContent(t,o,s)}writeWebMapContent(t,o,r,s){this._writePopupTemplateContent(t,o,s)}writeFieldInfos(t,o,r,s){const{content:n}=this,a=Array.isArray(n)?n:null,{writeFieldFormat:c,...g}=s||{};if(t){const m=a?a.filter(x=>x.type==="fields"):[],ft=m.length&&m.every(x=>x.fieldInfos?.length);o.fieldInfos=t.filter(Boolean).map(x=>{const Pt=x.toJSON(g);return ft&&(Pt.visible=!1),Pt})}if(a)for(const m of a)m.type==="fields"&&this._writeFieldsContent(m,o,g)}writeLayerOptions(t,o,r,s){o[r]=!t||t.showNoDataRecords===null&&t.returnTopmostRaster===null?null:t.toJSON(s)}writeTitle(t,o){o.title=t||""}async collectRequiredFields(t,o,r){const s=this.expressionInfos||[];await this._collectExpressionInfoFields(t,o,r,[...s,...this._getContentExpressionInfos(this.content,s)]),$e(t,o,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t,o){const r=new Set;return await this.collectRequiredFields(r,t,o),[...r].sort()}_writePopupTemplateContent(t,o,r){typeof t!="string"?Array.isArray(t)&&(o.popupElements=t.filter(s=>r?.origin==="web-scene"?je.has(s.type):po.has(s.type)).map(s=>s?.toJSON(r)),o.popupElements.forEach(s=>{s.type==="attachments"?this._writeAttachmentContent(o):s.type==="media"?this._writeMediaContent(s,o):s.type==="text"?this._writeTextContent(s,o):s.type==="relationship"&&this._writeRelationshipContent(s,o)})):o.description=t}_writeFieldsContent(t,o,r){const s=t.fieldInfos;if(!Array.isArray(s)||!s.length)return;const n=o.fieldInfos;if(Array.isArray(n))for(const a of s){const c=n.find(g=>g.fieldName?.toLowerCase()===a.fieldName?.toLowerCase());c?c.visible=!0:n.push(a.toJSON(r))}else o.fieldInfos=s.map(a=>a.toJSON(r))}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeRelationshipContent(t,o){const r=t.orderByFields?.map(n=>this._toFieldOrderJSON(n,t.relationshipId))||[],s=[...o.relatedRecordsInfo?.orderByFields||[],...r];o.relatedRecordsInfo={showRelatedRecords:!0,...s?.length&&{orderByFields:s}}}_writeTextContent(t,o){!o.description&&t.text&&(o.description=t.text)}_writeMediaContent(t,o){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const r=T(t.mediaInfos);Array.isArray(o.mediaInfos)?o.mediaInfos=[...o.mediaInfos,...r]:o.mediaInfos=r}_readPopupInfoElements(t,o,r){const s={description:!1,mediaInfos:!1};return r.map(n=>n.type==="media"?(n.mediaInfos||!o||s.mediaInfos||(n.mediaInfos=o,s.mediaInfos=!0),Z.fromJSON(n)):n.type==="text"?(n.text||!t||s.description||(n.text=t,s.description=!0),et.fromJSON(n)):n.type==="attachments"?X.fromJSON(n):n.type==="fields"?Q.fromJSON(n):n.type==="expression"?ct.fromJSON(n):n.type==="relationship"?tt.fromJSON(n):n.type==="utilityNetworkAssociations"?Gt.fromJSON(n):void 0).filter(Boolean)}_toRelationshipContent(t){const{field:o,order:r}=t;if(!o?.startsWith(D))return null;const s=o.replace(D,"").split("/");if(s.length!==2)return null;const n=parseInt(s[0],10),a=s[1];return!Number.isNaN(n)&&a?tt.fromJSON({relationshipId:n,orderByFields:[{field:a,order:r}]}):null}_toFieldOrderJSON(t,o){const{order:r,field:s}=t;return{field:`${D}${o}/${s}`,order:r}}_readPopupInfo({description:t,mediaInfos:o,showAttachments:r,relatedRecordsInfo:s={showRelatedRecords:!1}}){const n=[];t?n.push(new et({text:t})):n.push(new Q),Array.isArray(o)&&o.length&&n.push(Z.fromJSON({mediaInfos:o})),r&&n.push(X.fromJSON({displayType:"auto"}));const{showRelatedRecords:a,orderByFields:c}=s;return a&&c?.length&&c.forEach(g=>{const m=this._toRelationshipContent(g);m&&n.push(m)}),n.length?n:t}_getContentElementFields(t){const o=t?.type;if(o==="attachments")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)];if(o==="custom")return t.outFields||[];if(o==="fields")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...this._getFieldInfoFields(t.fieldInfos??this.fieldInfos)];if(o==="media"){const r=t.mediaInfos||[];return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...r.reduce((s,n)=>[...s,...this._getMediaInfoFields(n)],[])]}return o==="text"?this._extractFieldNames(t.text):o==="relationship"||o==="utility-network-associations"?[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)]:[]}_getMediaInfoFields(t){const{caption:o,title:r,value:s}=t,n=s||{},{fields:a,normalizeField:c,tooltipField:g,sourceURL:m,linkURL:ft}=n,x=[...this._extractFieldNames(r),...this._extractFieldNames(o),...this._extractFieldNames(m),...this._extractFieldNames(ft),...a??[]];return c&&x.push(c),g&&x.push(g),x}_getContentExpressionInfos(t,o){return Array.isArray(t)?t.reduce((r,s)=>[...r,...s.type==="expression"&&s.expressionInfo?[s.expressionInfo]:[]],o):[]}_getContentFields(t){return typeof t=="string"?this._extractFieldNames(t):Array.isArray(t)?t.reduce((o,r)=>[...o,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(t,o,r,s){s&&await Promise.all(s.map(n=>ke(t,o,r,n.expression)))}_getFieldInfoFields(t){return t?t.filter(({fieldName:o,visible:r})=>!(r!==void 0&&!r||!o||o.startsWith(D)||o.startsWith(Qt))).map(o=>o.fieldName):[]}_getActionsFields(t){return t?t.toArray().reduce((o,r)=>[...o,...this._getActionFields(r)],[]):[]}_getActionFields(t){const{className:o,title:r,type:s}=t,n=s==="button"||s==="toggle"?t.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(o),...this._extractFieldNames(n)]}_getTitleFields(t){return typeof t=="string"?this._extractFieldNames(t):[]}_extractFieldNames(t){return Je(t).filter(o=>!(o.startsWith(D)||o.startsWith(Qt)))}};e([i({type:lo})],p.prototype,"actions",void 0),e([i()],p.prototype,"content",void 0),e([Ae("content")],p.prototype,"castContent",null),e([qt("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],p.prototype,"readContent",null),e([E("web-scene","content",{popupElements:{type:L.ofType(oo)},showAttachments:{type:Boolean},mediaInfos:{type:L.ofType(Tt)},description:{type:String},relatedRecordsInfo:{type:Xt}})],p.prototype,"writeWebSceneContent",null),e([E("content",{popupElements:{type:L.ofType(eo)},showAttachments:{type:Boolean},mediaInfos:{type:L.ofType(Tt)},description:{type:String},relatedRecordsInfo:{type:Xt}})],p.prototype,"writeWebMapContent",null),e([i({type:[io],json:{write:!0}})],p.prototype,"expressionInfos",void 0),e([i({type:[we]})],p.prototype,"fieldInfos",void 0),e([E("fieldInfos")],p.prototype,"writeFieldInfos",null),e([i({type:ro})],p.prototype,"layerOptions",void 0),e([E("layerOptions")],p.prototype,"writeLayerOptions",null),e([i({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],p.prototype,"lastEditInfoEnabled",void 0),e([i()],p.prototype,"outFields",void 0),e([i()],p.prototype,"overwriteActions",void 0),e([i()],p.prototype,"returnGeometry",void 0),e([i({json:{type:String}})],p.prototype,"title",void 0),e([E("title")],p.prototype,"writeTitle",null),p=e([l("esri.PopupTemplate")],p);const Fo=p,Ne=Symbol("popupProvider");function Io(t){return typeof t=="object"&&t!==null&&"popupEnabled"in t&&"popupTemplate"in t}function uo(t){return!!t&&Ne in t}function bo(t){return uo(t)?t[Ne]:null}export{Fo as A,bo as B,be as I,ze as K,Io as M,xo as N,Ut as P,Pe as U,We as W,X,Q as Y,Z,so as a,Xe as b,Ue as c,et as e,Ne as j,no as n,io as o,q,st as s,to as t,we as w,yt as y};
