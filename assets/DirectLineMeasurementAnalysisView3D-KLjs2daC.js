import{l as rt,i as Et,_ as n,m as r,a as I,aU as zt,u as S,n as At}from"./jsonMap-Bs3hmeCU.js";import{e as xt}from"./getDefaultUnitForView-BJQfnw1s.js";import{e as Tt}from"./AnalysisView3D-zhHEgrUR.js";import{s as D,by as Ht,a9 as lt,bq as Rt}from"./ShadowCastClear.glsl-Dm_ZNusR.js";import{l as P,w as O,e as Gt,h as F,f as jt}from"./reactiveUtils-SO2Ko3sy.js";import{bq as ut,bp as kt,bz as It,af as Wt,b as Qt}from"./Point-CMHR1y9V.js";import{r as Ft,a as qt,o as Bt,p as W,Y as dt,g as Ut,t as Nt}from"./ShadedColorMaterial.glsl-Byud1Fq4.js";import{ah as Yt,a4 as Jt,H as B,a2 as Kt,g as Xt}from"./euclideanLengthMeasurementUtils-DuFmWBRS.js";import{f as Zt}from"./intl-C3uMq9s5.js";import{K as st,H as ht,Q as Mt,I as nt,D as ct,L as te}from"./colorUtils-BzDQ74Nc.js";import{a as ee,s as ie}from"./mathUtils-PIGhLnI9.js";import{d as U,T as se,D as pt,V as ne,w as mt}from"./quantityFormatUtils-DZqbc625.js";import{y as St,x as ot}from"./screenUtils-BitdhK1O.js";import{j as gt}from"./Polygon-WlfMxvm8.js";import{o as N,A as Y,c as Vt,_ as Ot,p as ae,E as J,s as re,R as oe,Y as le,g as ue,u as de}from"./vec32-DIQfN9dj.js";import{n as C}from"./collectionUtils-Cc1OWTqq.js";import{f as K,_ as _t,m as j,C as vt}from"./Segment--H1FNSeM.js";import{e as he}from"./mat4f64-q_b6UJoq.js";import{a as yt}from"./vec42-ClQ6ADuy.js";import{r as X,n as wt}from"./vec4f64-DPb6J-GU.js";import{c as Q}from"./vector-HTSzpX5X.js";import{V as ce,W as pe,au as Z,l as q,a1 as me,a2 as ge,a3 as _e,a8 as ve,at as ye,ad as we,ae as fe,af as ft,s as be,ah as Pe,ai as Le,aP as Ce}from"./Texture-BuZokc5o.js";import{M as Me,l as Se,x as Ve}from"./RealisticTree.glsl-CD2qk3Wa.js";import{f as tt,t as k,o as bt}from"./Emissions.glsl-B8XKMjLy.js";import{_ as Oe}from"./index-BiLqt4Ue.js";import{Q as $e}from"./InterleavedLayout-DVezg4xk.js";import{_ as De}from"./enums-B4pqBiXb.js";import{a as Ee,w as ze}from"./SnappingVisualizer3D-CmIasWKH.js";import{h as et}from"./lineStippleUtils-CCavR4OV.js";import{t as Ae}from"./elevationInfoUtils-Dxkv6YB1.js";import{h as xe}from"./UpdatingHandles-D2RI_3Hb.js";import{w as Te}from"./measurementUtils-Ctk2Z_z5.js";import{G as He,O as Re}from"./dragEventPipeline3D-IexlaW7D.js";import{u as Pt}from"./Color-CERqXxxY.js";import{b as Ge}from"./frustum-DWgQCJBb.js";import{c as je}from"./LaserlinePath.glsl-CWTtr26S.js";import{o as ke,m as Ie,f as We,d as Qe}from"./analysisViewUtils-BUVEi2BB.js";import{g as Fe,w as qe,a as Be}from"./EditGeometryOperations-1rIkp3wx.js";import{p as Ue,h as Ne}from"./InteractiveToolBase-SFDvR5n1.js";import{e as Ye}from"./SnappingContext-CJ0BhNH8.js";import{f as Je}from"./SnappingDragPipelineStep-Njz1Mbjc.js";import{a as Ke}from"./SnappingManagerPool-BDL6YQPZ.js";import"./mat4-Df_3WIwI.js";import"./jsonUtils-BIx2Bg38.js";import"./Extent-BVvEPGp_.js";import"./Polyline-CYNn9agI.js";import"./typeUtils-Dr-CEt7y.js";import"./modeUtils-RVJH-Hyp.js";import"./uuid-Oe6SV2kF.js";import"./sanitizerUtils-BT_8V5US.js";import"./SimpleObservable-CvFyr0NA.js";import"./lengthUtils-1lu2BknD.js";import"./date-IqUzANpt.js";import"./workers-eNnOSbW_.js";import"./Queue-CYlrXMwB.js";import"./PooledRBush-Dco5QkUp.js";import"./quickselect-QQC62dOK.js";import"./GraphicsCollection-FgG4i9u5.js";import"./Graphic-CfT07maQ.js";import"./getPopupProvider-zqy7P9ZA.js";import"./reader-DcGs6kKN.js";import"./Layer--kjMcEYS.js";import"./createFeatureId-CVwTD0fV.js";import"./typeUtils-BUTeHmXX.js";import"./lineMarkers-CDwLe3J6.js";import"./PolygonSymbol3D-DOhH5ySO.js";import"./ExtrudeSymbol3DLayer-DSc1ou2x.js";import"./opacityUtils-DuFH0EC9.js";import"./aaBoundingBox-CNqmdQRu.js";import"./aaBoundingRect-WcI4brw6.js";import"./DoubleArray-DExKNiTh.js";import"./Font-SQ7b_Y8G.js";import"./SimpleFillSymbol-CDawtd9z.js";import"./SimpleMarkerSymbol-BGAFRS9_.js";import"./PictureMarkerSymbol-6cJpxdoq.js";import"./TextSymbol-DhXD0YaH.js";import"./HeightModelInfo-BOZ2bCXl.js";import"./projectionUtils-BYIvMX5W.js";import"./spatialReferenceEllipsoidUtils-DnehMctI.js";import"./projectPointToVector-lgC5SvvR.js";import"./scaleUtils-cWMHpBu0.js";import"./layerUtils-CCPFPk-j.js";import"./TilemapCache-ChidWVjQ.js";import"./LRUCache-fy84PBMi.js";import"./TileKey-CTZ53yPm.js";import"./memoryEstimations-Bd726a_p.js";import"./tagSymbols-BPcGfZon.js";import"./asyncUtils-w6KfWU41.js";import"./signal-BX9ezF8a.js";import"./Map-BZpIOwPY.js";import"./Basemap-fKW7Cz4U.js";import"./loadAll-H0orMzpA.js";import"./PortalItem-e2bKDJZ8.js";import"./writeUtils-BvBZRLXT.js";import"./CollectionFlattener-CyTdUoKH.js";import"./persistable-Ot1881Fk.js";import"./MD5-MtSiOt06.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./resourceExtension-Dlt4ayx_.js";import"./PolygonCollection-j-hecAeB.js";import"./mat4f32-Djp3mnm5.js";import"./TablesMixin-Nye32Ffd.js";import"./timeZoneUtils-BSc7-7qA.js";import"./ReactiveMap-B0by2bYu.js";import"./Query-dGEUg7py.js";import"./Field-Cm_ZejYW.js";import"./fieldType-DVUzXtk_.js";import"./normalizeUtils-BEJV7G0l.js";import"./Cyclical-BLSxUpe7.js";import"./normalizeUtilsCommon-DnSvD7ht.js";import"./utils-BrkeFJbU.js";import"./utils-DGvxRWBb.js";import"./ElevationQuery-uPUdv3lW.js";import"./TileInfo-BbMV8v9T.js";import"./plane-C25sE_vU.js";import"./vec2f64-rIxtbMRN.js";import"./vec3f32-WCVSSNPR.js";import"./Scheduler-CNrsbccs.js";import"./Indices-D0_UQPPr.js";import"./VertexElementDescriptor-BlxU8vCE.js";import"./sphere-COwiWjRO.js";import"./constants-D67WmGms.js";import"./quat-D3JcL9GI.js";import"./quatf64-CCm9z-pX.js";import"./computeTranslationToOriginAndRotation-D0D690pa.js";import"./projectVectorToVector-CDqEkUpu.js";import"./floatRGBA-1BW7WSIR.js";import"./labelUtils-BtizwBfq.js";import"./ArcadeExpression-BHPcSlWy.js";import"./TimeOnly-DH57Trnh.js";import"./enum-BzLwmiID.js";import"./UnknownTimeZone-B697BDFv.js";import"./FieldsIndex-CyoOfYU1.js";import"./TileKey-C44YQC4_.js";import"./layerViewUtils-BTa15X3o.js";import"./unitConversionUtils-C_S2QiAQ.js";import"./BufferView-BVrbsaWH.js";import"./orientedBoundingBox-CpdLjzxi.js";import"./vec2f32-CaVKkSa6.js";import"./dehydratedFeatures-D_FpkmpM.js";import"./quantizationUtils-BYmjRh4u.js";import"./featureConversionUtils-hXFGbgzJ.js";import"./OptimizedFeature-CwRGZPwv.js";import"./OptimizedFeatureSet-BR8EEvDc.js";import"./Octree-BScVi4hI.js";import"./HUDIntersectorResult-DJ-mrASs.js";import"./intersectorUtilsConversions-DcxEtHOg.js";import"./Intersector-BEbN3ApI.js";import"./DefaultLoadingContext-BBb1tRC-.js";import"./wosrLoader-BTzfF2iQ.js";import"./Version-BtYZEj58.js";import"./axisAngleDegrees-D1OOYQT7.js";import"./edgePreprocessing-BFYAECPd.js";import"./config-Dg972SSE.js";import"./GeometryUtils-BdjkAnCr.js";import"./definitions-Dvg4hMIw.js";import"./WorkerHandle-CWMP3YEU.js";import"./vec3-B_phcnZY.js";import"./vec33-CWJeyzxV.js";import"./capabilities-Bi6C4OG6.js";import"./imageUtils-CE3cSuc6.js";import"./VisualElement-By4iq8p4.js";import"./line-C-ddTi4F.js";import"./ColorMaterial.glsl-CcZVdYWV.js";import"./TriangleMaterial-CKZGf8CW.js";import"./utils-DTE-xBiC.js";import"./geometry2dUtils-DZIzXBrj.js";import"./geodeticLengthOperator-DWmEMDW0.js";import"./geodeticCurveType-CirnHLSB.js";import"./TextOverlayItem-BsL1yzOU.js";import"./videoUtils-Dwx3AEgj.js";import"./meshVertexSpaceUtils-CDaunXaJ.js";import"./MeshLocalVertexSpace-y1kE5w4c.js";import"./types-BKo2foNY.js";import"./ExtendedLineVisualElement-CG6nETQj.js";import"./EngineVisualElement-C3RUR-2o.js";import"./PointVisualElement-CoD96D6u.js";import"./rotate-DAb7542t.js";import"./curveOperationUtils-eVwHMZKz.js";import"./PointSnappingHint-DhgidinS.js";import"./dehydratedFeatureComparison-BrPPz4bi.js";import"./allLayerSnapping-eD3XtecF.js";let T=class extends rt{constructor(t){super(t)}initialize(){this.addHandles([P(()=>({viewData:this.viewData,startPoint:this.analysis.startPoint}),({viewData:t,startPoint:i})=>{t.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(i)},O),P(()=>({viewData:this.viewData,endPoint:this.analysis.endPoint}),({viewData:t,endPoint:i})=>{t.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(i)},O),P(()=>({result:this._computedResult,viewData:this.viewData}),({result:t,viewData:i})=>{i.result=t},O)])}_applyProjectionAndElevationAlignment(t){if(t==null)return t;const{spatialReference:i,elevationProvider:s}=this.view;return Ft(t,i,s)??(qt(this.analysis,t.spatialReference,Et.getLogger(this)),null)}get _computedResult(){const{elevationAlignedStartPoint:t,elevationAlignedEndPoint:i,measurementMode:s,unit:o}=this.viewData;if(t==null||i==null)return null;const a=Yt(t,i),c=this.geodesicLengthMeasurementUtils.geodesicDistanceBetweenPoints(t,i);if(a==null)return null;let p,d;switch(s){case 0:d=c!=null?"geodesic":"euclidean",p=c??a.horizontal;break;case 2:if(c==null)return null;d="geodesic",p=c;break;case 1:d="euclidean",p=a.horizontal}let l=a.direct,u=a.vertical;const h=ut(l.value,l.unit,o),m=ut(p.value,p.unit,o),g=kt(u.value,u.unit,o);return l=D(l,h),p=D(p,m),u=D(u,g),{mode:d,directDistance:l,horizontalDistance:p,verticalDistance:u}}};n([r({constructOnly:!0})],T.prototype,"view",void 0),n([r({constructOnly:!0})],T.prototype,"analysis",void 0),n([r({constructOnly:!0})],T.prototype,"viewData",void 0),n([r({constructOnly:!0})],T.prototype,"geodesicLengthMeasurementUtils",void 0),n([r()],T.prototype,"_computedResult",null),T=n([I("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],T);function $t(e){const t=new ce,{vertex:i,fragment:s}=t;pe(i,e),i.uniforms.add(new tt("width",a=>a.width)),t.attributes.add("position","vec3"),t.attributes.add("normal","vec3"),t.attributes.add("uv0","vec2"),t.attributes.add("length","float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.main.add(k`vec3 bitangent = normal;
vtc = uv0;
vlength = length;
vradius = 0.5 * width;
vec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);
gl_Position = proj * pos;`),s.uniforms.add(new tt("outlineSize",a=>a.outlineSize),new Z("outlineColor",a=>a.outlineColor),new tt("stripeLength",a=>a.stripeLength),new Z("stripeEvenColor",a=>a.stripeEvenColor),new Z("stripeOddColor",a=>a.stripeOddColor));const o=1/Math.sqrt(2);return s.code.add(k`
    const float INV_SQRT2 = ${k.float(o)};

    vec4 arrowColor(vec2 tc, float len) {
      float d = INV_SQRT2 * (tc.x - abs(tc.y));
      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));
      d = min(d, 1.0 - abs(tc.y));

      if (d < 0.0) {
        return vec4(0.0);
      }
      if (d < outlineSize) {
        return outlineColor;
      }
      return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;
    }`),s.main.add(k`
    vec2 ntc = vec2(vtc.x / vradius, vtc.y);
    vec4 color = arrowColor(ntc, vlength / vradius);
    if (color.a < ${k.float(q)}) {
      discard;
    }
    fragColor = color;`),t}const Xe=Object.freeze(Object.defineProperty({__proto__:null,build:$t},Symbol.toStringTag,{value:"Module"}));class Ze extends me{constructor(t,i){super(t,i,new ge(Xe,()=>Oe(()=>Promise.resolve().then(()=>yi),void 0)),Dt.locations),this.primitiveType=De.TRIANGLE_STRIP}initializePipeline(t){return _e({blending:t.transparent?we(t.oitPass):null,polygonOffset:t.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:513},depthWrite:ye,colorWrite:ve})}}const Dt=$e().vec3f("position").vec3f("normal").vec2f("uv0").f32("length");class at extends fe{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1}}n([ft()],at.prototype,"polygonOffsetEnabled",void 0),n([ft()],at.prototype,"transparent",void 0);class ti extends be{constructor(t){super(t,ii),this._configuration=new at,this.intersectDraped=void 0,this.produces=new Map([[2,i=>!this._transparent&&bt(i)],[8,i=>this._transparent&&bt(i)]])}getConfiguration(t,i){return super.getConfiguration(t,i,this._configuration),this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this._transparent,this._configuration.oitPass=i.oitPass,this._configuration}get visible(){const{outlineColor:t,stripeEvenColor:i,stripeOddColor:s}=this.parameters;return t[3]>=q||i[3]>=q||s[3]>=q}intersect(){}createGLMaterial(t){return new ei(t)}createBufferWriter(){return new li}get _transparent(){const{parameters:t}=this;return t.outlineColor[3]<1||t.stripeEvenColor[3]<1||t.stripeOddColor[3]<1}}let ei=class extends Le{beginSlot(t){return this.getTechnique(Ze,t)}};class ii extends Pe{constructor(){super(...arguments),this.width=32,this.outlineSize=.2,this.outlineColor=X(1,.5,0,1),this.stripeEvenColor=X(1,1,1,1),this.stripeOddColor=X(1,.5,0,1),this.stripeLength=1,this.polygonOffset=!1}}const si=C(),ni=C(),ai=C(),ri=C(),oi=C();class li{constructor(){this.layout=Dt}elementCount(t){return 2*(t.get("position").indices.length/2+1)}write(t,i,s,o,a,c){const{data:p,indices:d}=s.get("position"),l=s.get("normal").data,u=p.length/3;d&&d.length!==2*(u-1)&&console.warn("MeasurementArrowMaterial does not support indices");const h=si,m=ni,g=ai,f=ri,V=oi,$=a.position,E=a.normal,z=a.uv0;let A=0;for(let M=0;M<u;++M){const H=3*M;if(N(h,p[H],p[H+1],p[H+2]),M<u-1){const R=3*(M+1);N(m,p[R],p[R+1],p[R+2]),N(V,l[R],l[R+1],l[R+2]),Y(V,V),Vt(g,m,h),Y(g,g),Ot(f,V,g),Y(f,f)}const x=ae(h,m);t&&i&&(J(h,h,t),J(m,m,t),J(f,f,i));const b=c+2*M,L=b+1;$.setVec(b,h),$.setVec(L,h),E.setVec(b,f),E.setVec(L,f),z.set(b,0,A),z.set(b,1,-1),z.set(L,0,A),z.set(L,1,1),M<u-1&&(A+=x)}const G=a.length;for(let M=0;M<2*u;++M)G.set(c+M,A);return null}}class ui extends Bt{constructor(t){super(t),this._arrowWidth=16,this._arrowSubdivisions=128,this._origin=C(),this._originTransform=he(),this._arrowCenter=C(),this._renderOccluded=4,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._color=wt(),this._contrastColor=wt(),this.applyProperties(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._arrowMaterial?.setParameters({renderOccluded:t}))}get geometry(){return this._geometry}set geometry(t){this._geometry=t,this._geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(t){this._stripeLength=t,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(t){if(this._stripesEnabled=t,this.attached){const i=this._stripesEnabled?this._contrastColor:this._color;this._arrowMaterial.setParameters({stripeEvenColor:i})}}get color(){return this._color}set color(t){st(t,this._color)||(yt(this._color,t),this._updateArrowColor())}get contrastColor(){return this._contrastColor}set contrastColor(t){st(t,this._color)||(yt(this._contrastColor,t),this._updateArrowColor())}createExternalResources(){const t=this._color,i=this._contrastColor,s=this._stripesEnabled?i:t;this._arrowMaterial=new ti({outlineColor:t,stripeEvenColor:s,stripeOddColor:t,renderOccluded:this.renderOccluded,polygonOffset:!0,isDecoration:this.isDecoration}),this._handles=new zt,this._handles.add(P(()=>this.view.state.camera,()=>{this._viewChanged()}))}destroyExternalResources(){this._arrowMaterial=null,this._handles=S(this._handles)}forEachMaterial(t){t(this._arrowMaterial)}createGeometries(t){if(this._geometry?.startRenderSpace==null||this._geometry.endRenderSpace==null)return;const i=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);i.transformation=this._originTransform,t.addGeometry(i),this._viewChanged()}_createArrowGeometry(t,i,s,o){const a=this.view,c=a.renderCoordsHelper,p=[],d=[],l=(u,h)=>{const m=Q.get();Vt(m,u,s),p.push(m),d.push(h)};if(o.type==="euclidean"){o.eval(.5,this._arrowCenter);const u=Q.get();if(c.worldUpAtPosition(this._arrowCenter,u),di(t,i,u)){const{heading:h,tilt:m}=a.camera,{direction:g}=Ht(a,t,h,m,hi);re(u,g)}l(t,u),l(i,u)}else{o.eval(.5,this._arrowCenter);const u=this._arrowSubdivisions+1&-2;for(let h=0;h<u;++h){const m=h/(u-1),g=Q.get(),f=Q.get();o.eval(m,g),c.worldUpAtPosition(g,f),l(g,f)}}return Me(this._arrowMaterial,p,d)}_geometryChanged(){this.recreateGeometry()}_viewChanged(){if(this.view.ready&&this.attached&&this._geometry!=null){const t=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._arrowWidth*t})}}_updateArrowColor(){if(!this.attached)return;const t=this._color,i=this._contrastColor,s=this._stripesEnabled?i:t,o=t,a=t;this._arrowMaterial.setParameters({stripeEvenColor:s,outlineColor:o,stripeOddColor:a})}}function di(e,t,i){const s=oe(Lt,t,e),o=Ot(Lt,s,i);return le(o)===0}const Lt=C(),hi=Ce();let w=class extends rt{get _parameters(){const e=this.view.effectiveTheme,{accentColor:t,textColor:i}=e,s=ht(t),o=Mt(t,.75),a=ht(nt(t)),c=nt(i,160);return{accentColor:s,contrastColor:a,translucentAccentColor:o,triangleLineWidth:3,geodesicProjectionLineWidth:2,guideLineWidth:2,guideStippleLengthPixels:3,directLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12,textColor:i,textBackgroundColor:ct(c,.6),textCalloutColor:ct(c,.5)}}get visible(){return this.analysisView.visible}get viewMode(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView;if(e==null||t==null||e.equals(t))return 0;const i=this.analysisView.result;if(i==null)return 1;if(this.actualVisualizedMeasurement==="geodesic")return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?3:1;const{verticalDistance:s,horizontalDistance:o}=i,a=D(s,"meters").value,c=D(o,"meters").value;return Math.min(a/c,c/a)<this.triangleCollapseRatioThreshold?1:2}get actualVisualizedMeasurement(){const{measurementMode:e,result:t}=this.analysisView;switch(e){case 0:return t!=null&&D(t.horizontalDistance,"meters").value>Jt?"geodesic":"euclidean";case 1:return"euclidean";case 2:return"geodesic"}}get allowVisualElementsOrientationChange(){return this._triangleOrientationOverride==null}set allowVisualElementsOrientationChange(e){this._triangleOrientationOverride==null!==e&&(this._triangleOrientationOverride==null?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}get labels(){return this.actualVisualizedMeasurement==="geodesic"?{direct:null,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}constructor(e){super(e),this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=C(),this._endPosition=C(),this._cornerPosition=C(),this._startPositionAtSeaLevel=C(),this._endPositionAtSeaLevel=C(),this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.visualElementOrientation=0,this.triangleCollapseRatioThreshold=.03}initialize(){const e={attached:!0,view:this.view,isDecoration:!0},{guideLineWidth:t,guideStippleLengthPixels:i,triangleLineWidth:s,geodesicProjectionLineWidth:o,directLabelFontSize:a,verticalLabelFontSize:c,horizontalLabelFontSize:p}=this._parameters;this._segmentVisualElement=new ui({...e,geometry:null,renderOccluded:4}),this._triangleVisualElement=new W({...e,width:s,renderOccluded:4}),this._rightAngleQuad=new Ee({...e,renderOccluded:4});const d={...e,polygonOffset:!0,renderOccluded:4};this._projectedGeodesicLine=new W({...d,width:o,stipplePattern:et(i)}),this._geodesicStartHint=new W({...d,width:t,stipplePattern:et(i)}),this._geodesicEndHint=new W({...d,width:t,stipplePattern:et(i)}),this._segmentLabel=new K({...e,fontSize:a}),this._verticalLabel=new K({...e,fontSize:c}),this._horizontalLabel=new K({...e,fontSize:p}),this.addHandles([P(()=>{const{elevationAlignedStartPoint:l,elevationAlignedEndPoint:u}=this.analysisView,h=this.view;return{view:h,camera:h.state.camera,viewMode:this.viewMode,elevationAlignedStartPoint:l,elevationAlignedEndPoint:u,orientation:this._actualVisualElementsOrientation,visualizedMeasurement:this.actualVisualizedMeasurement,stripeLength:this._measurementArrowStripeLength}},l=>this._updateGeometryAndViewMode(l),O),P(()=>({visible:this.visible,viewMode:this.viewMode}),l=>this._updateVisualElementVisibility(l),O),P(()=>({text:this._labelsText,visualizedMeasurement:this.actualVisualizedMeasurement}),l=>this._updateLabelText(l),O),P(()=>({visible:this.visible,viewMode:this.viewMode}),l=>this._updateLabelVisibility(l),O),P(()=>this._measurementArrowStripeLength,l=>this._updateSegmentStripeLength(l),O),Gt(()=>this._updateMessageBundle()),P(()=>this._parameters,({textBackgroundColor:l,textCalloutColor:u,textColor:h,translucentAccentColor:m,accentColor:g,contrastColor:f})=>{const{_segmentLabel:V,_verticalLabel:$,_horizontalLabel:E,_triangleVisualElement:z,_rightAngleQuad:A,_projectedGeodesicLine:G,_geodesicStartHint:M,_geodesicEndHint:H,_segmentVisualElement:x}=this;V.backgroundColor=l,V.calloutColor=u,V.textColor=h,$.backgroundColor=l,$.calloutColor=u,$.textColor=h,E.backgroundColor=l,E.calloutColor=u,E.textColor=h,z.color=m,A.color=m,G.color=m,M.color=m,H.color=m,x.color=g,x.contrastColor=f},F)]),this._updateMessageBundle()}destroy(){this._segmentVisualElement=S(this._segmentVisualElement),this._triangleVisualElement=S(this._triangleVisualElement),this._rightAngleQuad=S(this._rightAngleQuad),this._projectedGeodesicLine=S(this._projectedGeodesicLine),this._geodesicStartHint=S(this._geodesicStartHint),this._geodesicEndHint=S(this._geodesicEndHint),this._segmentLabel=S(this._segmentLabel),this._verticalLabel=S(this._verticalLabel),this._horizontalLabel=S(this._horizontalLabel),this.set("view",null)}_updateVisualElementVisibility({visible:e,viewMode:t}){if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,e)switch(t){case 0:break;case 1:this._segmentVisualElement.visible=!0;break;case 2:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case 3:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode({view:e,camera:t,viewMode:i,elevationAlignedStartPoint:s,elevationAlignedEndPoint:o,orientation:a,visualizedMeasurement:c,stripeLength:p}){const d=e.renderCoordsHelper;if(d==null||s==null||o==null||s.equals(o))return;let l=this._startPosition,u=this._endPosition;d.toRenderCoords(s,l),d.toRenderCoords(o,u);const h=a===1?1:-1,m=h*(d.getAltitude(u)-d.getAltitude(l));m<0&&(l=this._endPosition,u=this._startPosition);const g=c==="geodesic"?new _t(this._startPosition,this._endPosition,d.spatialReference):new j(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=g,this._updateSegmentStripeLength(p),i){case 1:this._updateSegment(g,a);break;case 2:this._updateSegmentAndTriangle({view:e,camera:t,segment:g,orientation:a,startPosition:l,endPosition:u,deltaSign:h,altitudeDelta:m});break;case 3:this._updateSegmentAndProjection({view:e,orientation:a,startPosition:l,endPosition:u})}}_updateSegment(e,t){this._segmentLabel.anchor=t===1?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}_updateSegmentAndTriangle({view:{renderCoordsHelper:e},camera:t,segment:i,orientation:s,startPosition:o,endPosition:a,deltaSign:c,altitudeDelta:p}){const d=this._cornerPosition;e.worldUpAtPosition(o,d),ue(d,d,c*Math.abs(p)),de(d,d,o),this._triangleVisualElement.geometry=[[[o[0],o[1],o[2]],[d[0],d[1],d[2]],[a[0],a[1],a[2]]]],this._rightAngleQuad.geometry={previous:o,center:d,next:a};const l=new j(o,d),u=new j(d,a),h=ci(o,a,d,s,t);h&&(this._segmentLabel.anchor=h.segment,this._segmentLabel.geometry={type:"segment",segment:i,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:l,sampleLocation:"center"},this._verticalLabel.anchor=h.vertical,this._horizontalLabel.geometry={type:"segment",segment:u,sampleLocation:"center"},this._horizontalLabel.anchor=h.horizontal)}_updateSegmentAndProjection({view:{renderCoordsHelper:e},orientation:t,startPosition:i,endPosition:s}){e.setAltitude(this._startPositionAtSeaLevel,0,i),e.setAltitude(this._endPositionAtSeaLevel,0,s);const o=new _t(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,e.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(o),this._geodesicStartHint.setGeometryFromSegment(new j(this._startPositionAtSeaLevel,i)),this._geodesicEndHint.setGeometryFromSegment(new j(this._endPositionAtSeaLevel,s)),this._segmentLabel.geometry={type:"segment",segment:o,sampleLocation:"center"},this._segmentLabel.anchor=t===1?"top":"bottom"}_updateLabelText({text:e,visualizedMeasurement:t}){e!=null?(this._segmentLabel.text=t==="euclidean"?e.directDistance:e.horizontalDistance,this._horizontalLabel.text=e.horizontalDistance,this._verticalLabel.text=e.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}_updateLabelVisibility({visible:e,viewMode:t}){const i=this._segmentLabel,s=this._horizontalLabel,o=this._verticalLabel;if(i.visible=!1,s.visible=!1,o.visible=!1,e)switch(t){case 1:case 3:i.visible=!0;break;case 2:i.visible=!0,s.visible=!0,o.visible=!0}}get _labelsText(){if(this.destroyed)return null;const e=this.messages,t=this.analysisView.result;if(t==null||e==null)return null;const{directDistance:i,horizontalDistance:s,verticalDistance:o}=t,a=this.analysisView.unit,c=p=>({directDistance:"",horizontalDistance:"",verticalDistance:"",...p});switch(a){case"metric":return c({directDistance:i&&mt(e,i),horizontalDistance:s&&mt(e,s),verticalDistance:o&&ne(e,o)});case"imperial":return c({directDistance:i&&pt(e,i),horizontalDistance:s&&pt(e,s),verticalDistance:o&&se(e,o)});default:return c({directDistance:i&&U(e,i,a),horizontalDistance:s&&U(e,s,a),verticalDistance:o&&U(e,o,a)})}}_updateSegmentStripeLength(e){const t=this._segmentVisualElement;e!=null?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}get _actualVisualElementsOrientation(){if(this._triangleOrientationOverride!=null)return this._triangleOrientationOverride;const e=this.visualElementOrientation;return e===0?this.view.state.camera.aboveGround?1:2:e}_requiresGeodesicGuideAt(e){const t=this.view;if(!t?.state)return!1;const i=t.state.camera,s=t.renderCoordsHelper;if(!s)return!1;const o=i.computeScreenPixelSizeAt(e);return s.getAltitude(e)/o>=10}get _measurementArrowStripeLength(){const{result:e,unit:t}=this.analysisView;if(e==null)return null;let i=null;const s=e.directDistance;switch(t){case"metric":i=s&&D(s,"meters");break;case"imperial":i=s&&D(s,It(s.value,s.unit));break;default:i=s&&D(s,t)}return i==null?null:ee(i.value/30)*Wt(1,i.unit,"meters")}_updateMessageBundle(){this.loadingMessages=!0,Zt("esri/core/t9n/Units").then(e=>{this.messages=e}).finally(()=>{this.loadingMessages=!1})}get testData(){}};function ci(e,t,i,s,o){const a=B(e,i,o,gi),c=B(e,t,o,_i);if(a==null||c==null)return null;const p=o.projectToRenderScreen(i,pi),d=o.projectToRenderScreen(t,mi),l={segment:"bottom",horizontal:"top",vertical:p==null||d==null||p[0]<d[0]?"left":"right"};if(gt(a,c)>=Ct){const u=Math.sign(a[1])===Math.sign(c[1]);l.segment=u?vt(l.vertical):l.vertical}else{const u=vi;B(i,t,o,u),gt(u,c)>=Ct&&(l.segment=Math.sign(u[0])===Math.sign(c[0])?vt(l.horizontal):l.horizontal)}if(s===2){const u=h=>h==="top"?"bottom":"top";l.segment=u(l.segment),l.horizontal=u(l.horizontal),l.vertical=u(l.vertical)}return l}n([r()],w.prototype,"_parameters",null),n([r()],w.prototype,"_triangleOrientationOverride",void 0),n([r()],w.prototype,"messages",void 0),n([r()],w.prototype,"view",void 0),n([r()],w.prototype,"analysis",void 0),n([r()],w.prototype,"analysisView",void 0),n([r()],w.prototype,"loadingMessages",void 0),n([r()],w.prototype,"visible",null),n([r()],w.prototype,"viewMode",null),n([r()],w.prototype,"actualVisualizedMeasurement",null),n([r()],w.prototype,"visualElementOrientation",void 0),n([r()],w.prototype,"triangleCollapseRatioThreshold",void 0),n([r()],w.prototype,"allowVisualElementsOrientationChange",null),n([r()],w.prototype,"labels",null),n([r()],w.prototype,"_labelsText",null),n([r()],w.prototype,"_actualVisualElementsOrientation",null),n([r()],w.prototype,"_measurementArrowStripeLength",null),w=n([I("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],w);const Ct=Math.cos(ie(12)),pi=St(),mi=St(),gi=ot(),_i=ot(),vi=ot();let v=class extends rt{constructor(e){super(e),this.cursorPoint=null,this._visible=!1,this._laserLine=null,this.laserLineEnabled=!0,this._lastDraggedHandle=null}initialize(){this._laserLine=new je({view:this.view,attached:!0,isDecoration:!0}),this._updateVisibility(this._visible),this._connectToAnalysisView(),this.addHandles(P(()=>this._params,({laserLineGlowColor:e,laserLineInnerColor:t,laserLineGlobalAlpha:i})=>{const s=this._laserLine,o=s.style;s.style={...o,innerColor:t,glowColor:e,globalAlpha:i}}))}destroy(){this._laserLine=S(this._laserLine)}get _params(){const{accentColor:e}=this.view.effectiveTheme;return{laserLineGlowColor:Pt.toUnitRGB(e),laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:Pt.toUnitRGB(nt(e)),laserLineInnerWidth:.75,laserLineGlobalAlpha:.75*e.a,handleColor:Mt(e,.5),handleRadius:5}}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get testData(){}get _cursorPosition(){const e=C(),t=this.cursorPoint;return t&&this.view.renderCoordsHelper.toRenderCoords(t,e),e}get _startPosition(){const e=C(),t=this.analysis.startPoint;return t&&this.view.renderCoordsHelper.toRenderCoords(t,e),e}get _endPosition(){const e=C(),t=this.analysis.endPoint;return t&&this.view.renderCoordsHelper.toRenderCoords(t,e),e}get _laserLineParams(){const e=this._focusPosition,{active:t,lineState:i}=this.toolState,s=this.analysisViewData,o=this.laserLineEnabled&&!!e&&i!=="measured"&&t;if(!o||!this.visible||s==null||s.destroyed)return{heightManifoldTarget:null,pointDistanceLine:null,lineVerticalPlaneSegment:null};const a=s.actualVisualizedMeasurement,c=this.view.viewingMode!=="local"&&o&&!!this.analysis.startPoint&&a==="geodesic",p=o&&s.viewMode===2;return{heightManifoldTarget:a==="euclidean"?e:null,pointDistanceLine:c?this._pointDistanceLine:null,lineVerticalPlaneSegment:p?Ge(this._startPosition,this._endPosition):null}}get _focusPosition(){const{lineState:e}=this.toolState,t=this.analysisViewData,i=t!=null&&!t.destroyed&&t.measurementMode===1&&t.viewMode===1;switch(e){case"drawing":return i?this._startPosition:this.analysis.endPoint?this._endPosition:this._startPosition;case"editing":return i?this._lastDraggedHandle==="start"?this._endPosition:this._startPosition:this._lastDraggedHandle==="start"?this._startPosition:this._endPosition;default:return this.cursorPoint!=null?this._cursorPosition:null}}get _pointDistanceLine(){return{origin:this.toolState.lineState==="drawing"||this._lastDraggedHandle==="end"?this._startPosition:this._endPosition,target:this._focusPosition}}createManipulators(){const e=this._params,{view:t}=this,i=()=>{const h=Ut(e.handleColor),m=[new Nt(Se(h,1,32,32))],g=new dt({view:t,renderObjects:m});return g.available=!1,g.radius=e.handleRadius,[g,h]},[s,o]=i(),[a,c]=i(),p=new dt({view:this.view,available:!1,interactive:!1});this.analysis.startPoint!=null&&(s.location=this.analysis.startPoint,s.available=!0),this.analysis.endPoint!=null&&(a.location=this.analysis.endPoint,a.available=!0);const d=()=>{let h=this._lastDraggedHandle;s.grabbing&&!a.grabbing&&(h="start"),a.grabbing&&!s.grabbing&&(h="end"),s.grabbing||a.grabbing||(h=null),this._lastDraggedHandle=h},l=s.events.on("grab-changed",d),u=a.events.on("grab-changed",d);return this.addHandles([l,u,P(()=>te(this._params.handleColor),h=>{o.setParameters({color:h}),c.setParameters({color:h})},{equals:st})],"manipulators"),{start:s,end:a,cursor:p}}show(){this.destroyed||this._visible||this._updateVisibility(!0)}hide(){!this.destroyed&&this._visible&&this._updateVisibility(!1)}_connectToAnalysisView(){this.removeHandles("analysis-view"),this.addHandles([P(()=>this.analysisViewData?.destroyed,e=>{e&&this.removeHandles("analysis-view")},F),P(()=>[this.toolState.lineState==="measured",this.analysisViewData],([e,t])=>{t==null||t.destroyed||(t.allowVisualElementsOrientationChange=!e)},F),P(()=>this._laserLineParams,e=>{const t=this._laserLine;t.heightManifoldTarget=e.heightManifoldTarget,t.pointDistanceLine=e.pointDistanceLine,t.lineVerticalPlaneSegment=e.lineVerticalPlaneSegment},F)],"analysis-view")}_updateVisibility(e){this.initialized&&(this._visible=e,e&&(this._laserLine.style={innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,glowFalloff:this._params.laserLineGlowFalloff,globalAlpha:this._params.laserLineGlobalAlpha}),this._laserLine.visible=e)}};n([r({constructOnly:!0})],v.prototype,"view",void 0),n([r()],v.prototype,"_params",null),n([r({constructOnly:!0})],v.prototype,"analysis",void 0),n([r({constructOnly:!0})],v.prototype,"analysisViewData",void 0),n([r()],v.prototype,"cursorPoint",void 0),n([r()],v.prototype,"toolState",void 0),n([r()],v.prototype,"visible",null),n([r()],v.prototype,"testData",null),n([r()],v.prototype,"_visible",void 0),n([r()],v.prototype,"_laserLine",void 0),n([r({constructOnly:!0})],v.prototype,"laserLineEnabled",void 0),n([r()],v.prototype,"_cursorPosition",null),n([r()],v.prototype,"_startPosition",null),n([r()],v.prototype,"_endPosition",null),n([r()],v.prototype,"_lastDraggedHandle",void 0),n([r()],v.prototype,"_laserLineParams",null),n([r()],v.prototype,"_focusPosition",null),n([r()],v.prototype,"_pointDistanceLine",null),v=n([I("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DView")],v);let y=class extends ke{constructor(e){super(e),this._updatingHandles=new xe,this._snappingManagerResult=null,this._emulatedDrag=null,this.lineState="initial",this.removeIncompleteOnCancel=!1,this.startPointSurfaceLocation=null,this.endPointSurfaceLocation=null,this.cursorPointSurfaceLocation=null,this.startManipulator=null,this.endManipulator=null,this.cursorManipulator=null,this._getSnappingContext=Ae(t=>new Ye({elevationInfo:{mode:"absolute-height",offset:0},pointer:t,editGeometryOperations:new Fe(new qe("point",Be(!0,!1,this.view.spatialReference)),this.view.state.viewingMode),visualizer:new ze}))}initialize(){const{view:e,analysis:t,analysisViewData:i,visible:s}=this;this.measurementView=new v({toolState:this,view:e,analysis:t,analysisViewData:i,visible:s});const{start:o,end:a,cursor:c}=this.measurementView.createManipulators(),p=(d,l,u)=>{const h=Ue(d,(m,g,f,V)=>{const $=He(m),E=this._ensureSnappingManager(),z=this._getSnappingContext(V),A=this._updatingHandles,{lineState:G}=this;f=f.next($).next(Ne(this,[u,l])).next(b=>{if(l!=="cursorPoint"){const L=this.analysis[l];L!=null&&(m.location=L)}return b});const M=Re(this.view),H=b=>{const L=M(b);return L||this.lineState!=="drawing"&&this.lineState!=="initial"||(this[l]=null,this[u]=null),L};let x=g.next($).next(H);if(V!=="touch"||G==="editing"){const{snappingStep:b,cancelSnapping:L}=Je({snappingManager:E,snappingContext:z,updatingHandles:A});f=f.next(L),x=x.next(...b)}x.next(b=>b.action!=="start"?b:null).next(b=>{const L=Ve(b.mapEnd,new Qt);this[l]=L,m.location=L,this[u]=this._surfaceLocation(L,b.surfaceType)})});return l==="cursorPoint"?[h]:[h,d.events.on("grab-changed",()=>{const m=o.grabbing||a.grabbing;this.lineState=m?"editing":"measured"}),P(()=>this.analysis[l],m=>{m&&(d.location=m)})]};this.startManipulator=o,this.endManipulator=a,this.cursorManipulator=c,this.manipulators.add(o),this.manipulators.add(a),this.manipulators.add(c),this.addHandles([...p(o,"startPoint","startPointSurfaceLocation"),...p(a,"endPoint","endPointSurfaceLocation"),...p(c,"cursorPoint","cursorPointSurfaceLocation"),jt(()=>this.state==="measured",()=>{this.finishToolCreation(),this.active&&(this.view.activeTool=null)},O),P(()=>({startPointAvailable:this.startPoint!=null,endPointAvailable:this.endPoint!=null}),({startPointAvailable:d,endPointAvailable:l})=>{this.startManipulator.available=d,this.endManipulator.available=l},O)]),Kt(this)}destroy(){this._updatingHandles=S(this._updatingHandles),this.measurementView=S(this.measurementView)}get _snappingManager(){return this._snappingManagerResult?.snappingManager}_ensureSnappingManager(){if(this._snappingManagerResult==null){const e=Ke(this.view);this._snappingManagerResult=e,this.addHandles(e)}return this._snappingManagerResult.snappingManager}get state(){const{analysis:e}=this;if(e.startPoint==null&&e.endPoint==null)return"ready";const{lineState:t}=this;return this.validMeasurement&&t!=="editing"&&t!=="drawing"?"measured":"measuring"}get cursor(){return!this.active||this.state!=="ready"&&this.lineState==="measured"?null:"crosshair"}get startPoint(){return this.analysis.startPoint}set startPoint(e){this.analysis.startPoint=e}get endPoint(){return this.analysis.endPoint}set endPoint(e){this.analysis.endPoint=e}get cursorPoint(){return this.measurementView.cursorPoint}set cursorPoint(e){this.measurementView.cursorPoint=e}get snappingOptions(){return this._snappingManager?.options}get validMeasurement(){return this.analysis.startPoint!=null&&this.analysis.endPoint!=null}get updating(){return this._updatingHandles.updating||!!this._snappingManager?.updating}resetCreated(){super.resetCreated(),this.lineState="initial",this.cursorPoint=null,this.state==="measured"&&this.finishToolCreation()}onShow(){this.measurementView.show()}onHide(){this.measurementView.hide()}onDeactivate(){this._emulatedDrag?.cancel(),this._emulatedDrag=null}onInputEvent(e){switch(e.type){case"immediate-click":this._handleImmediateClick(e);break;case"pointer-move":this._handlePointerMove(e)}}_handlePointerMove(e){if(!this.active||this.view.navigating)return;const{pointerType:t}=e;if(t!=="mouse")return;const i=lt(e),{lineState:s,cursorManipulator:o,endManipulator:a}=this;let c=!1;this.cursorPoint==null&&(this._emulatedDrag?.cancel(),this._emulatedDrag=it(o,t,i),c=!0),s==="initial"&&(this._emulatedDrag?.update(i),c=!0),s==="drawing"&&(a.events.emit("drag",{action:"update",start:i,screenPoint:i}),c=!0),c&&e.stopPropagation()}_handleImmediateClick(e){if(!this.active||!Te(e))return;const t=lt(e),{pointerType:i}=e,{cursorManipulator:s,startManipulator:o,endManipulator:a,lineState:c}=this;let p=!1;switch(this.cursorPoint==null&&(this._emulatedDrag?.cancel(),this._emulatedDrag=it(s,i,t)),c){case"initial":if(this._emulatedDrag?.update(t),this.cursorPoint!=null){this._emulatedDrag?.end(t),this._emulatedDrag=null,this.endPoint=null;const{cursorPoint:d}=this;this.startPoint=d,this.startPointSurfaceLocation=this.cursorPointSurfaceLocation,o.location=d,o.interactive=!1,a.interactive=!1,this.lineState="drawing",this._emulatedDrag=it(a,i,t),p=!0}break;case"drawing":this._emulatedDrag?.update(t),this.endPoint!=null&&(this._emulatedDrag?.end(t),this._emulatedDrag=null,o.interactive=!0,a.interactive=!0,this.lineState="measured",p=!0)}p&&e.stopPropagation()}_surfaceLocation(e,t){return t===0?"on-the-surface":(e.z??0)>=this._getElevation(e)?"above-the-surface":"below-the-surface"}_getElevation(e){return this.view.basemapTerrain.ready?Rt(this.view.elevationProvider,e)??0:0}get test(){}};function it(e,t,i){return e.events.emit("drag",{action:"start",pointerType:t,start:i,screenPoint:i}),{update:s=>e.events.emit("drag",{action:"update",start:s,screenPoint:s}),end:s=>e.events.emit("drag",{action:"end",start:s,screenPoint:s}),cancel:()=>e.events.emit("drag",{action:"cancel"})}}n([r()],y.prototype,"_snappingManagerResult",void 0),n([r()],y.prototype,"_snappingManager",null),n([r({readOnly:!0})],y.prototype,"state",null),n([r()],y.prototype,"lineState",void 0),n([r({readOnly:!0})],y.prototype,"cursor",null),n([r()],y.prototype,"startPoint",null),n([r()],y.prototype,"endPoint",null),n([r()],y.prototype,"cursorPoint",null),n([r({constructOnly:!0})],y.prototype,"analysis",void 0),n([r({constructOnly:!0})],y.prototype,"analysisViewData",void 0),n([r()],y.prototype,"measurementView",void 0),n([r()],y.prototype,"removeIncompleteOnCancel",void 0),n([r({constructOnly:!0})],y.prototype,"view",void 0),n([r({readOnly:!0})],y.prototype,"validMeasurement",null),n([r({value:null})],y.prototype,"startPointSurfaceLocation",void 0),n([r({value:null})],y.prototype,"endPointSurfaceLocation",void 0),n([r({value:null})],y.prototype,"cursorPointSurfaceLocation",void 0),n([r()],y.prototype,"updating",null),y=n([I("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],y);let _=class extends Tt{constructor(e){super(e),this.type="direct-line-measurement-view-3d",this.analysis=null,this.tool=null,this.result=null,this.measurementMode=0,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null,this.userOperation=null}initialize(){const{analysis:e,view:t}=this;this._analysisVisualization=new w({view:t,analysis:e,analysisView:this}),this.addResolvingPromise(Xt().then(i=>{this.destroyed||(this._analysisController=new T({view:t,analysis:e,viewData:this,geodesicLengthMeasurementUtils:i}))})),this.addHandles(Ie(this,y))}destroy(){We(this),this.userOperation=At(this.userOperation),this._analysisController=S(this._analysisController),this._analysisVisualization=S(this._analysisVisualization)}get updating(){return!!this._analysisVisualization?.loadingMessages}get visible(){return super.visible}set visible(e){super.visible=e}get interactive(){return super.interactive}set interactive(e){super.interactive=e}get viewMode(){return this._analysisVisualization.viewMode}get actualVisualizedMeasurement(){return this._analysisVisualization.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisVisualization.visualElementOrientation}set visualElementOrientation(e){this._analysisVisualization.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisVisualization.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisVisualization.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}get directLabelText(){return this._analysisVisualization.labels.direct?.text??""}get horizontalLabelText(){return this._analysisVisualization.labels.horizontal?.text??""}get verticalLabelText(){return this._analysisVisualization.labels.vertical?.text??""}get unit(){return this.analysis.unit??xt(this.view)}get testData(){}place(e){return Qe(this,{placementOptions:e})}};n([r()],_.prototype,"_analysisVisualization",void 0),n([r()],_.prototype,"_analysisController",void 0),n([r()],_.prototype,"updating",null),n([r({readOnly:!0})],_.prototype,"type",void 0),n([r({constructOnly:!0,nonNullable:!0})],_.prototype,"analysis",void 0),n([r()],_.prototype,"tool",void 0),n([r()],_.prototype,"result",void 0),n([r()],_.prototype,"measurementMode",void 0),n([r()],_.prototype,"elevationAlignedStartPoint",void 0),n([r()],_.prototype,"elevationAlignedEndPoint",void 0),n([r({readOnly:!0})],_.prototype,"viewMode",null),n([r({readOnly:!0})],_.prototype,"actualVisualizedMeasurement",null),n([r()],_.prototype,"visualElementOrientation",null),n([r()],_.prototype,"allowVisualElementsOrientationChange",null),n([r()],_.prototype,"triangleCollapseRatioThreshold",null),n([r({readOnly:!0})],_.prototype,"directLabelText",null),n([r({readOnly:!0})],_.prototype,"horizontalLabelText",null),n([r({readOnly:!0})],_.prototype,"verticalLabelText",null),n([r()],_.prototype,"unit",null),n([r()],_.prototype,"userOperation",void 0),_=n([I("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],_);const Wa=_,yi=Object.freeze(Object.defineProperty({__proto__:null,build:$t},Symbol.toStringTag,{value:"Module"}));export{Wa as default};
