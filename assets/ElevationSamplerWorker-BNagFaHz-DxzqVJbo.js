import{l as f}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{z as a}from"./PooledRBush-Dco5QkUp-DX3CMhf3.js";import{r as u}from"./MeshLocalVertexSpace-BGd1IdEs-C0HJG4wR.js";import{m as l}from"./vertexSpaceConversion-DwAXLcxI-BXQ2PRg6.js";import"./collectionUtils-jDyktm0P-BDP2Oq99.js";import"./index-B0z_nLWi.js";import"./Point-BfTTZoMu-DeJwQYfh.js";import"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import"./Extent-CgDMOSRD-Bod5LY6s.js";import"./Color-CERqXxxY-BuYn26eI.js";import"./mathUtils-PIGhLnI9-B1tKUlUb.js";import"./Polygon-D6wEPb3W-D2MPjRU4.js";import"./mat4-C96X-Nn0-BrMLOLCb.js";import"./mat4f64-q_b6UJoq-Dh6sWB_w.js";import"./vec32-CewSdTn3-VRto2OOh.js";import"./spatialReferenceEllipsoidUtils-D2JabnKt-Ce3ED0lc.js";import"./projectionUtils-BGH_5_I3-DGwchVO8.js";import"./Polyline-CoiTLswR-DTxpB2Yg.js";import"./vec3-B_phcnZY-DHC7I6xa.js";import"./BufferView-Cj2sQaht-avJ4OGB_.js";import"./vec42-B8VM4vXb-B6OGOEI9.js";import"./vec2f64-rIxtbMRN-Kai9mK1i.js";import"./vec4f64-DPb6J-GU-C7c2DqbZ.js";import"./vec4-B7mYuNMQ-ChTBJPnP.js";import"./quickselect-QQC62dOK-Br2Ahhru.js";import"./computeTranslationToOriginAndRotation-Bjd4esRf-vJ4LbdOU.js";import"./projectPointToVector-DL7Z4uvb-CPbOlZdQ.js";import"./meshVertexSpaceUtils-CtG7DPVT-kybwngCt.js";import"./reader-DcGs6kKN-DHJfK-tm.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";import"./aaBoundingRect-CjwcS2F3-ri8bmh30.js";class K{async createIndex(t,e){const o=new Array;if(!t.vertexAttributes?.position)return new a;const n=d(t),m=e!=null?await e.invoke("createIndexThread",n,{transferList:o}):this.createIndexThread(n).result;return s().fromJSON(m)}createIndexThread(t){const e=s();if(!t)return{result:e.toJSON()};const o=new Float64Array(t.position);return t.components?h(e,o,t.components.map(n=>new Uint32Array(n))):x(e,o)}}function x(r,t){const e=new Array(t.length/9);let o=0;for(let n=0;n<t.length;n+=9)e[o++]=c(t,n,n+3,n+6);return r.load(e),{result:r.toJSON()}}function h(r,t,e){let o=0;for(const i of e)o+=i.length/3;const n=new Array(o);let m=0;for(const i of e)for(let p=0;p<i.length;p+=3)n[m++]=c(t,3*i[p],3*i[p+1],3*i[p+2]);return r.load(n),{result:r.toJSON()}}function d(r){const{vertexAttributes:{position:t},vertexSpace:e,spatialReference:o,transform:n}=r,m=l({vertexAttributes:{position:t},vertexSpace:e,spatialReference:o,transform:n},u.absolute,{allowBufferReuse:!0})?.position;return m?!r.components||r.components.some(i=>!i.faces)?{position:m.buffer}:{position:m.buffer,components:r.components.map(i=>i.faces)}:null}function s(){return new a(9,f("esri-csp-restrictions")?r=>r:[".minX",".minY",".maxX",".maxY"])}function c(r,t,e,o){return{minX:Math.min(r[t],r[e],r[o]),maxX:Math.max(r[t],r[e],r[o]),minY:Math.min(r[t+1],r[e+1],r[o+1]),maxY:Math.max(r[t+1],r[e+1],r[o+1]),p0:[r[t],r[t+1],r[t+2]],p1:[r[e],r[e+1],r[e+2]],p2:[r[o],r[o+1],r[o+2]]}}export{K as default};
