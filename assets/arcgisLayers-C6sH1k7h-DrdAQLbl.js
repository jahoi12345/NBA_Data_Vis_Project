const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/GroupLayer-DCfV8r3C-C8kLPbN6.js","assets/index-CTl7hdrJ.js","assets/index-Cv2ko1Ob.css","assets/jsonMap-Bs3hmeCU-Cusd0Fmz.js","assets/CollectionFlattener-D6h2Fkvj-qnUHjb1M.js","assets/collectionUtils-jDyktm0P-ArdXNs6F.js","assets/Point-BfTTZoMu-BAT2Wq6O.js","assets/reader-DcGs6kKN-DHJfK-tm.js","assets/reactiveUtils-SO2Ko3sy-BCLX8Jdy.js","assets/Extent-CgDMOSRD-CU1qE5Kr.js","assets/SimpleObservable-CvFyr0NA-DXpoMYph.js","assets/loadAll-BCyxerwc-DK9uHnLK.js","assets/asyncUtils-w6KfWU41-HenJ0UOu.js","assets/MultiOriginJSONSupport-Bd1TKmh_-BHNF5tHX.js","assets/Layer-DZvC7bne-m1cEC_yw.js","assets/date-IqUzANpt-bLKO9IDT.js","assets/BlendLayer-HE_aYHHW-CZa4IAJu.js","assets/layerContainerType-CSXZNpHb-BIF7XAYP.js","assets/jsonUtils-CY6YsQMo-SliJcuqs.js","assets/Color-CERqXxxY-BuYn26eI.js","assets/mathUtils-PIGhLnI9-B1tKUlUb.js","assets/screenUtils-BitdhK1O-L0FLPAMi.js","assets/mat4f32-Djp3mnm5-DzYG3LYB.js","assets/mat4-C96X-Nn0-Do6fKsNS.js","assets/Polygon-D6wEPb3W-CpL9Efjx.js","assets/aaBoundingRect-CjwcS2F3-D7aII9DY.js","assets/OperationalLayer-B6zbJ5nR-sYdHUfAL.js","assets/ElevationInfo-Cw2HaA6E-Br1RWTYu.js","assets/lengthUtils-Dt1_RvOO-bleznLOi.js","assets/unitConversionUtils-4vB4Ezlp-B0eWR3Ls.js","assets/opacityUtils-DuFH0EC9-DWspTgn2.js","assets/PortalLayer-CbFNhtZ4-CCXE0v4V.js","assets/layerUtils-DZGhvm-W-DLw3QMll.js","assets/PortalItem-DnxMlRVo-Dhq4alsp.js","assets/portalItemUtils-CaPNUJg6-JsqddoLx.js","assets/projectionUtils-BGH_5_I3-BySNUA-B.js","assets/Polyline-CoiTLswR-BLagWJLS.js","assets/ScaleRangeLayer-DQr2T3Hh-Dh1UYk4i.js","assets/layersCreator-CzVBH43O-CUZWEtWW.js","assets/loadUtils-CsdEVatB-CNXJGHBW.js","assets/fetchService-Bb67nyFD-D3deLDTw.js","assets/associatedFeatureServiceUtils-BBHOCEqH-Bd4iLAWO.js","assets/lazyLayerLoader-3N9j85rv-B0M-59EP.js","assets/portalLayers-CuUf8b9P-DkyLEy57.js","assets/styleUtils-CZJC3pZm-BNE6B1Si.js","assets/TablesMixin-Q80MT3nU-CFBTh0j7.js","assets/tagSymbols-BPcGfZon-BPcGfZon.js","assets/saveUtils-BO8L-Vl8-bXGcqq8I.js","assets/writeUtils-DEFpwIW1-D44H3UWs.js"])))=>i.map(i=>d[i]);
import{H as U,_ as I}from"./index-CTl7hdrJ.js";import{I as m}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{p as L,h as P,I as g,q as O}from"./Point-BfTTZoMu-BAT2Wq6O.js";import{M as T}from"./associatedFeatureServiceUtils-BBHOCEqH-Bd4iLAWO.js";import{y as p,O as d,F}from"./fetchService-Bb67nyFD-D3deLDTw.js";import{d as h,B as w}from"./layerUtils-DZGhvm-W-DLw3QMll.js";import{u as D}from"./lazyLayerLoader-3N9j85rv-B0M-59EP.js";import"./collectionUtils-jDyktm0P-ArdXNs6F.js";import"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import"./Extent-CgDMOSRD-CU1qE5Kr.js";import"./PortalItem-DnxMlRVo-Dhq4alsp.js";import"./Layer-DZvC7bne-m1cEC_yw.js";import"./date-IqUzANpt-bLKO9IDT.js";import"./reader-DcGs6kKN-DHJfK-tm.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";const C=(e,a=C,s=a.f||(a.f=["assets/GroupLayer-DCfV8r3C.js","assets/index-BzxsWNRw.js","assets/index-Cv2ko1Ob.css","assets/jsonMap-Bs3hmeCU.js","assets/CollectionFlattener-D6h2Fkvj.js","assets/collectionUtils-jDyktm0P.js","assets/Point-BfTTZoMu.js","assets/reader-DcGs6kKN.js","assets/reactiveUtils-SO2Ko3sy.js","assets/Extent-CgDMOSRD.js","assets/SimpleObservable-CvFyr0NA.js","assets/loadAll-BCyxerwc.js","assets/asyncUtils-w6KfWU41.js","assets/MultiOriginJSONSupport-Bd1TKmh_.js","assets/Layer-DZvC7bne.js","assets/date-IqUzANpt.js","assets/BlendLayer-HE_aYHHW.js","assets/layerContainerType-CSXZNpHb.js","assets/jsonUtils-CY6YsQMo.js","assets/Color-CERqXxxY.js","assets/mathUtils-PIGhLnI9.js","assets/screenUtils-BitdhK1O.js","assets/mat4f32-Djp3mnm5.js","assets/mat4-C96X-Nn0.js","assets/Polygon-D6wEPb3W.js","assets/aaBoundingRect-CjwcS2F3.js","assets/OperationalLayer-B6zbJ5nR.js","assets/ElevationInfo-Cw2HaA6E.js","assets/lengthUtils-Dt1_RvOO.js","assets/unitConversionUtils-4vB4Ezlp.js","assets/opacityUtils-DuFH0EC9.js","assets/PortalLayer-CbFNhtZ4.js","assets/layerUtils-DZGhvm-W.js","assets/PortalItem-DnxMlRVo.js","assets/portalItemUtils-CaPNUJg6.js","assets/projectionUtils-BGH_5_I3.js","assets/Polyline-CoiTLswR.js","assets/ScaleRangeLayer-DQr2T3Hh.js","assets/layersCreator-CzVBH43O.js","assets/loadUtils-CsdEVatB.js","assets/fetchService-Bb67nyFD.js","assets/associatedFeatureServiceUtils-BBHOCEqH.js","assets/lazyLayerLoader-3N9j85rv.js","assets/portalLayers-CuUf8b9P.js","assets/styleUtils-CZJC3pZm.js","assets/TablesMixin-Q80MT3nU.js","assets/tagSymbols-BPcGfZon.js","assets/saveUtils-BO8L-Vl8.js","assets/writeUtils-DEFpwIW1.js"]))=>e.map(t=>s[t]),N={FeatureLayer:!0,SceneLayer:!0,VideoLayer:!0};async function se(e){const{properties:a,url:s}=e,t={...a,url:s},l=await E(s,a?.customParameters),{Constructor:r,layerId:i,sourceJSON:c,parsedUrl:f,layers:n,tables:o}=l;if(n.length+o.length===0)return i!=null&&(t.layerId=i),c!=null&&(t.sourceJSON=c),new r(t);const u=new(await U(async()=>{const{default:y}=await I(()=>import("./GroupLayer-DCfV8r3C-C8kLPbN6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48]));return{default:y}},C([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48]))).default({title:f.title});return await B(u,l,t),u}function j(e,a){return e?e.find(({id:s})=>s===a):null}function S(e,a,s,t,l){const r={...l,layerId:a};return e!=null&&(r.url=e),s!=null&&(r.sourceJSON=s),"sublayerTitleMode"in t.prototype&&(r.sublayerTitleMode="service-name"),new t(r)}async function B(e,a,s){const t=a.sublayerConstructorProvider;for(const{id:l,serverUrl:r}of a.layers){const i=j(a.sublayerInfos,l),c=S(r,l,i,(i&&t?.(i))??a.Constructor,s);e.add(c)}if(a.tables.length){const l=await v("FeatureLayer");a.tables.forEach(({id:r,serverUrl:i})=>{const c=S(i,r,j(a.tableInfos,r),l,s);e.tables.add(c)})}}async function E(e,a){let s=L(e);if(s==null&&(s=await _(e,a)),s==null)throw new m("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});const{serverType:t,sublayer:l}=s;let r;const i={FeatureServer:"FeatureLayer",KnowledgeGraphServer:"KnowledgeGraphLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer",VideoServer:"VideoLayer"},c=t==="FeatureServer",f=t==="SceneServer",n={parsedUrl:s,Constructor:null,layerId:c||f?l??void 0:void 0,layers:[],tables:[]};switch(t){case"MapServer":if(l!=null){const{type:o}=await p(e,{customParameters:a});switch(r="FeatureLayer",o){case"Catalog Layer":r="CatalogLayer";break;case"Catalog Dynamic Group Layer":throw new m("arcgis-layers:unsupported",`fromUrl() not supported for "${o}" layers`)}}else r=await H(e,a)?"TileLayer":"MapImageLayer";break;case"ImageServer":{const o=await p(e,{customParameters:a}),{tileInfo:u,cacheType:y}=o;r=u?u?.format?.toUpperCase()!=="LERC"||y&&y.toLowerCase()!=="elevation"?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const o=await p(s.url.path,{customParameters:a});if(r="SceneLayer",o){const u=o?.layers;if(o?.layerType==="Voxel")r="VoxelLayer";else if(u?.length){const y=u[0]?.layerType;y!=null&&w[y]!=null&&(r=w[y])}}break}case"3DTilesServer":throw new m("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(r="FeatureLayer",l!=null){const o=await p(e,{customParameters:a});n.sourceJSON=o,n.preferredUrl=h(),r=d(o.type)}break;default:r=i[t]}if(N[r]&&l==null){const o=await x(e,t,a);if(c&&(n.preferredUrl=o.preferredUrl,n.sublayerInfos=o.layerInfos,n.tableInfos=o.tableInfos),o.layers.length+o.tables.length!==1)n.layers=o.layers,n.tables=o.tables,c&&o.layerInfos?.length&&(n.sublayerConstructorProvider=await M(o.layerInfos));else if(c||f){const u=o.layerInfos?.[0]??o.tableInfos?.[0];if(n.layerId=o.layers[0]?.id??o.tables[0]?.id,n.sourceJSON=u,c){const y=u?.type;r=d(y)}}}return n.Constructor=await v(r),n}async function _(e,a){const s=await p(e,{customParameters:a});let t=null,l=null;const r=s.type;if(r==="Feature Layer"||r==="Table"?(t="FeatureServer",l=s.id??null):r==="indexedVector"?t="VectorTileServer":s.hasOwnProperty("mapName")?t="MapServer":s.hasOwnProperty("bandCount")&&s.hasOwnProperty("pixelSizeX")?t="ImageServer":s.hasOwnProperty("maxRecordCount")&&s.hasOwnProperty("allowGeometryUpdates")?t="FeatureServer":s.hasOwnProperty("streamUrls")?t="StreamServer":b(s)?(t="SceneServer",l=s.id):s.hasOwnProperty("layers")&&b(s.layers?.[0])&&(t="SceneServer"),!t)return null;const i=l!=null?P(e):null;return{title:i!=null&&s.name||O(e),serverType:t,sublayer:l,url:{path:i!=null?i.serviceUrl:g(e).path}}}function b(e){return e!=null&&e.hasOwnProperty("store")&&e.hasOwnProperty("id")&&typeof e.id=="number"}async function x(e,a,s){let t,l,r,i=!1;switch(a){case"FeatureServer":{const n=await F(e,{customParameters:s});r=h(e,{preferredHost:n.preferredHost}),i=!!n.layersJSON,t=n.layersJSON||n.serviceJSON;break}case"SceneServer":{const n=await V(e,s);t=n.serviceInfo,l=n.tableServerUrl;break}default:t=await p(e,{customParameters:s})}const c=t?.layers,f=t?.tables;return{preferredUrl:r,layers:c?.map(n=>({id:n.id})).reverse()||[],tables:f?.map(n=>({serverUrl:l,id:n.id})).reverse()||[],layerInfos:i?c:[],tableInfos:i?f:[]}}async function V(e,a){const s=await p(e,{customParameters:a});if(!s.layers?.[0])return{serviceInfo:s};try{const{serverUrl:t}=await T(e),l=await p(t,{customParameters:a}).catch(()=>null);return l&&(s.tables=l.tables),{serviceInfo:s,tableServerUrl:t}}catch{return{serviceInfo:s}}}async function v(e){return(0,D[e])()}async function H(e,a){return(await p(e,{customParameters:a})).tileInfo}async function M(e){if(!e.length)return;const a=new Set,s=[];for(const{type:r}of e)a.has(r)||(a.add(r),s.push(v(d(r))));const t=await Promise.all(s),l=new Map;return Array.from(a).forEach((r,i)=>{l.set(r,t[i])}),r=>l.get(r.type)}export{se as fromUrl};
