import{F as b,G as y}from"./Polygon-D6wEPb3W-CpL9Efjx.js";import{o as g}from"./vec2f64-rIxtbMRN-Kai9mK1i.js";import{I as D}from"./vec4f64-DPb6J-GU-C7c2DqbZ.js";import{a5 as F}from"./Point-BfTTZoMu-BAT2Wq6O.js";import{g as d}from"./projectionUtils-BGH_5_I3-BySNUA-B.js";import{i as w}from"./DoubleArray-DExKNiTh-CvVpHySW.js";import{g as A,ba as v}from"./Texture-CFNZjV2R-lGBztxVp.js";import{bf as z}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{b as I}from"./BufferView-Cj2sQaht-DuP-iLZg.js";import{g as S}from"./Indices-D0_UQPPr-t1Qev6md.js";import{a as p}from"./orientedBoundingBox-BLEx7wLU-CPBtS4XC.js";function E(t,e=!1){return t<=z?e?new Array(t).fill(0):new Array(t):I(t)}function Z(t,e,r=null){const n=[],o=e.mapPositions,a=T(e,n),u=a.data,s=a.indices.length,i=S(s);return $(e,n,i),_(e,n,i),G(e,n,i),R(e,n,a.indices,i),x(e,n,a.indices,i),C(e,n),H(e,n,a.indices,i),M(e,n,u),new A(t,n,o,2,r)}function T(t,e){const{attributeData:{position:r},removeDuplicateStartEnd:n}=t,o=P(r)&&n,a=r.length/3-(o?1:0),u=new Array(2*(a-1)),s=o?r.slice(0,-3):r;let i=0;for(let l=0;l<a-1;l++)u[i++]=l,u[i++]=l+1;const c=new p(s,u,3,o);return e.push(["position",c]),c}function $(t,e,r){if(t.attributeData.colorFeature!=null)return;const n=t.attributeData.color;e.push(["color",new p(n??D,r,4)])}function G(t,e,r){t.attributeData.normal&&e.push(["normal",new p(t.attributeData.normal,r,3)])}function R(t,e,r,n){const o=t.attributeData.colorFeature;o!=null&&(typeof o=="number"?e.push(["colorFeatureAttribute",new p([o],n,1,!0)]):e.push(["colorFeatureAttribute",new p(o,r,1,!0)]))}function _(t,e,r){t.attributeData.sizeFeature==null&&e.push(["size",new p([t.attributeData.size??1],r,1,!0)])}function x(t,e,r,n){const o=t.attributeData.sizeFeature;o!=null&&(typeof o=="number"?e.push(["sizeFeatureAttribute",new p([o],n,1,!0)]):e.push(["sizeFeatureAttribute",new p(o,r,1,!0)]))}function C(t,e){const{attributeData:{position:r,timeStamps:n}}=t;if(!n)return;const o=r.length/3,a=new Array(2*(o-1));let u=0;for(let s=0;s<o-1;s++)a[u++]=s,a[u++]=s+1;e.push(["timeStamps",new p(n,a,m,!0)])}function H(t,e,r,n){const o=t.attributeData.opacityFeature;o!=null&&(typeof o=="number"?e.push(["opacityFeatureAttribute",new p([o],n,1,!0)]):e.push(["opacityFeatureAttribute",new p(o,r,1,!0)]))}function M(t,e,r){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==1||!t.overlayInfo.spatialReference.isGeographic)return;const n=w(r.length),o=F(t.overlayInfo.spatialReference);for(let f=0;f<n.length;f+=3)d(r,f,n,f,o);const a=r.length/3,u=v(a+1);let s=j,i=k,c=0,l=0;b(s,n[l++],n[l++]),l++,u[0]=0;for(let f=1;f<a+1;++f)f===a&&(l=0),b(i,n[l++],n[l++]),l++,c+=y(s,i),u[f]=c,[s,i]=[i,s];e.push(["distanceToStart",new p(u,e[0][1].indices,1,!0)])}function P(t){const e=t.length;return t[0]===t[e-3]&&t[1]===t[e-2]&&t[2]===t[e-1]}const j=g(),k=g(),m=4;function q(t,e,r,n,o){if(t==null||t.length===0)return[];const a=[];return t.forEach((u,s)=>{const i=u.length,c=w(3*i);u.forEach((f,h)=>{c[3*h]=f[0],c[3*h+1]=f[1],c[3*h+2]=f[2]});const l={attributeData:{position:c,normal:e,colorFeature:r?.[s],opacityFeature:n?.[s],sizeFeature:o?.[s]},removeDuplicateStartEnd:!1};a.push(l)}),a}function tt(t,e,r,n,o,a){if(t==null||t.length===0)return[];const u=q(t,e,n,o,a);return t.forEach((s,i)=>{const c=r?.[i],l=c!=null?B(c.timeStamps,c.streamlineType):void 0;u[i].attributeData.timeStamps=l}),u}function B(t,e){const r=E(t.length*m),n=t[0],o=t[t.length-1];for(let a=0;a<t.length;a++)r[a*m]=t[a],r[a*m+1]=n,r[a*m+2]=o,r[a*m+3]=e+.5;return r}export{E as $,Z as _,q,tt as t};
