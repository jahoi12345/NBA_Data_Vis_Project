const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/libtess-asm-Do2rcCPN-D_llesW9.js","assets/_commonjsHelpers-DCkdB7M8-DwXtFsJ3.js","assets/libtess-Cex5b9U--C6VhzKlA.js"])))=>i.map(i=>d[i]);
import{H as vt,_ as wt}from"./index-B0z_nLWi.js";import{an as Nt}from"./Point-BfTTZoMu-DeJwQYfh.js";import{l as kt}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{J as Et}from"./definitions-Dvg4hMIw-CdK2DzFN.js";const ft=(x,i=ft,s=i.f||(i.f=["assets/libtess-asm-Do2rcCPN.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/libtess-Cex5b9U-.js"]))=>x.map(_=>s[_]),Mt=128e3;let ct=null,Tt=null;async function At(){return ct||(ct=Dt()),ct}async function Dt(){Tt=await(kt("esri-csp-restrictions")?await vt(()=>wt(()=>import("./libtess-asm-Do2rcCPN-D_llesW9.js"),__vite__mapDeps([0,1])),ft([0,1])).then(x=>x.l):await vt(()=>wt(()=>import("./libtess-Cex5b9U--C6VhzKlA.js"),__vite__mapDeps([2,1])),ft([2,1])).then(x=>x.l)).default({locateFile:x=>Nt(`esri/core/libs/libtess/${x}`)})}function Ut(x,i){const s=Math.max(x.length,Mt);return Tt.triangulate(x,i,s)}function Vt(x,i){return x.x===i.x&&x.y===i.y}function Lt(x){if(!x)return;const i=x.length;if(i<=1)return;let s=0;for(let _=1;_<i;_++)Vt(x[_],x[s])||++s===_||(x[s]=x[_]);x.length=s+1}function L(x,i){return x.x=i.y,x.y=-i.x,x}function k(x,i){return x.x=-i.y,x.y=i.x,x}function mt(x,i){return x.x=i.x,x.y=i.y,x}function ut(x,i){return x.x=-i.x,x.y=-i.y,x}function dt(x){return Math.sqrt(x.x*x.x+x.y*x.y)}function Pt(x,i){return x.x*i.y-x.y*i.x}function gt(x,i){return x.x*i.x+x.y*i.y}function Z(x,i,s,_){return x.x=i.x*s+i.y*_,x.y=i.x*_-i.y*s,x}class Ct{constructor(i,s,_){this._writeVertex=i,this._writeTriangle=s,this._canUseThinTessellation=_,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(i,s,_=this._canUseThinTessellation){Lt(i),_&&s.halfWidth<Et&&!s.offset?this._tessellateThin(i,s):this._tessellate(i,s)}_tessellateThin(i,s){if(i.length<2)return;const _=s.wrapDistance||65535;let p=s.initialDistance||0,U=!1,$=i[0].x,X=i[0].y;const P=i.length;for(let C=1;C<P;++C){U&&(U=!1,p=0);let W=i[C].x,q=i[C].y,N=W-$,v=q-X,m=Math.sqrt(N*N+v*v);if(N/=m,v/=m,p+m>_){U=!0;const t=(_-p)/m;m=_-p,W=(1-t)*$+t*W,q=(1-t)*X+t*q,--C}const o=this._writeVertex($,X,0,0,N,v,v,-N,0,-1,p),y=this._writeVertex($,X,0,0,N,v,-v,N,0,1,p);p+=m;const F=this._writeVertex(W,q,0,0,N,v,v,-N,0,-1,p),e=this._writeVertex(W,q,0,0,N,v,-v,N,0,1,p);this._writeTriangle(o,y,F),this._writeTriangle(y,F,e),$=W,X=q}}_tessellate(i,s){const _=i[0],p=i[i.length-1],U=Vt(_,p),$=U?3:2;if(i.length<$)return;const X=s.pixelCoordRatio,P=s.capType!=null?s.capType:0,C=s.joinType!=null?s.joinType:2,W=s.miterLimit!=null?Math.min(s.miterLimit,4):2,q=s.roundLimit!=null?Math.min(s.roundLimit,1.05):1.05,N=s.halfWidth!=null?s.halfWidth:2,v=!!s.textured;let m,o,y,F=null;const e=this._prevNormal,t=this._nextNormal;let z=-1,H=-1;const r=this._joinNormal;let c,u;const it=this._textureNormalLeft,xt=this._textureNormalRight,w=this._textureNormal;let d=-1,l=-1;const at=s.wrapDistance||65535;let a=s.initialDistance||0;const bt=this._writeVertex,pt=this._writeTriangle,f=(E,st,G,T,j,S)=>{const B=bt(o,y,c,u,G,T,E,st,j,S,a);return d>=0&&l>=0&&B>=0&&pt(d,l,B),d=l,l=B,B};U&&(m=i[i.length-2],t.x=p.x-m.x,t.y=p.y-m.y,H=dt(t),t.x/=H,t.y/=H);let K=!1;for(let E=0;E<i.length;++E){if(K&&(K=!1,a=0),m&&(e.x=-t.x,e.y=-t.y,z=H,a+z>at&&(K=!0)),K){const n=(at-a)/z;z=at-a,m={x:(1-n)*m.x+n*i[E].x,y:(1-n)*m.y+n*i[E].y},--E}else m=i[E];o=m.x,y=m.y;const st=E<=0&&!K,G=E===i.length-1;if(st||(a+=z),F=G?U?i[1]:null:i[E+1],F?(t.x=F.x-o,t.y=F.y-y,H=dt(t),t.x/=H,t.y/=H):(t.x=void 0,t.y=void 0),!U){if(st){k(r,t),c=r.x,u=r.y,P===2&&(f(-t.y-t.x,t.x-t.y,t.x,t.y,0,-1),f(t.y-t.x,-t.x-t.y,t.x,t.y,0,1)),P===1&&(f(-t.y-t.x,t.x-t.y,t.x,t.y,-1,-1),f(t.y-t.x,-t.x-t.y,t.x,t.y,-1,1)),P!==1&&P!==0||(f(-t.y,t.x,t.x,t.y,0,-1),f(t.y,-t.x,t.x,t.y,0,1));continue}if(G){L(r,e),c=r.x,u=r.y,P!==1&&P!==0||(f(e.y,-e.x,-e.x,-e.y,0,-1),f(-e.y,e.x,-e.x,-e.y,0,1)),P===2&&(f(e.y-e.x,-e.x-e.y,-e.x,-e.y,0,-1),f(-e.y-e.x,e.x-e.y,-e.x,-e.y,0,1)),P===1&&(f(e.y-e.x,-e.x-e.y,-e.x,-e.y,1,-1),f(-e.y-e.x,e.x-e.y,-e.x,-e.y,1,1));continue}}let T,j,S=-Pt(e,t);if(Math.abs(S)<.01)gt(e,t)>0?(r.x=e.x,r.y=e.y,S=1,T=Number.MAX_VALUE,j=!0):(k(r,t),S=1,T=1,j=!1);else{r.x=(e.x+t.x)/S,r.y=(e.y+t.y)/S,T=dt(r);const n=(T-1)*N*X;j=T>4||n>z&&n>H}c=r.x,u=r.y;let B=C;switch(C){case 0:T<1.05&&(B=2);break;case 1:T<q&&(B=2);break;case 2:T>W&&(B=0)}switch(B){case 2:if(f(r.x,r.y,-e.x,-e.y,0,-1),f(-r.x,-r.y,-e.x,-e.y,0,1),G)break;if(v){const n=K?0:a;d=this._writeVertex(o,y,c,u,t.x,t.y,r.x,r.y,0,-1,n),l=this._writeVertex(o,y,c,u,t.x,t.y,-r.x,-r.y,0,1,n)}break;case 0:{const n=S<0;let g,V,I,M;if(n){const h=d;d=l,l=h,g=it,V=xt}else g=xt,V=it;if(j)I=n?k(this._innerPrev,e):L(this._innerPrev,e),M=n?L(this._innerNext,t):k(this._innerNext,t);else{const h=n?ut(this._inner,r):mt(this._inner,r);I=h,M=h}const D=n?L(this._bevelStart,e):k(this._bevelStart,e);f(I.x,I.y,-e.x,-e.y,g.x,g.y);const nt=f(D.x,D.y,-e.x,-e.y,V.x,V.y);if(G)break;const R=n?k(this._bevelEnd,t):L(this._bevelEnd,t);if(j){const h=this._writeVertex(o,y,c,u,-e.x,-e.y,0,0,0,0,a);d=this._writeVertex(o,y,c,u,t.x,t.y,M.x,M.y,g.x,g.y,a),l=this._writeVertex(o,y,c,u,t.x,t.y,R.x,R.y,V.x,V.y,a),this._writeTriangle(nt,h,l)}else{if(v){const h=this._bevelMiddle;h.x=(D.x+R.x)/2,h.y=(D.y+R.y)/2,Z(w,h,-e.x,-e.y),f(h.x,h.y,-e.x,-e.y,w.x,w.y),Z(w,h,t.x,t.y),d=this._writeVertex(o,y,c,u,t.x,t.y,h.x,h.y,w.x,w.y,a),l=this._writeVertex(o,y,c,u,t.x,t.y,M.x,M.y,g.x,g.y,a)}else{const h=d;d=l,l=h}f(R.x,R.y,t.x,t.y,V.x,V.y)}if(n){const h=d;d=l,l=h}break}case 1:{const n=S<0;let g,V;if(n){const b=d;d=l,l=b,g=it,V=xt}else g=xt,V=it;const I=n?ut(this._inner,r):mt(this._inner,r);let M,D;j?(M=n?k(this._innerPrev,e):L(this._innerPrev,e),D=n?L(this._innerNext,t):k(this._innerNext,t)):(M=I,D=I);const nt=n?L(this._roundStart,e):k(this._roundStart,e),R=n?k(this._roundEnd,t):L(this._roundEnd,t),h=f(M.x,M.y,-e.x,-e.y,g.x,g.y),rt=f(nt.x,nt.y,-e.x,-e.y,V.x,V.y);if(G)break;const O=this._writeVertex(o,y,c,u,-e.x,-e.y,0,0,0,0,a);j||this._writeTriangle(d,l,O);const A=ut(this._outer,I),J=this._writeVertex(o,y,c,u,t.x,t.y,R.x,R.y,V.x,V.y,a);let Q,Y;const yt=T>2;if(yt){let b;T!==Number.MAX_VALUE?(A.x/=T,A.y/=T,b=gt(e,A),b=(T*(b*b-1)+1)/b):b=-1,Q=n?L(this._startBreak,e):k(this._startBreak,e),Q.x+=e.x*b,Q.y+=e.y*b,Y=n?k(this._endBreak,t):L(this._endBreak,t),Y.x+=t.x*b,Y.y+=t.y*b}Z(w,A,-e.x,-e.y);const ot=this._writeVertex(o,y,c,u,-e.x,-e.y,A.x,A.y,w.x,w.y,a);Z(w,A,t.x,t.y);const ht=v?this._writeVertex(o,y,c,u,t.x,t.y,A.x,A.y,w.x,w.y,a):ot,_t=O,lt=v?this._writeVertex(o,y,c,u,t.x,t.y,0,0,0,0,a):O;let tt=-1,et=-1;if(yt&&(Z(w,Q,-e.x,-e.y),tt=this._writeVertex(o,y,c,u,-e.x,-e.y,Q.x,Q.y,w.x,w.y,a),Z(w,Y,t.x,t.y),et=this._writeVertex(o,y,c,u,t.x,t.y,Y.x,Y.y,w.x,w.y,a)),v?yt?(this._writeTriangle(_t,rt,tt),this._writeTriangle(_t,tt,ot),this._writeTriangle(lt,ht,et),this._writeTriangle(lt,et,J)):(this._writeTriangle(_t,rt,ot),this._writeTriangle(lt,ht,J)):yt?(this._writeTriangle(O,rt,tt),this._writeTriangle(O,tt,et),this._writeTriangle(O,et,J)):(this._writeTriangle(O,rt,ot),this._writeTriangle(O,ht,J)),j?(d=this._writeVertex(o,y,c,u,t.x,t.y,D.x,D.y,g.x,g.y,a),l=J):(d=v?this._writeVertex(o,y,c,u,t.x,t.y,D.x,D.y,g.x,g.y,a):h,this._writeTriangle(d,lt,J),l=J),n){const b=d;d=l,l=b}break}}}}}export{At as D,Ct as R,Ut as S};
