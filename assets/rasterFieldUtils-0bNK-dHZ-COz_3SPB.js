import{o as x}from"./Field-Cm_ZejYW-CwJZmSru.js";const V="Raster.",l="Raster.Dim.",$=".Max",u={servicePixelValue:"Raster.ServicePixelValue",rawServicePixelValue:"Raster.ServicePixelValue.Raw",itemPixelValue:"Raster.ItemPixelValue",magnitude:"Raster.Magnitude",direction:"Raster.Direction",variable:"Raster.Variable"},w=new Map([["quarters","Quarter"],["months","Month"],["weeks","Week of the year"],["days","Day of the year"]]);function m(e,a){return new x({name:e,alias:a,domain:null,editable:!1,length:50,type:"string"})}function d(e,a){return new x({name:e,alias:a,domain:null,editable:!1,type:"double"})}function P(e,a){return new x({name:e,alias:a,domain:null,editable:!1,type:"date"})}function S(e){return m(u.servicePixelValue,e??"Service Pixel Value")}function y(e){return m(u.rawServicePixelValue,e??"Raw Service Pixel Value")}function R(){return m(u.itemPixelValue,"Item Pixel Value")}function M(e){return m(`${u.servicePixelValue}.${e}`,e)}function I(e){return d(`${u.magnitude}`,"Magnitude"+(e?` (${e})`:""))}function D(){return d(`${u.direction}`,"Direction (Â°)")}function E(e){return e.fields.filter(a=>a.type!=="oid"&&a.name.toLowerCase()!=="value").map(a=>{const n=a.clone();return n.name=`${V}${a.name}`,n})}function N(e){const a=new Set,n=new Set,t=new Map;return e.variables.forEach(({dimensions:i})=>{i.forEach(r=>{if(r.recurring)t.set(r.name,r.unit);else{const o=r.unit?.trim()==="ISO8601"||r.name?.trim()?.toLowerCase()==="stdtime"?a:n;o.add(r.name),r.hasRanges&&o.add(`${r.name}${$}`)}})}),[m(u.variable,"Variable"),...[...a].map(i=>P(`${l}${i}`,h(i))),...[...n].map(i=>d(`${l}${i}`,h(i))),...[...t].map(([i,r])=>d(`${l}${i}`,b(i,r)))]}function b(e,a){return a=a?.toLowerCase(),a&&w.has(a)?w.get(a):h(e)}function h(e){const a=e.endsWith($),n=a?e.slice(0,-4):e,t=n==="StdTime"?"Standard Time":n==="StdZ"?"Standard Z":n;return a?`${t} Max`:t}function p(e,a){return a?new Date(e):e}function W(e,a,n){n?.length&&(a[u.variable]=n[0].variableName,n.forEach(({dimensionName:t,values:i})=>{if(t&&i?.length){const r=`${l}${t}`,o=e.find(({name:f})=>f===r);if(!o)return;const s=o.type==="date",c=i[0];if(Array.isArray(c)){if(a[`${l}${t}`]=p(c[0],s),c[1]!=null){const f=`${l}${t}${$}`;if(e.some(({name:v})=>v===f)){const v=p(c[1],s);a[f]=v}}}else a[`${l}${t}`]=p(c,s)}}))}function C(e,a){if(a.pixelType.startsWith("f")&&e.forEach(({format:n,fieldName:t})=>{n&&t&&/^raster\.(item|service)pixelvalue/i.test(t)&&(n.places=2)}),a.multidimensionalInfo){const n=a.multidimensionalInfo.variables.flatMap(({dimensions:t})=>t);e.forEach(({format:t,fieldName:i})=>{if(t&&i?.startsWith(l)){const r=i.slice(l.length),o=`${r}${$}`;n.find(({name:s})=>s===r||s===o)?.values?.every(s=>Number.isInteger(s))&&(t.places=0)}})}}export{C,D,E,I,M,N,S as P,R,y as S,V,W,u as o,l as s};
