import{F as R}from"./deduplicate-Lzwo1kX7-CSf-1ZcR.js";import{p as V}from"./InterleavedLayout-B7roQAzV-CC2VYRPC.js";import{EdgeInputBufferLayout as H,RegularEdgeInstancesLayout as X,SilhouetteEdgeInstancesLayout as q}from"./bufferLayouts-f-kO2Y2_-BEmDeZBp.js";import{c4 as D}from"./jsonMap-Bs3hmeCU-Cusd0Fmz.js";import{O as G,l as J}from"./vec32-CewSdTn3-DHOFKD0R.js";import{t as K}from"./collectionUtils-jDyktm0P-ArdXNs6F.js";import{v as P,S as b}from"./edgePreprocessing-D_eX-fWy-CRLN12td.js";import"./mathUtils-PIGhLnI9-B1tKUlUb.js";import"./Indices-D0_UQPPr-t1Qev6md.js";import"./BufferView-Cj2sQaht-DuP-iLZg.js";import"./Polygon-D6wEPb3W-CpL9Efjx.js";import"./Extent-CgDMOSRD-CU1qE5Kr.js";import"./Point-BfTTZoMu-BAT2Wq6O.js";import"./index-CTl7hdrJ.js";import"./vec42-B8VM4vXb-BnA9MysM.js";import"./vec2f64-rIxtbMRN-Kai9mK1i.js";import"./vec4f64-DPb6J-GU-C7c2DqbZ.js";import"./reactiveUtils-SO2Ko3sy-BCLX8Jdy.js";import"./types-BKo2foNY-DE0QfIFp.js";import"./enums-B4pqBiXb-BO-3hS_8.js";import"./VertexElementDescriptor-BlxU8vCE-BwuKQkTU.js";import"./reader-DcGs6kKN-DHJfK-tm.js";import"./SimpleObservable-CvFyr0NA-DXpoMYph.js";import"./aaBoundingRect-CjwcS2F3-D7aII9DY.js";function C(o,n,i){const c=n/3,a=new Uint32Array(i+1),f=new Uint32Array(i+1),h=(t,e)=>{t<e?a[t+1]++:f[e+1]++};for(let t=0;t<c;t++){const e=o[3*t],s=o[3*t+1],r=o[3*t+2];h(e,s),h(s,r),h(r,e)}let E=0,F=0;for(let t=0;t<i;t++){const e=a[t+1],s=f[t+1];a[t+1]=E,f[t+1]=F,E+=e,F+=s}const p=new Uint32Array(6*c),u=a[i],N=(t,e,s)=>{if(t<e){const r=a[t+1]++;p[2*r]=e,p[2*r+1]=s}else{const r=f[e+1]++;p[2*u+2*r]=t,p[2*u+2*r+1]=s}};for(let t=0;t<c;t++){const e=o[3*t],s=o[3*t+1],r=o[3*t+2];N(e,s,t),N(s,r,t),N(r,e,t)}const W=(t,e)=>{const s=2*t,r=e-t;for(let m=1;m<r;m++){const w=p[s+2*m],y=p[s+2*m+1];let l=m-1;for(;l>=0&&p[s+2*l]>w;l--)p[s+2*l+2]=p[s+2*l],p[s+2*l+3]=p[s+2*l+1];p[s+2*l+2]=w,p[s+2*l+3]=y}};for(let t=0;t<i;t++)W(a[t],a[t+1]),W(u+f[t],u+f[t+1]);const x=new Int32Array(3*c),_=(t,e)=>t===o[3*e]?0:t===o[3*e+1]?1:t===o[3*e+2]?2:-1,B=(t,e)=>{const s=_(t,e);x[3*e+s]=-1},O=(t,e,s,r)=>{const m=_(t,e);x[3*e+m]=r;const w=_(s,r);x[3*r+w]=e};for(let t=0;t<i;t++){let e=a[t];const s=a[t+1];let r=f[t];const m=f[t+1];for(;e<s&&r<m;){const w=p[2*e],y=p[2*u+2*r];w===y?(O(t,p[2*e+1],y,p[2*u+2*r+1]),e++,r++):w<y?(B(t,p[2*e+1]),e++):(B(y,p[2*u+2*r+1]),r++)}for(;e<s;)B(t,p[2*e+1]),e++;for(;r<m;)B(p[2*u+2*r],p[2*u+2*r+1]),r++}return x}const A=.7;let k=class{updateSettings(o){this.settings=o,this._edgeHashFunction=o.reducedPrecision?Y:T}write(o,n,i){L.seed=this._edgeHashFunction(i);const c=L.getIntRange(0,255),a=L.getIntRange(0,this.settings.variants-1),f=L.getFloat(),h=255*(.5*Z(-(1-Math.min(f/A,1))+Math.max(0,f-A)/(1-A),1.2)+.5);o.position0.setVec(n,i.position0),o.position1.setVec(n,i.position1),o.componentIndex.set(n,i.componentIndex),o.variantOffset.set(n,c),o.variantStroke.set(n,a),o.variantExtension.set(n,h)}};const d=new Float32Array(6),g=new Uint32Array(d.buffer),I=new Uint32Array(1);function T(o){return d[0]=o.position0[0],d[1]=o.position0[1],d[2]=o.position0[2],d[3]=o.position1[0],d[4]=o.position1[1],d[5]=o.position1[2],I[0]=31*(31*(31*(31*(31*(166811+g[0])+g[1])+g[2])+g[3])+g[4])+g[5],I[0]}function Y(o){const n=d;n[0]=S(o.position0[0]),n[1]=S(o.position0[1]),n[2]=S(o.position0[2]),n[3]=S(o.position1[0]),n[4]=S(o.position1[1]),n[5]=S(o.position1[2]),I[0]=5381;for(let i=0;i<g.length;i++)I[0]=31*I[0]+g[i];return I[0]}const M=1e4;function S(o){return Math.round(o*M)/M}function Z(o,n){return Math.abs(o)**n*Math.sign(o)}class j{constructor(){this._commonWriter=new k}updateSettings(n){this._commonWriter.updateSettings(n)}allocate(n){return X.createBuffer(n)}write(n,i,c){this._commonWriter.write(n,i,c),G(v,c.faceNormal0,c.faceNormal1),J(v,v);const{typedBuffer:a,typedBufferStride:f}=n.normalCompressed;b(a,i,v[0],v[1],v[2],f)}}class z{constructor(){this._commonWriter=new k}updateSettings(n){this._commonWriter.updateSettings(n)}allocate(n){return q.createBuffer(n)}write(n,i,c){this._commonWriter.write(n,i,c);{const{typedBuffer:a,typedBufferStride:f}=n.normalCompressed;b(a,i,c.faceNormal0[0],c.faceNormal0[1],c.faceNormal0[2],f)}{const{typedBuffer:a,typedBufferStride:f}=n.normal2Compressed;b(a,i,c.faceNormal1[0],c.faceNormal1[1],c.faceNormal1[2],f)}}}const v=K(),L=new D;function Nt(o){const n=Q(o.data,o.skipDeduplicate,o.indices,o.indicesLength);return U.updateSettings(o.writerSettings),$.updateSettings(o.writerSettings),P(n,U,$)}function Q(o,n,i,c){if(n){const h=C(i,c,o.count);return new tt(i,c,h,o)}const a=R(o.buffer,o.stride/4,{originalIndices:i}),f=C(a.indices,c,a.uniqueCount);return{faces:a.indices,facesLength:a.indices.length,neighbors:f,vertices:H.createView(a.buffer)}}class tt{constructor(n,i,c,a){this.faces=n,this.facesLength=i,this.neighbors=c,this.vertices=a}}const U=new j,$=new z,_t=V().vec3f("position0").vec3f("position1"),At=V().vec3f("position0").vec3f("position1").u16("componentIndex");export{Nt as extract,At as extractComponentsEdgeLocationsLayout,Q as extractEdgeInformation,_t as extractEdgeLocationsLayout};
