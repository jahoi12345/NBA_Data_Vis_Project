import{u as v}from"./Color-CERqXxxY.js";import{l as H,h as y}from"./reactiveUtils-SO2Ko3sy.js";import{r as h}from"./collectionUtils-yEu3-UXw.js";import{b as O,d as x,s as P,k as T,q as D}from"./sliceToolConfig-BnawSSVt.js";import{b as g,C as b,k as j,x as R}from"./SlicePlaneMaterial.glsl-HQ9eApDy.js";import{Y as C,h as k,t as m,f as G}from"./ShadedColorMaterial.glsl-BwXpFFRd.js";import{M as p}from"./RealisticTree.glsl-XUrhiZwO.js";import{J as w}from"./ShadowCastClear.glsl-9G1ObMeX.js";import{D as M,I as _}from"./colorUtils-CQgSrs28.js";import{t as A}from"./jsonMap-Bs3hmeCU.js";import{t as $}from"./orientedBoundingBox-ezehkKFt.js";import{m as B}from"./Texture-BcM9ZALi.js";import{g as U}from"./ImageMaterial.glsl-xhHW44N8.js";let Z=class extends C{constructor(e,a){const t=g(a),r=t?O:x,c=r*P,i=x,u={renderOccluded:4,isDecoration:!0},d=new w({...u,width:r},e.state.isGlobal),o=new w({...u,width:c},e.state.isGlobal),s=new w({...u,width:i},e.state.isGlobal);super({view:e,...k,...q({isCorner:t,unfocusedMaterial:d,focusedMaterial:o,outlineMaterial:s})}),this._themeHandle=H(()=>e.effectiveTheme.accentColor,f=>{const n=v.toUnitRGBA(f);d.setParameters({color:n}),o.setParameters({color:n}),s.setParameters({color:n})},y)}destroy(){this._themeHandle.remove(),super.destroy()}};function q({isCorner:l,unfocusedMaterial:e,focusedMaterial:a,outlineMaterial:t}){const r=l?[h(1,0,0),h(0,0,0),h(0,1,0)]:[h(1,0,0),h(-1,0,0)];return{renderObjects:[new m(p(e,r),1|b),new m(p(a,r),2|b),new m(p(t,r),j)],collisionType:{type:"line",paths:[r]},radius:l?T:D,state:b}}class te extends C{constructor(e,a){const t=M(e.effectiveTheme.accentColor,.5),r=_(e.effectiveTheme.accentColor),c=a(t,r),i=new U({draped:!1,texture:c.texture,writeDepth:!1,renderOccluded:16,isDecoration:!0}),u=G.calloutWidth,d=new w({width:u,renderOccluded:4,isDecoration:!0},e.state.isGlobal);super({view:e,...I({imageMaterial:i,calloutMaterial:d})}),this._material=i,this._textureHandle=c,this._themeHandle=H(()=>e.effectiveTheme.accentColor,o=>{const s=M(o,.5),f=_(o),n=this._textureHandle;this._textureHandle=a(s,f),i.setParameters({texture:this._textureHandle.texture}),n?.release(),d.setParameters({color:v.toUnitRGBA(o)})},y)}destroy(){this._textureHandle=A(this._textureHandle),this._themeHandle.remove(),this._material.dispose(),super.destroy()}}function I({imageMaterial:l,calloutMaterial:e}){const{focusMultiplier:a,calloutLength:t,discRadius:r}=G,c=r*a,i=(s,f)=>{const n=[0,1,2,2,3,0];return new B(f,[["position",new $([t-s,-s,0,t+s,-s,0,t+s,s,0,t-s,s,0],n,3,!0)],["uv0",new $([0,0,1,0,1,1,0,1],n,2,!0)]])},u=p(e,[[0,0,0],[t-r,0,0]]),d=p(e,[[0,0,0],[t-c,0,0]]),o=R;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[t,0,0]},focusMultiplier:a,radius:r,renderObjects:[new m(i(r,l),1|o),new m(u,1|o),new m(i(c,l),2|o),new m(d,2|o)],state:o}}export{Z as b,te as h};
